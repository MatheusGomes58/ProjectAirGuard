/*! For license information please see main.4aad72bc.js.LICENSE.txt */
(()=>{var e={463:(e,t,n)=>{"use strict";var r=n(791),i=n(296);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),I=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),k=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function j(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function q(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case I:return"Portal";case S:return"Profiler";case T:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function X(e,t){$(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Ee=null,Te=null;function Se(e){if(e=_i(e)){if("function"!==typeof Ie)throw Error(s(280));var t=e.stateNode;t&&(t=bi(t),Ie(e.stateNode,e.type,t))}}function Ce(e){Ee?Te?Te.push(e):Te=[e]:Ee=e}function ke(){if(Ee){var e=Ee,t=Te;if(Te=Ee=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function xe(e,t){return e(t)}function Ne(){}var Re=!1;function Pe(e,t,n){if(Re)return e(t,n);Re=!0;try{return xe(e,t,n)}finally{Re=!1,(null!==Ee||null!==Te)&&(Ne(),ke())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){De=!1}function Le(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,Fe=null,Ue=!1,Ve=null,je={onError:function(e){Me=!0,Fe=e}};function qe(e,t,n,r,i,s,o,a,l){Me=!1,Fe=null,Le.apply(je,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(s(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return We(i),e;if(o===r)return We(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Je=i.unstable_requestPaint,$e=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var _t=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,It,Et,Tt,St,Ct=!1,kt=[],xt=null,Nt=null,Rt=null,Pt=new Map,At=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=vi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void St(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_i(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Vt(e,t,n){Ut(e)&&n.delete(t)}function jt(){Ct=!1,null!==xt&&Ut(xt)&&(xt=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==Rt&&Ut(Rt)&&(Rt=null),Pt.forEach(Vt),At.forEach(Vt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function Bt(e){function t(t){return qt(t,e)}if(0<kt.length){qt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&qt(xt,e),null!==Nt&&qt(Nt,e),null!==Rt&&qt(Rt,e),Pt.forEach(t),At.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var zt=w.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,n,r){var i=_t,s=zt.transition;zt.transition=null;try{_t=1,Gt(e,t,n,r)}finally{_t=i,zt.transition=s}}function Ht(e,t,n,r){var i=_t,s=zt.transition;zt.transition=null;try{_t=4,Gt(e,t,n,r)}finally{_t=i,zt.transition=s}}function Gt(e,t,n,r){if(Wt){var i=Yt(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Mt(xt,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return Rt=Mt(Rt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pt.set(s,Mt(Pt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,At.set(s,Mt(At.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=_i(i);if(null!==s&&bt(s),null===(s=Yt(e,t,n,r))&&Wr(e,t,r,Qt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=vi(e=be(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in $t?$t.value:$t.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=F({},cn,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},hn,{relatedTarget:0})),yn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(vn),wn=sn(F({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},In={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Sn(){return Tn}var Cn=F({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?In[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=sn(Cn),xn=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Rn=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=sn(Pn),Dn=[9,13,27,32],On=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var Mn=u&&"TextEvent"in window&&!Ln,Fn=u&&(!On||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Vn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ce(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Qn(e){Ur(e,0)}function Yn(e){if(G(wi(e)))return e}function Jn(e,t){if("change"===e)return t}var $n=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;$n=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Kn(t,Gn,e,be(e)),Pe(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function sr(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,_r=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Hr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ir={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Er={},Tr={};function Sr(e){if(Er[e])return Er[e];if(!Ir[e])return e;var t,n=Ir[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Er[e]=n[t];return e}u&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);var Cr=Sr("animationend"),kr=Sr("animationiteration"),xr=Sr("animationstart"),Nr=Sr("transitionend"),Rr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Rr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Pr.length;Dr++){var Or=Pr[Dr];Ar(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Ar(Cr,"onAnimationEnd"),Ar(kr,"onAnimationIteration"),Ar(xr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(qe.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Fe;Me=!1,Fe=null,Ue||(Ue=!0,Ve=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function Vr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[qr]){e[qr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,jr("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Jt(t)){case 1:var i=Kt;break;case 4:i=Ht;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=vi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Pe((function(){var r=s,i=be(n),o=[];e:{var a=Rr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case Cr:case kr:case xr:l=yn;break;case Nr:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=An;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Ae(p,d))&&u.push(Kr(p,m,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(h=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=xn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:wi(l),f=null==c?a:wi(c),(a=new u(m,p+"leave",l,n,i)).target=h,a.relatedTarget=f,m=null,vi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Gr(f))p++;for(f=0,m=d;m;m=Gr(m))f++;for(;0<p-f;)u=Gr(u),p--;for(;0<f-p;)d=Gr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Gr(u),d=Gr(d)}u=null}else u=null;null!==l&&Qr(o,a,l,u,!1),null!==c&&null!==h&&Qr(o,h,c,u,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Jn;else if(Wn(a))if($n)g=or;else{g=ir;var y=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Kn(o,g,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?wi(r):window,e){case"focusin":(Wn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,wr(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,i)}var v;if(On)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Bn?jn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Bn&&(v=en()):(Xt="value"in($t=i)?$t.value:$t.textContent,Bn=!0)),0<(y=Hr(r,_)).length&&(_=new wn(_,e,null,n,i),o.push({event:_,listeners:y}),v?_.data=v:null!==(v=qn(n))&&(_.data=v))),(v=Mn?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Un);case"textInput":return(e=t.data)===Un&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&jn(e,t)?(e=en(),Zt=Xt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Ur(o,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Ae(e,n))&&r.unshift(Kr(e,s,i)),null!=(s=Ae(e,t))&&r.push(Kr(e,s,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Ae(n,s))&&o.unshift(Kr(n,l,a)):i||null!=(l=Ae(n,s))&&o.push(Kr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Jr,"")}function Xr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function _i(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function bi(e){return e[fi]||null}var Ii=[],Ei=-1;function Ti(e){return{current:e}}function Si(e){0>Ei||(e.current=Ii[Ei],Ii[Ei]=null,Ei--)}function Ci(e,t){Ei++,Ii[Ei]=e.current,e.current=t}var ki={},xi=Ti(ki),Ni=Ti(!1),Ri=ki;function Pi(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ai(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Si(Ni),Si(xi)}function Oi(e,t,n){if(xi.current!==ki)throw Error(s(168));Ci(xi,t),Ci(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,z(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Ri=xi.current,Ci(xi,e),Ci(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Li(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Si(Ni),Si(xi),Ci(xi,e)):Si(Ni),Ci(Ni,n)}var Ui=null,Vi=!1,ji=!1;function qi(e){null===Ui?Ui=[e]:Ui.push(e)}function Bi(){if(!ji&&null!==Ui){ji=!0;var e=0,t=_t;try{var n=Ui;for(_t=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Vi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ge(Ze,Bi),i}finally{_t=t,ji=!1}}return null}var zi=[],Wi=0,Ki=null,Hi=0,Gi=[],Qi=0,Yi=null,Ji=1,$i="";function Xi(e,t){zi[Wi++]=Hi,zi[Wi++]=Ki,Ki=e,Hi=t}function Zi(e,t,n){Gi[Qi++]=Ji,Gi[Qi++]=$i,Gi[Qi++]=Yi,Yi=e;var r=Ji;e=$i;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ji=1<<32-ot(t)+i|n<<i|r,$i=s+e}else Ji=1<<s|n<<i|r,$i=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Ki;)Ki=zi[--Wi],zi[Wi]=null,Hi=zi[--Wi],zi[Wi]=null;for(;e===Yi;)Yi=Gi[--Qi],Gi[Qi]=null,$i=Gi[--Qi],Gi[Qi]=null,Ji=Gi[--Qi],Gi[Qi]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ji,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ys=Ti(null),vs=null,_s=null,ws=null;function bs(){ws=_s=vs=null}function Is(e){var t=ys.current;Si(ys),e._currentValue=t}function Es(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ts(e,t){vs=e,ws=_s=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wa=!0),e.firstContext=null)}function Ss(e){var t=e._currentValue;if(ws!==e)if(e={context:e,memoizedValue:t,next:null},null===_s){if(null===vs)throw Error(s(308));_s=e,vs.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Cs=null;function ks(e){null===Cs?Cs=[e]:Cs.push(e)}function xs(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,ks(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ns(e,r)}function Ns(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function Ps(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ds(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Os(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ns(e,n)}return null===(i=r.interleaved)?(t.next=t,ks(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ns(e,n)}function Ls(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ms(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fs(e,t,n,r){var i=e.updateQueue;Rs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Rs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Fl|=o,e.lanes=o,e.memoizedState=h}}function Us(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Vs=(new r.Component).refs;function js(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var qs={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Ds(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Os(e,s,i))&&(rc(t,e,i,r),Ls(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Ds(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Os(e,s,i))&&(rc(t,e,i,r),Ls(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Ds(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Os(e,i,r))&&(rc(t,e,r,n),Ls(t,e,r))}};function Bs(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function zs(e,t,n){var r=!1,i=ki,s=t.contextType;return"object"===typeof s&&null!==s?s=Ss(s):(i=Ai(t)?Ri:xi.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):ki),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qs,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ws(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qs.enqueueReplaceState(t,t.state,null)}function Ks(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Vs,Ps(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ss(s):(s=Ai(t)?Ri:xi.current,i.context=Pi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(js(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&qs.enqueueReplaceState(i,i.state,null),Fs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Hs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Vs&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Gs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qs(e){return(0,e._init)(e._payload)}function Ys(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===E?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&Qs(s)===t.type)?((r=i(t,n.props)).ref=Hs(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=Hs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=Hs(e,null,t),n.return=e,n;case I:return(t=Vc(t,e.mode,n)).return=e,t;case A:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Mc(t,e.mode,n,null)).return=e,t;Gs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?c(e,t,n,r):null;case I:return n.key===i?u(e,t,n,r):null;case A:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);Gs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case A:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);Gs(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(i,h),is&&Xi(i,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return is&&Xi(i,m),c}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),is&&Xi(i,m),c}function g(i,a,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=f(i,m,v.value,c);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),a=o(_,a,g),null===h?u=_:h.sibling=_,h=_,m=y}if(v.done)return n(i,m),is&&Xi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return is&&Xi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),is&&Xi(i,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===E){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&Qs(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=Hs(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===E?((s=Mc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lc(o.type,o.key,o.props,null,r.mode,l)).ref=Hs(r,s,o),l.return=r,r=l)}return a(r);case I:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Vc(o,r.mode,l)).return=r,r=s}return a(r);case A:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(L(o))return g(r,s,o,l);Gs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Uc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var Js=Ys(!0),$s=Ys(!1),Xs={},Zs=Ti(Xs),eo=Ti(Xs),to=Ti(Xs);function no(e){if(e===Xs)throw Error(s(174));return e}function ro(e,t){switch(Ci(to,t),Ci(eo,e),Ci(Zs,Xs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Zs),Ci(Zs,t)}function io(){Si(Zs),Si(eo),Si(to)}function so(e){no(to.current);var t=no(Zs.current),n=le(t,e.type);t!==n&&(Ci(eo,e),Ci(Zs,n))}function oo(e){eo.current===e&&(Si(Zs),Si(eo))}var ao=Ti(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=w.ReactCurrentDispatcher,fo=w.ReactCurrentBatchConfig,po=0,mo=null,go=null,yo=null,vo=!1,_o=!1,wo=0,bo=0;function Io(){throw Error(s(321))}function Eo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function To(e,t,n,r,i,o){if(po=o,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?aa:la,e=n(r,i),_o){o=0;do{if(_o=!1,wo=0,25<=o)throw Error(s(301));o+=1,yo=go=null,t.updateQueue=null,ho.current=ca,e=n(r,i)}while(_o)}if(ho.current=oa,t=null!==go&&null!==go.next,po=0,yo=go=mo=null,vo=!1,t)throw Error(s(300));return e}function So(){var e=0!==wo;return wo=0,e}function Co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?mo.memoizedState=yo=e:yo=yo.next=e,yo}function ko(){if(null===go){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=go.next;var t=null===yo?mo.memoizedState:yo.next;if(null!==t)yo=t,go=e;else{if(null===e)throw Error(s(310));e={memoizedState:(go=e).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===yo?mo.memoizedState=yo=e:yo=yo.next=e}return yo}function xo(e,t){return"function"===typeof t?t(e):t}function No(e){var t=ko(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=go,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((po&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,mo.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(wa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,mo.lanes|=o,Fl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=ko(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(wa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Po(){}function Ao(e,t){var n=mo,r=ko(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,wa=!0),r=r.queue,Wo(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==yo&&1&yo.memoizedState.tag){if(n.flags|=2048,Vo(9,Oo.bind(null,n,r,i,t),void 0,null),null===Rl)throw Error(s(349));0!==(30&po)||Do(n,t,i)}return i}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&Fo(e)}function Lo(e,t,n){return n((function(){Mo(t)&&Fo(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Fo(e){var t=Ns(e,1);null!==t&&rc(t,e,1,-1)}function Uo(e){var t=Co();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,mo,e),[t.memoizedState,e]}function Vo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function jo(){return ko().memoizedState}function qo(e,t,n,r){var i=Co();mo.flags|=e,i.memoizedState=Vo(1|t,n,void 0,void 0===r?null:r)}function Bo(e,t,n,r){var i=ko();r=void 0===r?null:r;var s=void 0;if(null!==go){var o=go.memoizedState;if(s=o.destroy,null!==r&&Eo(r,o.deps))return void(i.memoizedState=Vo(t,n,s,r))}mo.flags|=e,i.memoizedState=Vo(1|t,n,s,r)}function zo(e,t){return qo(8390656,8,e,t)}function Wo(e,t){return Bo(2048,8,e,t)}function Ko(e,t){return Bo(4,2,e,t)}function Ho(e,t){return Bo(4,4,e,t)}function Go(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4,4,Go.bind(null,t,e),n)}function Yo(){}function Jo(e,t){var n=ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),mo.lanes|=n,Fl|=n,e.baseState=!0),t)}function Zo(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{_t=n,fo.transition=r}}function ea(){return ko().memoizedState}function ta(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e))ia(t,n);else if(null!==(n=xs(e,t,n,r))){rc(n,e,r,tc()),sa(n,t,r)}}function na(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))ia(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,ks(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=xs(e,t,i,r))&&(rc(n,e,r,i=tc()),sa(n,t,r))}}function ra(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function ia(e,t){_o=vo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var oa={readContext:Ss,useCallback:Io,useContext:Io,useEffect:Io,useImperativeHandle:Io,useInsertionEffect:Io,useLayoutEffect:Io,useMemo:Io,useReducer:Io,useRef:Io,useState:Io,useDebugValue:Io,useDeferredValue:Io,useTransition:Io,useMutableSource:Io,useSyncExternalStore:Io,useId:Io,unstable_isNewReconciler:!1},aa={readContext:Ss,useCallback:function(e,t){return Co().memoizedState=[e,void 0===t?null:t],e},useContext:Ss,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return qo(4194308,4,e,t)},useInsertionEffect:function(e,t){return qo(4,2,e,t)},useMemo:function(e,t){var n=Co();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Co();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ta.bind(null,mo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Co().memoizedState=e},useState:Uo,useDebugValue:Yo,useDeferredValue:function(e){return Co().memoizedState=e},useTransition:function(){var e=Uo(!1),t=e[0];return e=Zo.bind(null,e[1]),Co().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=mo,i=Co();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));0!==(30&po)||Do(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,zo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,Vo(9,Oo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Co(),t=Rl.identifierPrefix;if(is){var n=$i;t=":"+t+"R"+(n=(Ji&~(1<<32-ot(Ji)-1)).toString(32)+n),0<(n=wo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=bo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Ss,useCallback:Jo,useContext:Ss,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ko,useLayoutEffect:Ho,useMemo:$o,useReducer:No,useRef:jo,useState:function(){return No(xo)},useDebugValue:Yo,useDeferredValue:function(e){return Xo(ko(),go.memoizedState,e)},useTransition:function(){return[No(xo)[0],ko().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ao,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Ss,useCallback:Jo,useContext:Ss,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ko,useLayoutEffect:Ho,useMemo:$o,useReducer:Ro,useRef:jo,useState:function(){return Ro(xo)},useDebugValue:Yo,useDeferredValue:function(e){var t=ko();return null===go?t.memoizedState=e:Xo(t,go.memoizedState,e)},useTransition:function(){return[Ro(xo)[0],ko().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ao,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ha(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fa="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Ds(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kl||(Kl=!0,Hl=r),da(0,t)},n}function ma(e,t,n){(n=Ds(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function ya(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ds(-1,1)).tag=2,Os(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var _a=w.ReactCurrentOwner,wa=!1;function ba(e,t,n,r){t.child=null===e?$s(t,null,n,r):Js(t,e.child,n,r)}function Ia(e,t,n,r,i){n=n.render;var s=t.ref;return Ts(t,i),r=To(e,t,n,r,s,i),n=So(),null===e||wa?(is&&n&&es(t),t.flags|=1,ba(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ka(e,t,i))}function Ea(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ta(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Ka(e,t,i)}return t.flags|=1,(e=Oc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ta(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(wa=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ka(e,t,i);0!==(131072&e.flags)&&(wa=!0)}}return ka(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Ol,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Ol,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ci(Ol,Dl),Dl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ci(Ol,Dl),Dl|=r;return ba(e,t,i,n),t.child}function Ca(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ka(e,t,n,r,i){var s=Ai(n)?Ri:xi.current;return s=Pi(t,s),Ts(t,i),n=To(e,t,n,r,s,i),r=So(),null===e||wa?(is&&r&&es(t),t.flags|=1,ba(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ka(e,t,i))}function xa(e,t,n,r,i){if(Ai(n)){var s=!0;Mi(t)}else s=!1;if(Ts(t,i),null===t.stateNode)Wa(e,t),zs(t,n,r),Ks(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ss(c):c=Pi(t,c=Ai(n)?Ri:xi.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&Ws(t,o,r,c),Rs=!1;var d=t.memoizedState;o.state=d,Fs(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ni.current||Rs?("function"===typeof u&&(js(t,n,u,r),l=t.memoizedState),(a=Rs||Bs(t,n,a,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,As(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:gs(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ss(l):l=Pi(t,l=Ai(n)?Ri:xi.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Ws(t,o,r,l),Rs=!1,d=t.memoizedState,o.state=d,Fs(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ni.current||Rs?("function"===typeof f&&(js(t,n,f,r),p=t.memoizedState),(c=Rs||Bs(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Na(e,t,n,r,s,i)}function Na(e,t,n,r,i,s){Ca(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Ka(e,t,s);r=t.stateNode,_a.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Js(t,e.child,null,s),t.child=Js(t,null,a,s)):ba(e,t,a,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),ro(e,t.containerInfo)}function Pa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,ba(e,t,n,r),t.child}var Aa,Da,Oa,La,Ma={dehydrated:null,treeContext:null,retryLane:0};function Fa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ua(e,t,n){var r,i=t.pendingProps,o=ao.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(ao,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fc(l,i,0,null),e=Mc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Fa(n),t.memoizedState=Ma,e):Va(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,ja(e,t,a,r=ha(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(o=Mc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Js(t,e.child,null,a),t.child.memoizedState=Fa(a),t.memoizedState=Ma,o);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,ja(e,t,a,r=ha(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),wa||l){if(null!==(r=Rl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ns(e,i),rc(r,e,i,-1))}return gc(),ja(e,t,a,r=ha(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=xc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Gi[Qi++]=Ji,Gi[Qi++]=$i,Gi[Qi++]=Yi,Ji=e.id,$i=e.overflow,Yi=t),t=Va(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Oc(r,a):(a=Mc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ma,i}return e=(a=e.child).sibling,i=Oc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Va(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,n,r){return null!==r&&ps(r),Js(t,e.child,null,n),(e=Va(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Es(e.return,t,n)}function Ba(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function za(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(ba(e,t,r.children,n),0!==(2&(r=ao.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(ao,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ba(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===lo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ba(t,!0,n,null,s);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ka(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ha(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ga(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qa(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(t),null;case 1:case 17:return Ai(t.type)&&Di(),Ga(t),null;case 3:return r=t.stateNode,io(),Si(Ni),Si(xi),uo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Da(e,t),Ga(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ga(t),null}if(e=no(Zs.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":J(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Aa(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":J(e,r),i=Y(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ve(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Vr("scroll",e):null!=u&&_(e,o,u,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ga(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=no(to.current),no(Zs.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ga(t),null;case 13:if(Si(ao),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ga(t),o=!1}else null!==ss&&(ac(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ao.current)?0===Ll&&(Ll=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ga(t),null);case 4:return io(),Da(e,t),null===e&&Br(t.stateNode.containerInfo),Ga(t),null;case 10:return Is(t.type._context),Ga(t),null;case 19:if(Si(ao),null===(o=t.memoizedState))return Ga(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ha(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,Ha(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(ao,1&ao.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>zl&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=lo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ha(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Ga(t),null}else 2*$e()-o.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=ao.current,Ci(ao,r?1&n|2:1&n),t):(Ga(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ga(t),6&t.subtreeFlags&&(t.flags|=8192)):Ga(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ya(e,t){switch(ts(t),t.tag){case 1:return Ai(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Si(Ni),Si(xi),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Si(ao),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(ao),null;case 4:return io(),null;case 10:return Is(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Aa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Zs.current);var s,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Vr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ja=!1,$a=!1,Xa="function"===typeof WeakSet?WeakSet:Set,Za=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&tl(t,n,s)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:$a||el(n,t);case 6:var r=hl,i=dl;hl=null,fl(e,t,n),dl=i,null!==(hl=r)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(hl,n.stateNode));break;case 4:r=hl,i=dl,hl=n.stateNode.containerInfo,dl=!0,fl(e,t,n),hl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!$a&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&tl(n,t,o),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!$a&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Sc(n,t,a)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?($a=(r=$a)||null!==n.memoizedState,fl(e,t,n),$a=r):fl(e,t,n);break;default:fl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));pl(o,a,i),hl=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Sc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){Sc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Sc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&$(i,o),_e(l,a);var u=_e(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):_(i,h,d,u)}switch(l){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Sc(e,e.return,g)}}break;case 6:if(gl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Sc(e,e.return,g)}}break;case 3:if(gl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=$e())),4&r&&ml(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($a=(u=$a)||h,gl(t,e),$a=u):gl(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Za=e,h=e.child;null!==h;){for(d=Za=h;null!==Za;){switch(p=(f=Za).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Sc(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){Il(d);continue}}null!==p?(p.return=f,Za=p):Il(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Sc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),vl(e),4&r&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(s(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){Za=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!==(1&e.mode);null!==Za;){var i=Za,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ja;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||$a;a=Ja;var c=$a;if(Ja=o,($a=l)&&!c)for(Za=i;null!==Za;)l=(o=Za).child,22===o.tag&&null!==o.memoizedState?El(i):null!==l?(l.return=o,Za=l):El(i);for(;null!==s;)Za=s,wl(s,t,n),s=s.sibling;Za=i,Ja=a,$a=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Za=s):bl(e)}}function bl(e){for(;null!==Za;){var t=Za;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$a||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$a)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:gs(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Us(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Us(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Bt(d)}}}break;default:throw Error(s(163))}$a||512&t.flags&&sl(t)}catch(f){Sc(t,t.return,f)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function Il(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function El(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Sc(t,i,l)}}var s=t.return;try{sl(t)}catch(l){Sc(t,s,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){Sc(t,o,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var Tl,Sl=Math.ceil,Cl=w.ReactCurrentDispatcher,kl=w.ReactCurrentOwner,xl=w.ReactCurrentBatchConfig,Nl=0,Rl=null,Pl=null,Al=0,Dl=0,Ol=Ti(0),Ll=0,Ml=null,Fl=0,Ul=0,Vl=0,jl=null,ql=null,Bl=0,zl=1/0,Wl=null,Kl=!1,Hl=null,Gl=null,Ql=!1,Yl=null,Jl=0,$l=0,Xl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Nl)?$e():-1!==Zl?Zl:Zl=$e()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Al?Al&-Al:null!==ms.transition?(0===ec&&(ec=mt()),ec):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function rc(e,t,n,r){if(50<$l)throw $l=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&Nl)&&e===Rl||(e===Rl&&(0===(2&Nl)&&(Ul|=n),4===Ll&&lc(e,Al)),ic(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(zl=$e()+500,Vi&&Bi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Rl?Al:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Vi=!0,qi(e)}(cc.bind(null,e)):qi(cc.bind(null,e)),oi((function(){0===(6&Nl)&&Bi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(Ec()&&e.callbackNode!==n)return null;var r=dt(e,e===Rl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var i=Nl;Nl|=2;var o=mc();for(Rl===e&&Al===t||(Wl=null,zl=$e()+500,fc(e,t));;)try{_c();break}catch(l){pc(e,l)}bs(),Cl.current=o,Nl=i,null!==Pl?t=0:(Rl=null,Al=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=oc(e,i))),1===t)throw n=Ml,fc(e,0),lc(e,r),ic(e,$e()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Ml,fc(e,0),lc(e,r),ic(e,$e()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Ic(e,ql,Wl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Bl+500-$e())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Ic.bind(null,e,ql,Wl),t);break}Ic(e,ql,Wl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ri(Ic.bind(null,e,ql,Wl),r);break}Ic(e,ql,Wl);break;default:throw Error(s(329))}}}return ic(e,$e()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=jl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=ql,ql=n,null!==t&&ac(t)),e}function ac(e){null===ql?ql=e:ql.push.apply(ql,e)}function lc(e,t){for(t&=~Vl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Nl))throw Error(s(327));Ec();var t=dt(e,0);if(0===(1&t))return ic(e,$e()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ml,fc(e,0),lc(e,t),ic(e,$e()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ic(e,ql,Wl),ic(e,$e()),null}function uc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(zl=$e()+500,Vi&&Bi())}}function hc(e){null!==Yl&&0===Yl.tag&&0===(6&Nl)&&Ec();var t=Nl;Nl|=1;var n=xl.transition,r=_t;try{if(xl.transition=null,_t=1,e)return e()}finally{_t=r,xl.transition=n,0===(6&(Nl=t))&&Bi()}}function dc(){Dl=Ol.current,Si(Ol)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:io(),Si(Ni),Si(xi),uo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Si(ao);break;case 10:Is(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Rl=e,Pl=e=Oc(e.current,null),Al=Dl=t,Ll=0,Ml=null,Vl=Ul=Fl=0,ql=jl=null,null!==Cs){for(t=0;t<Cs.length;t++)if(null!==(r=(n=Cs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Cs=null}return e}function pc(e,t){for(;;){var n=Pl;try{if(bs(),ho.current=oa,vo){for(var r=mo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}vo=!1}if(po=0,yo=go=mo=null,_o=!1,wo=0,kl.current=null,null===n||null===n.return){Ll=1,Ml=t,Pl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ya(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ga(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ga(o,u,t),gc();break e}c=Error(s(426))}else if(is&&1&l.mode){var y=ya(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),va(y,a,l,0,t),ps(ua(c,l));break e}}o=c=ua(c,l),4!==Ll&&(Ll=2),null===jl?jl=[o]:jl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ms(o,pa(0,c,t));break e;case 1:l=c;var v=o.type,_=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Gl||!Gl.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,Ms(o,ma(o,l,t));break e}}o=o.return}while(null!==o)}bc(n)}catch(w){t=w,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function mc(){var e=Cl.current;return Cl.current=oa,null===e?oa:e}function gc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Rl||0===(268435455&Fl)&&0===(268435455&Ul)||lc(Rl,Al)}function yc(e,t){var n=Nl;Nl|=2;var r=mc();for(Rl===e&&Al===t||(Wl=null,fc(e,t));;)try{vc();break}catch(i){pc(e,i)}if(bs(),Nl=n,Cl.current=r,null!==Pl)throw Error(s(261));return Rl=null,Al=0,Ll}function vc(){for(;null!==Pl;)wc(Pl)}function _c(){for(;null!==Pl&&!Ye();)wc(Pl)}function wc(e){var t=Tl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bc(e):Pl=t,kl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qa(n,t,Dl)))return void(Pl=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function Ic(e,t,n){var r=_t,i=xl.transition;try{xl.transition=null,_t=1,function(e,t,n,r){do{Ec()}while(null!==Yl);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Rl&&(Pl=Rl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Rc(tt,(function(){return Ec(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=xl.transition,xl.transition=null;var a=_t;_t=1;var l=Nl;Nl|=4,kl.current=null,function(e,t){if(ei=Wt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Za=t;null!==Za;)if(e=(t=Za).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:gs(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(b){Sc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}m=nl,nl=!1}(e,n),yl(n,e),pr(ti),Wt=!!ei,ti=ei=null,e.current=n,_l(n,e,i),Je(),Nl=l,_t=a,xl.transition=o}else e.current=n;if(Ql&&(Ql=!1,Yl=e,Jl=i),o=e.pendingLanes,0===o&&(Gl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Kl)throw Kl=!1,e=Hl,Hl=null,e;0!==(1&Jl)&&0!==e.tag&&Ec(),o=e.pendingLanes,0!==(1&o)?e===Xl?$l++:($l=0,Xl=e):$l=0,Bi()}(e,t,n,r)}finally{xl.transition=i,_t=r}return null}function Ec(){if(null!==Yl){var e=wt(Jl),t=xl.transition,n=_t;try{if(xl.transition=null,_t=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Jl=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,Za=e.current;null!==Za;){var o=Za,a=o.child;if(0!==(16&Za.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Za=u;null!==Za;){var h=Za;switch(h.tag){case 0:case 11:case 15:rl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Za=d;else for(;null!==Za;){var f=(h=Za).sibling,p=h.return;if(ol(h),h===u){Za=null;break}if(null!==f){f.return=p,Za=f;break}Za=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Za=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Za=a;else e:for(;null!==Za;){if(0!==(2048&(o=Za).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Za=v;break e}Za=o.return}}var _=e.current;for(Za=_;null!==Za;){var w=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Za=w;else e:for(a=_;null!==Za;){if(0!==(2048&(l=Za).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(I){Sc(l,l.return,I)}if(l===a){Za=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Za=b;break e}Za=l.return}}if(Nl=i,Bi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{_t=n,xl.transition=t}}return!1}function Tc(e,t,n){e=Os(e,t=pa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ic(e,t))}function Sc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=Os(t,e=ma(t,e=ua(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Al&n)===n&&(4===Ll||3===Ll&&(130023424&Al)===Al&&500>$e()-Bl?fc(e,0):Vl|=n),ic(e,t)}function kc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ns(e,t))&&(yt(e,t,n),ic(e,n))}function xc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),kc(e,n)}function Rc(e,t){return Ge(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Pc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Dc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Mc(n.children,i,o,t);case T:a=8,i|=8;break;case S:return(e=Ac(12,n,t,2|i)).elementType=S,e.lanes=o,e;case N:return(e=Ac(13,n,t,i)).elementType=N,e.lanes=o,e;case R:return(e=Ac(19,n,t,i)).elementType=R,e.lanes=o,e;case D:return Fc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case k:a=9;break e;case x:a=11;break e;case P:a=14;break e;case A:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qc(e,t,n,r,i,s,o,a,l){return e=new jc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ps(s),e}function Bc(e){if(!e)return ki;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ai(n))return Li(e,n,t)}return t}function zc(e,t,n,r,i,s,o,a,l){return(e=qc(n,r,!0,e,0,s,0,a,l)).context=Bc(null),n=e.current,(s=Ds(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Os(n,s,i),e.current.lanes=i,yt(e,i,r),ic(e,r),e}function Wc(e,t,n,r){var i=t.current,s=tc(),o=nc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ds(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Os(i,t,o))&&(rc(e,i,o,s),Ls(e,i,o)),o}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)wa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),fs();break;case 5:so(t);break;case 1:Ai(t.type)&&Mi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(ys,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(ao,1&ao.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ua(e,t,n):(Ci(ao,1&ao.current),null!==(e=Ka(e,t,n))?e.sibling:null);Ci(ao,1&ao.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return za(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(ao,ao.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ka(e,t,n)}(e,t,n);wa=0!==(131072&e.flags)}else wa=!1,is&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wa(e,t),e=t.pendingProps;var i=Pi(t,xi.current);Ts(t,n),i=To(null,t,r,e,i,n);var o=So();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ps(t),i.updater=qs,t.stateNode=i,i._reactInternals=t,Ks(t,r,e,n),t=Na(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),ba(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wa(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===x)return 11;if(e===P)return 14}return 2}(r),e=gs(r,e),i){case 0:t=ka(null,t,r,e,n);break e;case 1:t=xa(null,t,r,e,n);break e;case 11:t=Ia(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,gs(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 1:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 3:e:{if(Ra(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,As(e,t),Fs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pa(e,t,r,n,i=ua(Error(s(423)),t));break e}if(r!==i){t=Pa(e,t,r,n,i=ua(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=$s(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Ka(e,t,n);break e}ba(e,t,r,n)}t=t.child}return t;case 5:return so(t),null===e&&cs(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ca(e,t),ba(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ua(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Js(t,null,r,n):ba(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:gs(r,i),n);case 7:return ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ci(ys,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ni.current){t=Ka(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Ds(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Es(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Es(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ba(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ts(t,n),r=r(i=Ss(i)),t.flags|=1,ba(e,t,r,n),t.child;case 14:return i=gs(r=t.type,t.pendingProps),Ea(e,t,r,i=gs(r.type,i),n);case 15:return Ta(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:gs(r,i),Wa(e,t),t.tag=1,Ai(r)?(e=!0,Mi(t)):e=!1,Ts(t,n),zs(t,r,i),Ks(t,r,i,n),Na(null,t,r,!0,e,n);case 19:return za(e,t,n);case 22:return Sa(e,t,n)}throw Error(s(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Kc(o);a.call(e)}}Wc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Kc(o);s.call(e)}}var o=zc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[pi]=o.current,Br(8===e.nodeType?e.parentNode:e),hc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Kc(l);a.call(e)}}var l=qc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pi]=l.current,Br(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,l,n,r)})),l}(n,t,e,i,r);return Kc(o)}Jc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wc(e,t,null,null)},Jc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[pi]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),ic(t,$e()),0===(6&Nl)&&(zl=$e()+500,Bi()))}break;case 13:hc((function(){var t=Ns(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Gc(e,1)}},It=function(e){if(13===e.tag){var t=Ns(e,134217728);if(null!==t)rc(t,e,134217728,tc());Gc(e,134217728)}},Et=function(e){if(13===e.tag){var t=nc(e),n=Ns(e,t);if(null!==n)rc(n,e,t,tc());Gc(e,t)}},Tt=function(){return _t},St=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},Ie=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(s(90));G(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=uc,Ne=hc;var tu={usingClientEntryPoint:!1,Events:[_i,wi,bi,Ce,ke,uc]},nu={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(s(299));var n=!1,r="",i=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=qc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{"use strict";var r=n(791),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=_.prototype=new v;w.constructor=_,m(w,y.prototype),w.isPureReactComponent=!0;var b=Array.isArray,I=Object.prototype.hasOwnProperty,E={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)I.call(t,i)&&!T.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:E.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+x(l,0):s,b(o)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",b(e))for(var c=0;c<e.length;c++){var u=s+x(a=e[c],c);l+=N(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,u=s+x(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},D={transition:null},O={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=_,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)I.call(t,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function b(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,D(I);else{var t=r(u);null!==t&&O(b,t.startTime-e)}}function I(e,n){m=!1,g&&(g=!1,v(C),C=-1),p=!0;var s=f;try{for(w(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),w(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(b,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,T=!1,S=null,C=-1,k=5,x=-1;function N(){return!(t.unstable_now()-x<k)}function R(){if(null!==S){var e=t.unstable_now();x=e;var n=!0;try{n=S(!0,e)}finally{n?E():(T=!1,S=null)}}else T=!1}if("function"===typeof _)E=function(){_(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,A=P.port2;P.port1.onmessage=R,E=function(){A.postMessage(null)}}else E=function(){y(R,0)};function D(e){S=e,T||(T=!0,E())}function O(e,n){C=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(C),C=-1):g=!0,O(b,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,D(I))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},188:(e,t,n)=>{var r={"./1.png":658,"./2.png":25,"./3.png":534,"./4.png":948,"./5.png":571,"./6.png":836,"./7.png":921,"./8.png":720};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=s,e.exports=i,i.id=188},658:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/1.20d1e8ab87cb4704590d.png"},25:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/2.7b44b4af230cb146b792.png"},534:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/3.2216817c2bb353f8f7d3.png"},948:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/4.b25d4286a99bc00bb46d.png"},571:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/5.bb1b8b50193b15b1bb8e.png"},836:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/6.0b3e3816c9d0d3912952.png"},921:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/7.381040bab612a40c41c3.png"},720:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/8.e157be26b0dc6f4e3a04.png"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{"use strict";var e={};n.r(e),n.d(e,{FirebaseError:()=>rt,SDK_VERSION:()=>En,_DEFAULT_ENTRY_NAME:()=>an,_addComponent:()=>dn,_addOrOverwriteComponent:()=>fn,_apps:()=>cn,_clearComponents:()=>_n,_components:()=>hn,_getProvider:()=>mn,_isFirebaseApp:()=>yn,_isFirebaseServerApp:()=>vn,_registerComponent:()=>pn,_removeServiceInstance:()=>gn,_serverApps:()=>un,deleteApp:()=>xn,getApp:()=>Cn,getApps:()=>kn,initializeApp:()=>Tn,initializeServerApp:()=>Sn,onLog:()=>Rn,registerVersion:()=>Nn,setLogLevel:()=>Pn});var t,r=n(791),i=n.t(r,2),s=n(250),o=n(164),a=n.t(o,2);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(t||(t={}));const c="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,n,r){return void 0===n&&(n=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?m(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function m(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function g(e,n,r,i){void 0===i&&(i={});let{window:s=document.defaultView,v5Compat:o=!1}=i,a=s.history,h=t.Pop,m=null,g=y();function y(){return(a.state||{idx:null}).idx}function v(){h=t.Pop;let e=y(),n=null==e?null:e-g;g=e,m&&m({action:h,location:w.location,delta:n})}function _(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:p(e);return u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,a.replaceState(l({},a.state,{idx:g}),""));let w={get action(){return h},get location(){return e(s,a)},listen(e){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(c,v),m=e,()=>{s.removeEventListener(c,v),m=null}},createHref:e=>n(s,e),createURL:_,encodeLocation(e){let t=_(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,n){h=t.Push;let i=f(w.location,e,n);r&&r(i,e),g=y()+1;let l=d(i,g),c=w.createHref(i);try{a.pushState(l,"",c)}catch(ek){if(ek instanceof DOMException&&"DataCloneError"===ek.name)throw ek;s.location.assign(c)}o&&m&&m({action:h,location:w.location,delta:1})},replace:function(e,n){h=t.Replace;let i=f(w.location,e,n);r&&r(i,e),g=y();let s=d(i,g),l=w.createHref(i);a.replaceState(s,"",l),o&&m&&m({action:h,location:w.location,delta:0})},go:e=>a.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){void 0===n&&(n="/");let r=A(("string"===typeof t?m(t):t).pathname||"/",n);if(null==r)return null;let i=_(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o)s=N(i[o],P(r));return s}function _(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(u(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let a=F([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),_(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:x(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of w(e.path))i(e,t,r);else i(e,t)})),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=w(r.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const b=/^:[\w-]+$/,I=3,E=2,T=1,S=10,C=-2,k=e=>"*"===e;function x(e,t){let n=e.split("/"),r=n.length;return n.some(k)&&(r+=C),t&&(r+=E),n.filter((e=>!k(e))).reduce(((e,t)=>e+(b.test(t)?I:""===t?T:S)),r)}function N(e,t){let{routesMeta:n}=e,r={},i="/",s=[];for(let o=0;o<n.length;++o){let e=n[o],a=o===n.length-1,l="/"===i?t:t.slice(i.length)||"/",c=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:a},l);if(!c)return null;Object.assign(r,c.params);let u=e.route;s.push({params:r,pathname:F([i,c.pathname]),pathnameBase:U(F([i,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(i=F([i,c.pathnameBase]))}return s}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:function(e,t){try{return decodeURIComponent(e)}catch(ek){return h(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+ek+")."),e}}(l||"",r),e}),{});return{params:l,pathname:s,pathnameBase:o,pattern:e}}function P(e){try{return decodeURI(e)}catch(ek){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+ek+")."),e}}function A(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function D(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function L(e,t){let n=O(e);return t?n.map(((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)):n.map((e=>e.pathnameBase))}function M(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=m(e):(i=l({},e),u(!i.pathname||!i.pathname.includes("?"),D("?","pathname","search",i)),u(!i.pathname||!i.pathname.includes("#"),D("#","pathname","hash",i)),u(!i.search||!i.search.includes("#"),D("#","search","hash",i)));let s,o=""===e||""===i.pathname,a=o?"/":i.pathname;if(null==a)s=n;else{let e=t.length-1;if(!r&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?m(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:V(r),hash:j(i)}}(i,s),h=a&&"/"!==a&&a.endsWith("/"),d=(o||"."===a)&&n.endsWith("/");return c.pathname.endsWith("/")||!h&&!d||(c.pathname+="/"),c}const F=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const B=["post","put","patch","delete"],z=(new Set(B),["get",...B]);new Set(z),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W.apply(this,arguments)}const K=r.createContext(null);const H=r.createContext(null);const G=r.createContext(null);const Q=r.createContext(null);const Y=r.createContext({outlet:null,matches:[],isDataRoute:!1});const J=r.createContext(null);function $(){return null!=r.useContext(Q)}function X(){return $()||u(!1),r.useContext(Q).location}function Z(e){r.useContext(G).static||r.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=r.useContext(Y);return e?function(){let{router:e}=ue(le.UseNavigateStable),t=de(ce.UseNavigateStable),n=r.useRef(!1);Z((()=>{n.current=!0}));let i=r.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,W({fromRouteId:t},i)))}),[e,t]);return i}():function(){$()||u(!1);let e=r.useContext(K),{basename:t,future:n,navigator:i}=r.useContext(G),{matches:s}=r.useContext(Y),{pathname:o}=X(),a=JSON.stringify(L(s,n.v7_relativeSplatPath)),l=r.useRef(!1);return Z((()=>{l.current=!0})),r.useCallback((function(n,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof n)return void i.go(n);let s=M(n,JSON.parse(a),o,"path"===r.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:F([t,s.pathname])),(r.replace?i.replace:i.push)(s,r.state,r)}),[t,i,a,o,e])}()}function te(e,t){let{relative:n}=void 0===t?{}:t,{future:i}=r.useContext(G),{matches:s}=r.useContext(Y),{pathname:o}=X(),a=JSON.stringify(L(s,i.v7_relativeSplatPath));return r.useMemo((()=>M(e,JSON.parse(a),o,"path"===n)),[e,a,o,n])}function ne(e,n,i,s){$()||u(!1);let{navigator:o}=r.useContext(G),{matches:a}=r.useContext(Y),l=a[a.length-1],c=l?l.params:{},h=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,f=X();if(n){var p;let e="string"===typeof n?m(n):n;"/"===h||(null==(p=e.pathname)?void 0:p.startsWith(h))||u(!1),d=e}else d=f;let g=d.pathname||"/",y=v(e,{pathname:"/"===h?g:g.slice(h.length)||"/"});let _=ae(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:F([h,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:F([h,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,i,s);return n&&_?r.createElement(Q.Provider,{value:{location:W({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:t.Pop}},_):_}function re(){let e=function(){var e;let t=r.useContext(J),n=he(ce.UseRouteError),i=de(ce.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:s},n):null,null)}const ie=r.createElement(re,null);class se extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(Y.Provider,{value:this.props.routeContext},r.createElement(J.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oe(e){let{routeContext:t,match:n,children:i}=e,s=r.useContext(K);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(Y.Provider,{value:t},i)}function ae(e,t,n,i){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===i&&(i=null),null==e){var o;if(null==(o=n)||!o.errors)return null;e=n.matches}let a=e,l=null==(s=n)?void 0:s.errors;if(null!=l){let e=a.findIndex((e=>e.route.id&&(null==l?void 0:l[e.route.id])));e>=0||u(!1),a=a.slice(0,Math.min(a.length,e+1))}let c=!1,h=-1;if(n&&i&&i.v7_partialHydration)for(let r=0;r<a.length;r++){let e=a[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=r),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){c=!0,a=h>=0?a.slice(0,h+1):[a[0]];break}}}return a.reduceRight(((e,i,s)=>{let o,u=!1,d=null,f=null;var p;n&&(o=l&&i.route.id?l[i.route.id]:void 0,d=i.route.errorElement||ie,c&&(h<0&&0===s?(p="route-fallback",!1||fe[p]||(fe[p]=!0),u=!0,f=null):h===s&&(u=!0,f=i.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,s+1)),g=()=>{let t;return t=o?d:u?f:i.route.Component?r.createElement(i.route.Component,null):i.route.element?i.route.element:e,r.createElement(oe,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===s)?r.createElement(se,{location:n.location,revalidation:n.revalidation,component:d,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function ue(e){let t=r.useContext(K);return t||u(!1),t}function he(e){let t=r.useContext(H);return t||u(!1),t}function de(e){let t=function(e){let t=r.useContext(Y);return t||u(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const fe={};i.startTransition;function pe(e){u(!1)}function me(e){let{basename:n="/",children:i=null,location:s,navigationType:o=t.Pop,navigator:a,static:l=!1,future:c}=e;$()&&u(!1);let h=n.replace(/^\/*/,"/"),d=r.useMemo((()=>({basename:h,navigator:a,static:l,future:W({v7_relativeSplatPath:!1},c)})),[h,c,a,l]);"string"===typeof s&&(s=m(s));let{pathname:f="/",search:p="",hash:g="",state:y=null,key:v="default"}=s,_=r.useMemo((()=>{let e=A(f,h);return null==e?null:{location:{pathname:e,search:p,hash:g,state:y,key:v},navigationType:o}}),[h,f,p,g,y,v,o]);return null==_?null:r.createElement(G.Provider,{value:d},r.createElement(Q.Provider,{children:i,value:_}))}function ge(e){let{children:t,location:n}=e;return ne(ye(t),n)}new Promise((()=>{}));r.Component;function ye(e,t){void 0===t&&(t=[]);let n=[];return r.Children.forEach(e,((e,i)=>{if(!r.isValidElement(e))return;let s=[...t,i];if(e.type===r.Fragment)return void n.push.apply(n,ye(e.props.children,s));e.type!==pe&&u(!1),e.props.index&&e.props.children&&u(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=ye(e.props.children,s)),n.push(o)})),n}function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ve.apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const we=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];new Map;const be=i.startTransition;a.flushSync,i.useId;function Ie(e){let{basename:t,children:n,future:i,window:s}=e,o=r.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),g((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return f("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,a)));let l=o.current,[c,u]=r.useState({action:l.action,location:l.location}),{v7_startTransition:h}=i||{},d=r.useCallback((e=>{h&&be?be((()=>u(e))):u(e)}),[u,h]);return r.useLayoutEffect((()=>l.listen(d)),[l,d]),r.createElement(me,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:i})}const Ee="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Te=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Se=r.forwardRef((function(e,t){let n,{onClick:i,relative:s,reloadDocument:o,replace:a,state:l,target:c,to:h,preventScrollReset:d,unstable_viewTransition:f}=e,m=_e(e,we),{basename:g}=r.useContext(G),y=!1;if("string"===typeof h&&Te.test(h)&&(n=h,Ee))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),n=A(t.pathname,g);t.origin===e.origin&&null!=n?h=n+t.search+t.hash:y=!0}catch(w){}let v=function(e,t){let{relative:n}=void 0===t?{}:t;$()||u(!1);let{basename:i,navigator:s}=r.useContext(G),{hash:o,pathname:a,search:l}=te(e,{relative:n}),c=a;return"/"!==i&&(c="/"===a?i:F([i,a])),s.createHref({pathname:c,search:l,hash:o})}(h,{relative:s}),_=function(e,t){let{target:n,replace:i,state:s,preventScrollReset:o,relative:a,unstable_viewTransition:l}=void 0===t?{}:t,c=ee(),u=X(),h=te(e,{relative:a});return r.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==i?i:p(u)===p(h);c(e,{replace:n,state:s,preventScrollReset:o,relative:a,unstable_viewTransition:l})}}),[u,c,h,i,s,n,e,o,a,l])}(h,{replace:a,state:l,target:c,preventScrollReset:d,relative:s,unstable_viewTransition:f});return r.createElement("a",ve({},m,{href:n||v,onClick:y||o?i:function(e){i&&i(e),e.defaultPrevented||_(e)},ref:t,target:c}))}));var Ce,ke;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ce||(Ce={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(ke||(ke={}));var xe=n(184);const Ne=function(){const e=ee();return(0,xe.jsxs)("div",{className:"addEvent",children:[(0,xe.jsx)("button",{className:"btnCircle",onClick:function(){e("/home")},children:(0,xe.jsx)("i",{className:"fas fa-user"})}),(0,xe.jsx)("button",{className:"btnCircle",onClick:function(){localStorage.clear(),e("/")},children:(0,xe.jsx)("i",{className:"fas fa-sign-out-alt"})})]})},Re=!1,Pe=!1,Ae="${JSCORE_VERSION}",De=function(e,t){if(!e)throw Oe(t)},Oe=function(e){return new Error("Firebase Database ("+Ae+") INTERNAL ASSERT FAILED: "+e)},Le=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Me={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Le(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Fe;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Fe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ue=function(e){const t=Le(e);return Me.encodeByteArray(t,!0)},Ve=function(e){return Ue(e).replace(/\./g,"")},je=function(e){try{return Me.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function qe(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=qe(e[n],t[n]));return e}const Be=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,ze=()=>{try{return Be()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&je(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},We=()=>{var e;return null===(e=ze())||void 0===e?void 0:e.config};class Ke{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function He(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ve(JSON.stringify({alg:"none",type:"JWT"})),Ve(JSON.stringify(s)),""].join(".")}function Ge(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Qe(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ge())}function Ye(){var e;const t=null===(e=ze())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function Je(){return"object"===typeof self&&self.self===self}function $e(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function Xe(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function Ze(){const e=Ge();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function et(){return!0===Re||!0===Pe}function tt(){return!Ye()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nt(){try{return"object"===typeof indexedDB}catch(e){return!1}}class rt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,rt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,it.prototype.create)}}class it{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(st,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new rt(n,s,t)}}const st=/\{\$([^}]+)}/g;function ot(e){return JSON.parse(e)}function at(e){return JSON.stringify(e)}const lt=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=ot(je(s[0])||""),n=ot(je(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:r,signature:i}};function ct(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ut(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function ht(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function dt(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function ft(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(pt(n)&&pt(s)){if(!ft(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function pt(e){return null!==e&&"object"===typeof e}function mt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function gt(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function yt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class vt{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):u<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const e=(s<<5|s>>>27)+r+c+i+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}function _t(e,t){const n=new wt(e,t);return n.subscribe.bind(n)}class wt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=bt),void 0===r.error&&(r.error=bt),void 0===r.complete&&(r.complete=bt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function bt(){}const It=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}};function Et(e,t){return"".concat(e," failed: ").concat(t," argument ")}function Tt(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(Et(e,t)+"must be a valid function.")}function St(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(Et(e,t)+"must be a valid context object.")}const Ct=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function kt(e){return e&&e._delegate?e._delegate:e}class xt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Nt="[DEFAULT]";class Rt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ke;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Nt})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Nt?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.component?this.component.multipleInstances?e:Nt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Pt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Rt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const At=[];var Dt;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Dt||(Dt={}));const Ot={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},Lt=Dt.INFO,Mt={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},Ft=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Mt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class Ut{constructor(e){this.name=e,this._logLevel=Lt,this._logHandler=Ft,this._userLogHandler=null,At.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Ot[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...t),this._logHandler(this,Dt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...t),this._logHandler(this,Dt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...t),this._logHandler(this,Dt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...t),this._logHandler(this,Dt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...t),this._logHandler(this,Dt.ERROR,...t)}}const Vt=(e,t)=>t.some((t=>e instanceof t));let jt,qt;const Bt=new WeakMap,zt=new WeakMap,Wt=new WeakMap,Kt=new WeakMap,Ht=new WeakMap;let Gt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return zt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Wt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Jt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Qt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(qt||(qt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply($t(this),n),Jt(Bt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Jt(e.apply($t(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call($t(this),t,...r);return Wt.set(s,t.sort?t.sort():[t]),Jt(s)}}function Yt(e){return"function"===typeof e?Qt(e):(e instanceof IDBTransaction&&function(e){if(zt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));zt.set(e,t)}(e),Vt(e,jt||(jt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Gt):e)}function Jt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Jt(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Bt.set(t,e)})).catch((()=>{})),Ht.set(t,e),t}(e);if(Kt.has(e))return Kt.get(e);const t=Yt(e);return t!==e&&(Kt.set(e,t),Ht.set(t,e)),t}const $t=e=>Ht.get(e);const Xt=["get","getKey","getAll","getAllKeys","count"],Zt=["put","add","delete","clear"],en=new Map;function tn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(en.get(t))return en.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Zt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Xt.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return en.set(t,s),s}Gt=(e=>({...e,get:(t,n,r)=>tn(t,n)||e.get(t,n,r),has:(t,n)=>!!tn(t,n)||e.has(t,n)}))(Gt);class nn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const rn="@firebase/app",sn="0.10.1",on=new Ut("@firebase/app"),an="[DEFAULT]",ln={[rn]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cn=new Map,un=new Map,hn=new Map;function dn(e,t){try{e.container.addComponent(t)}catch(n){on.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function fn(e,t){e.container.addOrOverwriteComponent(t)}function pn(e){const t=e.name;if(hn.has(t))return on.debug("There were multiple attempts to register component ".concat(t,".")),!1;hn.set(t,e);for(const n of cn.values())dn(n,e);for(const n of un.values())dn(n,e);return!0}function mn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function gn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:an;mn(e,t).clearInstance(n)}function yn(e){return void 0!==e.options}function vn(e){return void 0!==e.settings}function _n(){hn.clear()}const wn=new it("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class bn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wn.create("app-deleted",{appName:this._name})}}class In extends bn{constructor(e,t,n,r){const i=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,s={name:n,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,s,r);else{super(e.options,s,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=new FinalizationRegistry((()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Nn(rn,sn,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){xn(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw wn.create("server-app-deleted")}}const En="10.11.0";function Tn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:an,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw wn.create("bad-app-name",{appName:String(i)});if(n||(n=We()),!n)throw wn.create("no-options");const s=cn.get(i);if(s){if(ft(n,s.options)&&ft(r,s.config))return s;throw wn.create("duplicate-app",{appName:i})}const o=new Pt(i);for(const l of hn.values())o.addComponent(l);const a=new bn(n,r,o);return cn.set(i,a),a}function Sn(e,t){if(Je())throw wn.create("invalid-server-app-environment");let n;void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1),n=yn(e)?e.options:e;const r=Object.assign(Object.assign({},t),n);void 0!==r.releaseOnDeref&&delete r.releaseOnDeref;if(void 0!==t.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw wn.create("finalization-registry-not-supported",{});const i=""+(s=JSON.stringify(r),[...s].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0));var s;const o=un.get(i);if(o)return o.incRefCount(t.releaseOnDeref),o;const a=new Pt(i);for(const c of hn.values())a.addComponent(c);const l=new In(n,t,i,a);return un.set(i,l),l}function Cn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an;const t=cn.get(e);if(!t&&e===an&&We())return Tn();if(!t)throw wn.create("no-app",{appName:e});return t}function kn(){return Array.from(cn.values())}async function xn(e){let t=!1;const n=e.name;if(cn.has(n))t=!0,cn.delete(n);else if(un.has(n)){e.decRefCount()<=0&&(un.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Nn(e,t,n){var r;let i=null!==(r=ln[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void on.warn(e.join(" "))}pn(new xt("".concat(i,"-version"),(()=>({library:i,version:t})),"VERSION"))}function Rn(e,t){if(null!==e&&"function"!==typeof e)throw wn.create("invalid-log-argument");!function(e,t){for(const n of At){let r=null;t&&t.level&&(r=Ot[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];const a=s.map((e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((e=>e)).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:Dt[n].toLowerCase(),message:a,args:s,type:t.name})}}}(e,t)}function Pn(e){var t;t=e,At.forEach((e=>{e.setLogLevel(t)}))}const An="firebase-heartbeat-database",Dn=1,On="firebase-heartbeat-store";let Ln=null;function Mn(){return Ln||(Ln=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=Jt(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(Jt(o.result),e.oldVersion,e.newVersion,Jt(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(An,Dn,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(On)}catch(n){console.warn(n)}}}).catch((e=>{throw wn.create("idb-open",{originalErrorMessage:e.message})}))),Ln}async function Fn(e,t){try{const n=(await Mn()).transaction(On,"readwrite"),r=n.objectStore(On);await r.put(t,Un(e)),await n.done}catch(n){if(n instanceof rt)on.warn(n.message);else{const e=wn.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});on.warn(e.message)}}}function Un(e){return"".concat(e.name,"!").concat(e.options.appId)}class Vn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new qn(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=jn();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=jn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Bn(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Bn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Ve(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function jn(){return(new Date).toISOString().substring(0,10)}class qn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!nt()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(ek){t(ek)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Mn()).transaction(On),n=await t.objectStore(On).get(Un(e));return await t.done,n}catch(t){if(t instanceof rt)on.warn(t.message);else{const e=wn.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});on.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Fn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Fn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Bn(e){return Ve(JSON.stringify({version:2,heartbeats:e})).length}var zn;zn="",pn(new xt("platform-logger",(e=>new nn(e)),"PRIVATE")),pn(new xt("heartbeat",(e=>new Vn(e)),"PRIVATE")),Nn(rn,sn,zn),Nn(rn,sn,"esm2017"),Nn("fire-js","");class Wn{constructor(e,t){this._delegate=e,this.firebase=t,dn(e,new xt("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),xn(this._delegate))))}_getService(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:an;var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:an;this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){dn(this._delegate,e)}_addOrOverwriteComponent(e){fn(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Kn=new it("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const Hn=function t(){const n=function(t){const n={},r={__esModule:!0,initializeApp:function(e){const i=Tn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(ct(n,i.name))return n[i.name];const s=new t(i,r);return n[i.name]=s,s},app:i,registerVersion:Nn,setLogLevel:Pn,onLog:Rn,apps:null,SDK_VERSION:En,INTERNAL:{registerComponent:function(e){const n=e.name,s=n.replace("-compat","");if(pn(e)&&"PUBLIC"===e.type){const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[s])throw Kn.create("invalid-app-argument",{appName:n});return e[s]()};void 0!==e.serviceProps&&qe(o,e.serviceProps),r[s]=o,t.prototype[s]=function(){const t=this._getService.bind(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[s]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!ct(n,e=e||an))throw Kn.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((e=>n[e]))}}),i.App=t,r}(Wn);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){qe(n,e)},createSubscribe:_t,ErrorFactory:it,deepExtend:qe}),n}(),Gn=new Ut("@firebase/app-compat");if(Je()&&void 0!==self.firebase){Gn.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Gn.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Qn=Hn;!function(e){Nn("@firebase/app-compat","0.2.31",e)}();Qn.registerVersion("firebase","10.11.0","app-compat");function Yn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;const Jn={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},$n="EMAIL_SIGNIN",Xn="PASSWORD_RESET",Zn="RECOVER_EMAIL",er="REVERT_SECOND_FACTOR_ADDITION",tr="VERIFY_AND_CHANGE_EMAIL",nr="VERIFY_EMAIL";function rr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ir=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},sr=rr,or=new it("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ar=new Ut("@firebase/auth");function lr(e){if(ar.logLevel<=Dt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ar.error("Auth (".concat(En,"): ").concat(e),...n)}}function cr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw pr(e,...n)}function ur(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pr(e,...n)}function hr(e,t,n){const r=Object.assign(Object.assign({},sr()),{[t]:n});return new it("auth","Firebase",r).create(t,{appName:e.name})}function dr(e){return hr(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fr(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&cr(e,"argument-error"),hr(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return or.create(e,...n)}function mr(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw pr(t,...r)}}function gr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw lr(t),new Error(t)}function yr(e,t){e||gr(t)}function vr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function _r(){return"http:"===wr()||"https:"===wr()}function wr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class br{constructor(e,t){this.shortDelay=e,this.longDelay=t,yr(t>e,"Short delay should be less than long delay!"),this.isMobile=Qe()||Xe()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(_r()||$e()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ir(e,t){yr(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Er{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void gr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void gr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void gr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Tr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Sr=new br(3e4,6e4);function Cr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function kr(e,t,n,r){return xr(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=mt(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Er.fetch()(Rr(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function xr(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Tr),t);try{const t=new Ar(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Dr(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Dr(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Dr(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Dr(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw hr(e,a,o);cr(e,a)}}catch(i){if(i instanceof rt)throw i;cr(e,"network-request-failed",{message:String(i)})}}async function Nr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await kr(e,t,n,r,i);return"mfaPendingCredential"in s&&cr(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Rr(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Ir(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function Pr(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ar{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(ur(this.auth,"network-request-failed"))),Sr.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Dr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ur(e,t,r);return i.customData._tokenResponse=n,i}function Or(e){return void 0!==e&&void 0!==e.getResponse}function Lr(e){return void 0!==e&&void 0!==e.enterprise}class Mr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Pr(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Fr(e,t){return kr(e,"GET","/v2/recaptchaConfig",Cr(e,t))}async function Ur(e,t){return kr(e,"POST","/v1/accounts:lookup",t)}function Vr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function jr(e){return 1e3*Number(e)}function qr(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return lr("JWT malformed, contained fewer than 3 sections"),null;try{const e=je(n);return e?JSON.parse(e):(lr("Failed to decode base64 JWT payload"),null)}catch(i){return lr("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function Br(e){const t=qr(e);return mr(t,"internal-error"),mr("undefined"!==typeof t.exp,"internal-error"),mr("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function zr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof rt&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Wr{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Kr{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vr(this.lastLoginAt),this.creationTime=Vr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Hr(e){var t;const n=e.auth,r=await e.getIdToken(),i=await zr(e,Ur(n,{idToken:r}));mr(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Gr(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Kr(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function Gr(e){return e.map((e=>{var{providerId:t}=e,n=Yn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Qr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){mr(e.idToken,"internal-error"),mr("undefined"!==typeof e.idToken,"internal-error"),mr("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Br(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){mr(0!==e.length,"internal-error");const t=Br(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(mr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await xr(e,{},(async()=>{const n=mt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Rr(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Er.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Qr;return n&&(mr("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(mr("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(mr("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qr,this.toJSON())}_performRefresh(){return gr("not implemented")}}function Yr(e,t){mr("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Jr{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Yn(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Wr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Kr(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await zr(this,this.stsTokenManager.getToken(this.auth,e));return mr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=kt(e),r=await n.getIdToken(t),i=qr(r);mr(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Vr(jr(i.auth_time)),issuedAtTime:Vr(jr(i.iat)),expirationTime:Vr(jr(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=kt(e);await Hr(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(mr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Jr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){mr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Hr(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(dr(this.auth));const e=await this.getIdToken();return await zr(this,async function(e,t){return kr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:I}=t;mr(v&&I,e,"internal-error");const E=Qr.fromJSON(this.name,I);mr("string"===typeof v,e,"internal-error"),Yr(u,e.name),Yr(h,e.name),mr("boolean"===typeof _,e,"internal-error"),mr("boolean"===typeof w,e,"internal-error"),Yr(d,e.name),Yr(f,e.name),Yr(p,e.name),Yr(m,e.name),Yr(g,e.name),Yr(y,e.name);const T=new Jr({uid:v,auth:e,email:h,emailVerified:_,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(T.providerData=b.map((e=>Object.assign({},e)))),m&&(T._redirectEventId=m),T}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Qr;r.updateFromServerResponse(t);const i=new Jr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Hr(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];mr(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Gr(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new Qr;o.updateFromIdToken(n);const a=new Jr({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Kr(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const $r=new Map;function Xr(e){yr(e instanceof Function,"Expected a class definition");let t=$r.get(e);return t?(yr(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,$r.set(e,t),t)}class Zr{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Zr.type="NONE";const ei=Zr;function ti(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class ni{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ti(this.userKey,r.apiKey,i),this.fullPersistenceKey=ti("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Jr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ni(Xr(ei),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Xr(ei);const s=ti(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=Jr._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new ni(i,e,n)):new ni(i,e,n)}}function ri(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ai(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ii(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ci(t))return"Blackberry";if(ui(t))return"Webos";if(si(t))return"Safari";if((t.includes("chrome/")||oi(t))&&!t.includes("edge/"))return"Chrome";if(li(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ii(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/firefox\//i.test(e)}function si(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function oi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/crios\//i.test(e)}function ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/iemobile/i.test(e)}function li(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/android/i.test(e)}function ci(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/blackberry/i.test(e)}function ui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/webos/i.test(e)}function hi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function di(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return hi(e)||li(e)||ui(e)||ci(e)||/windows phone/i.test(e)||ai(e)}function fi(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ri(Ge());break;case"Worker":t="".concat(ri(Ge()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(En,"/").concat(r)}class pi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class mi{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class gi{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vi(this),this.idTokenSubscription=new vi(this),this.beforeStateQueue=new pi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=or,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xr(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await ni.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Ur(this,{idToken:e}),n=await Jr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(vn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return mr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hr(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(dr(this));const t=e?kt(e):null;return t&&mr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&mr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return vn(this.app)?Promise.reject(dr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(dr(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Xr(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return kr(e,"GET","/v2/passwordPolicy",Cr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new mi(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new it("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return kr(e,"POST","/v2/accounts:revokeToken",Cr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Xr(e)||this._popupRedirectResolver;mr(t,this,"argument-error"),this.redirectPersistenceManager=await ni.create(this,[Xr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(mr(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return mr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(ar.logLevel<=Dt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ar.warn("Auth (".concat(En,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function yi(e){return kt(e)}class vi{constructor(e){this.auth=e,this.observer=null,this.addObserver=_t((e=>this.observer=e))}get next(){return mr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _i={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wi(e){return _i.loadJS(e)}function bi(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Ii{constructor(e){this.type="recaptcha-enterprise",this.auth=yi(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Lr(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Fr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Mr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Lr(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=_i.recaptchaEnterpriseScript;0!==t.length&&(t+=i),wi(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ei(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Ii(e);let s;try{s=await i.verify(n)}catch(ek){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ti(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ei(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Ei(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Si(e,t,n){const r=yi(e);mr(r._canInitEmulator,r,"emulator-config-failed"),mr(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Ci(t),{host:o,port:a}=function(e){const t=Ci(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ki(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ki(t)}}}(t),l=null===a?"":":".concat(a);r.config.emulator={url:"".concat(s,"//").concat(o).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ci(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ki(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gr("not implemented")}_getIdTokenResponse(e){return gr("not implemented")}_linkToIdToken(e,t){return gr("not implemented")}_getReauthenticationResolver(e){return gr("not implemented")}}async function Ni(e,t){return kr(e,"POST","/v1/accounts:resetPassword",Cr(e,t))}async function Ri(e,t){return kr(e,"POST","/v1/accounts:signUp",t)}async function Pi(e,t){return Nr(e,"POST","/v1/accounts:signInWithPassword",Cr(e,t))}async function Ai(e,t){return kr(e,"POST","/v1/accounts:sendOobCode",Cr(e,t))}async function Di(e,t){return Ai(e,t)}async function Oi(e,t){return Ai(e,t)}class Li extends xi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Li(e,t,"password")}static _fromEmailAndCode(e,t){return new Li(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ti(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Pi);case"emailLink":return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithEmailLink",Cr(e,t))}(e,{email:this._email,oobCode:this._password});default:cr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ti(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ri);case"emailLink":return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithEmailLink",Cr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:cr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Mi(e,t){return Nr(e,"POST","/v1/accounts:signInWithIdp",Cr(e,t))}class Fi extends xi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Yn(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Fi(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Mi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Mi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Mi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mt(t)}return e}}const Ui={USER_NOT_FOUND:"user-not-found"};class Vi extends xi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Vi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Vi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",Cr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",Cr(e,t));if(n.temporaryProof)throw Dr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",Cr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ui)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Vi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class ji{constructor(e){var t,n,r,i,s,o;const a=gt(yt(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);mr(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=gt(yt(e)).link,n=t?gt(yt(t)).deep_link_id:null,r=gt(yt(e)).deep_link_id;return(r?gt(yt(r)).link:null)||r||n||t||e}(e);try{return new ji(t)}catch(n){return null}}}class qi{constructor(){this.providerId=qi.PROVIDER_ID}static credential(e,t){return Li._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ji.parseLink(t);return mr(n,"argument-error"),Li._fromEmailAndCode(e,n.code,n.tenantId)}}qi.PROVIDER_ID="password",qi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",qi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Bi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zi extends Bi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Wi extends zi{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return mr("providerId"in t&&"signInMethod"in t,"argument-error"),Fi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return mr(e.idToken||e.accessToken,"argument-error"),Fi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Wi.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Wi.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=t;if(!r&&!i&&!n&&!s)return null;if(!a)return null;try{return new Wi(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch(l){return null}}}class Ki extends zi{constructor(){super("facebook.com")}static credential(e){return Fi._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ki.credential(t.oauthAccessToken)}catch(n){return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ki.PROVIDER_ID="facebook.com";class Hi extends zi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fi._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Hi.credential(n,r)}catch(i){return null}}}Hi.GOOGLE_SIGN_IN_METHOD="google.com",Hi.PROVIDER_ID="google.com";class Gi extends zi{constructor(){super("github.com")}static credential(e){return Fi._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Gi.credential(t.oauthAccessToken)}catch(n){return null}}}Gi.GITHUB_SIGN_IN_METHOD="github.com",Gi.PROVIDER_ID="github.com";class Qi extends xi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Mi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Mi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Mi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Qi(n,i):null}static _create(e,t){return new Qi(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Yi extends Bi{constructor(e){mr(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Yi.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Yi.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Qi.fromJSON(e);return mr(t,"argument-error"),t}static samlCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{pendingToken:n,providerId:r}=t;if(!n||!r)return null;try{return Qi._create(r,n)}catch(i){return null}}}class Ji extends zi{constructor(){super("twitter.com")}static credential(e,t){return Fi._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Ji.credential(n,r)}catch(i){return null}}}async function $i(e,t){return Nr(e,"POST","/v1/accounts:signUp",Cr(e,t))}Ji.TWITTER_SIGN_IN_METHOD="twitter.com",Ji.PROVIDER_ID="twitter.com";class Xi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Jr._fromIdTokenResponse(e,n,r),s=Zi(n);return new Xi({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Zi(n);return new Xi({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Zi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class es extends rt{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,es.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new es(e,t,n,r)}}function ts(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw es._fromErrorAndOperation(e,n,t,r);throw n}))}function ns(e){return new Set(e.map((e=>{let{providerId:t}=e;return t})).filter((e=>!!e)))}async function rs(e,t){const n=kt(e);await ss(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return kr(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=ns(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function is(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await zr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Xi._forOperation(e,"link",r)}async function ss(e,t,n){await Hr(t);const r=!1===e?"provider-already-linked":"no-such-provider";mr(ns(t.providerData).has(n)===e,t.auth,r)}async function os(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(vn(r.app))return Promise.reject(dr(r));const i="reauthenticate";try{const s=await zr(e,ts(r,i,t,e),n);mr(s.idToken,r,"internal-error");const o=qr(s.idToken);mr(o,r,"internal-error");const{sub:a}=o;return mr(e.uid===a,r,"user-mismatch"),Xi._forOperation(e,i,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&cr(r,"user-mismatch"),s}}async function as(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(vn(e.app))return Promise.reject(dr(e));const r="signIn",i=await ts(e,r,t),s=await Xi._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ls(e,t){return as(yi(e),t)}async function cs(e,t){const n=kt(e);return await ss(!1,n,t.providerId),is(n,t)}async function us(e,t){return os(kt(e),t)}async function hs(e,t){if(vn(e.app))return Promise.reject(dr(e));const n=yi(e),r=await async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithCustomToken",Cr(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Xi._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class ds{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?fs._fromServerResponse(e,t):"totpInfo"in t?ps._fromServerResponse(e,t):cr(e,"internal-error")}}class fs extends ds{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new fs(t)}}class ps extends ds{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new ps(t)}}function ms(e,t,n){var r;mr((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),mr("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(mr(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(mr(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function gs(e){const t=yi(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function ys(e,t,n){const r=yi(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&ms(r,i,n),await Ti(r,i,"getOobCode",Di)}async function vs(e,t){await async function(e,t){return kr(e,"POST","/v1/accounts:update",Cr(e,t))}(kt(e),{oobCode:t})}async function _s(e,t){const n=kt(e),r=await Ni(n,{oobCode:t}),i=r.requestType;switch(mr(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":mr(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":mr(r.mfaInfo,n,"internal-error");default:mr(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=ds._fromServerResponse(yi(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function ws(e,t,n){if(vn(e.app))return Promise.reject(dr(e));const r=yi(e),i=Ti(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$i),s=await i.catch((t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&gs(e),t})),o=await Xi._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}function bs(e,t,n){return vn(e.app)?Promise.reject(dr(e)):ls(kt(e),qi.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&gs(e),t}))}async function Is(e,t){const n={identifier:t,continueUri:_r()?vr():"http://localhost"},{signinMethods:r}=await async function(e,t){return kr(e,"POST","/v1/accounts:createAuthUri",Cr(e,t))}(kt(e),n);return r||[]}async function Es(e,t){const n=kt(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&ms(n.auth,r,t);const{email:i}=await async function(e,t){return Ai(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function Ts(e,t,n){const r=kt(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&ms(r.auth,i,n);const{email:s}=await async function(e,t){return Ai(e,t)}(r.auth,i);s!==e.email&&await e.reload()}async function Ss(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=kt(e),s={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await zr(i,async function(e,t){return kr(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}async function Cs(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await zr(e,async function(e,t){return kr(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class ks{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isNewUser=e,this.providerId=t,this.profile=n}}class xs extends ks{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Ns extends ks{constructor(e,t){super(e,"facebook.com",t)}}class Rs extends xs{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class Ps extends ks{constructor(e,t){super(e,"google.com",t)}}class As extends xs{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Ds(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){const r=null===(n=null===(t=qr(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new ks(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Ns(s,i);case"github.com":return new Rs(s,i);case"google.com":return new Ps(s,i);case"twitter.com":return new As(s,i,e.screenName||null);case"custom":case"anonymous":return new ks(s,null);default:return new ks(s,r,i)}}(n)}class Os{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Os("enroll",e,t)}static _fromMfaPendingCredential(e){return new Os("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Os._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Os._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Ls{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=yi(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>ds._fromServerResponse(n,e)));mr(r.mfaPendingCredential,n,"internal-error");const s=Os._fromMfaPendingCredential(r.mfaPendingCredential);return new Ls(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await Xi._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return mr(t.user,n,"internal-error"),Xi._forOperation(t.user,t.operationType,o);default:cr(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class Ms{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>ds._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new Ms(e)}async getSession(){return Os._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await zr(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await zr(this.user,function(e,t){return kr(e,"POST","/v2/accounts/mfaEnrollment:withdraw",Cr(e,t))}(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter((e=>{let{uid:n}=e;return n!==t})),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(r){throw r}}}const Fs=new WeakMap;const Us="__sak";class Vs{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Us,"1"),this.storage.removeItem(Us),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class js extends Vs{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Ge();return si(e)||hi(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=di(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Ze()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}js.type="LOCAL";const qs=js;class Bs extends Vs{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Bs.type="SESSION";const zs=Bs;class Ws{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ws(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ws.receivers=[];class Hs{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=Ks("",20);r.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Gs(){return window}function Qs(){return"undefined"!==typeof Gs().WorkerGlobalScope&&"function"===typeof Gs().importScripts}const Ys="firebaseLocalStorageDb",Js="firebaseLocalStorage",$s="fbase_key";class Xs{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Zs(e,t){return e.transaction([Js],t?"readwrite":"readonly").objectStore(Js)}function eo(){const e=indexedDB.open(Ys,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Js,{keyPath:$s})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Js)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ys);return new Xs(e).toPromise()}(),t(await eo()))}))}))}async function to(e,t,n){const r=Zs(e,!0).put({[$s]:t,value:n});return new Xs(r).toPromise()}function no(e,t){const n=Zs(e,!0).delete(t);return new Xs(n).toPromise()}class ro{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await eo()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Qs()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ws._getInstance(Qs()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Hs(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eo();return await to(e,Us,"1"),await no(e,Us),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>to(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Zs(e,!1).get(t),r=await new Xs(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>no(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Zs(e,!1).getAll();return new Xs(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ro.type="LOCAL";const io=ro;const so=1e12;class oo{constructor(e){this.auth=e,this.counter=so,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new ao(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||so;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||so;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||so;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class ao{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;mr(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const lo=bi("rcb"),co=new br(3e4,6e4);class uo{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Gs().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return mr(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Or(Gs().grecaptcha)?Promise.resolve(Gs().grecaptcha):new Promise(((n,r)=>{const i=Gs().setTimeout((()=>{r(ur(e,"network-request-failed"))}),co.get());Gs()[lo]=()=>{Gs().clearTimeout(i),delete Gs()[lo];const s=Gs().grecaptcha;if(!s||!Or(s))return void r(ur(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};wi("".concat(_i.recaptchaV2Script,"?").concat(mt({onload:lo,render:"explicit",hl:t}))).catch((()=>{clearTimeout(i),r(ur(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Gs().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ho{async load(e){return new oo(e)}clearedOneInstance(){}}const fo="recaptcha",po={theme:"light",type:"image"};class mo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},po);this.parameters=n,this.type=fo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=yi(e),this.isInvisible="invisible"===this.parameters.size,mr("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof t?document.getElementById(t):t;mr(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ho:new uo,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){mr(!this.parameters.sitekey,this.auth,"argument-error"),mr(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),mr("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"===typeof e)e(t);else if("string"===typeof e){const n=Gs()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){mr(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){mr(_r()&&!Qs(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await kr(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);mr(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return mr(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class go{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Vi._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function yo(e,t,n){var r;const i=await n.verify();try{let s;if(mr("string"===typeof i,e,"argument-error"),mr(n.type===fo,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){mr("enroll"===t.type,e,"internal-error");const n=await function(e,t){return kr(e,"POST","/v2/accounts/mfaEnrollment:start",Cr(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{mr("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;mr(n,e,"missing-multi-factor-info");const o=await function(e,t){return kr(e,"POST","/v2/accounts/mfaSignIn:start",Cr(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return kr(e,"POST","/v1/accounts:sendVerificationCode",Cr(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class vo{constructor(e){this.providerId=vo.PROVIDER_ID,this.auth=yi(e)}verifyPhoneNumber(e,t){return yo(this.auth,e,kt(t))}static credential(e,t){return Vi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return vo.credentialFromTaggedObject(t)}static credentialFromError(e){return vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Vi._fromTokenResponse(n,r):null}}function _o(e,t){return t?Xr(t):(mr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}vo.PROVIDER_ID="phone",vo.PHONE_SIGN_IN_METHOD="phone";class wo extends xi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Mi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Mi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function bo(e){return as(e.auth,new wo(e),e.bypassAuthState)}function Io(e){const{auth:t,user:n}=e;return mr(n,t,"internal-error"),os(n,new wo(e),e.bypassAuthState)}async function Eo(e){const{auth:t,user:n}=e;return mr(n,t,"internal-error"),is(n,new wo(e),e.bypassAuthState)}class To{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bo;case"linkViaPopup":case"linkViaRedirect":return Eo;case"reauthViaPopup":case"reauthViaRedirect":return Io;default:cr(this.auth,"internal-error")}}resolve(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const So=new br(2e3,1e4);class Co extends To{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Co.currentPopupAction&&Co.currentPopupAction.cancel(),Co.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return mr(e,this.auth,"internal-error"),e}async onExecution(){yr(1===this.filter.length,"Popup operations only handle one event");const e=Ks();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(ur(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ur(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Co.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ur(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,So.get())};e()}}Co.currentPopupAction=null;const ko="pendingRedirect",xo=new Map;class No extends To{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=xo.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Do(t),r=Ao(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}xo.set(this.auth._key(),e)}return this.bypassAuthState||xo.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Ro(e,t){return Ao(e)._set(Do(t),"true")}function Po(e,t){xo.set(e._key(),t)}function Ao(e){return Xr(e._redirectPersistence)}function Do(e){return ti(ko,e.config.apiKey,e.name)}function Oo(e,t,n){return async function(e,t,n){if(vn(e.app))return Promise.reject(dr(e));const r=yi(e);fr(e,t,Bi),await r._initializationPromise;const i=_o(r,n);return await Ro(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function Lo(e,t,n){return async function(e,t,n){const r=kt(e);if(fr(r.auth,t,Bi),vn(r.auth.app))return Promise.reject(dr(r.auth));await r.auth._initializationPromise;const i=_o(r.auth,n);await Ro(i,r.auth);const s=await Uo(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function Mo(e,t,n){return async function(e,t,n){const r=kt(e);fr(r.auth,t,Bi),await r.auth._initializationPromise;const i=_o(r.auth,n);await ss(!1,r,t.providerId),await Ro(i,r.auth);const s=await Uo(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function Fo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(vn(e.app))return Promise.reject(dr(e));const r=yi(e),i=_o(r,t),s=new No(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function Uo(e){const t=Ks("".concat(e.uid,":::"));return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class Vo{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qo(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!qo(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ur(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(jo(e))}saveEventToCache(e){this.cachedEventUids.add(jo(e)),this.lastProcessedEventTime=Date.now()}}function jo(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function qo(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}async function Bo(e){return kr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}const zo=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wo=/^https?/;function Ko(e){const t=vr(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Wo.test(n))return!1;if(zo.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Ho=new br(3e4,6e4);function Go(){const e=Gs().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Qo(e){return new Promise(((t,n)=>{var r,i,s;function o(){Go(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Go(),n(ur(e,"network-request-failed"))},timeout:Ho.get()})}if(null===(i=null===(r=Gs().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Gs().gapi)||void 0===s?void 0:s.load)){const t=bi("iframefcb");return Gs()[t]=()=>{gapi.load?o():n(ur(e,"network-request-failed"))},wi("".concat(_i.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}o()}})).catch((e=>{throw Yo=null,e}))}let Yo=null;const Jo=new br(5e3,15e3),$o="__/auth/iframe",Xo="emulator/auth/iframe",Zo={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ea=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ta(e){const t=e.config;mr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ir(t,Xo):"https://".concat(e.config.authDomain,"/").concat($o),r={apiKey:t.apiKey,appName:e.name,v:En},i=ea.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(mt(r).slice(1))}async function na(e){const t=await function(e){return Yo=Yo||Qo(e),Yo}(e),n=Gs().gapi;return mr(n,e,"internal-error"),t.open({where:document.body,url:ta(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zo,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=ur(e,"network-request-failed"),s=Gs().setTimeout((()=>{r(i)}),Jo.get());function o(){Gs().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const ra={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ia{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function sa(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},ra),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Ge().toLowerCase();n&&(a=oi(c)?"_blank":n),ii(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return hi(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new ia(null);const h=window.open(t||"",a,u);mr(h,e,"popup-blocked");try{h.focus()}catch(d){}return new ia(h)}const oa="__/auth/handler",aa="emulator/auth/handler",la=encodeURIComponent("fac");async function ca(e,t,n,r,i,s){mr(e.config.authDomain,e,"auth-domain-config-required"),mr(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:En,eventId:i};if(t instanceof Bi){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",ht(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof zi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?"#".concat(la,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(oa);return Ir(t,aa)}(e),"?").concat(mt(a).slice(1)).concat(c)}const ua="webStorageSupport";const ha=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zs,this._completeRedirectFn=Fo,this._overrideRedirectResult=Po}async _openPopup(e,t,n,r){var i;yr(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return sa(e,await ca(e,t,n,vr(),r),Ks())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Gs().location.href=e}(await ca(e,t,n,vr(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(yr(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await na(e),n=new Vo(e);return t.register("authEvent",(t=>{mr(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ua,{type:ua},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[ua];void 0!==i&&t(!!i),cr(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Bo(e);for(const r of t)try{if(Ko(r))return}catch(n){}cr(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return di()||si()||hi()}};class da{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return gr("unexpected MultiFactorSessionType")}}}class fa extends da{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new fa(e)}_finalizeEnroll(e,t,n){return function(e,t){return kr(e,"POST","/v2/accounts/mfaEnrollment:finalize",Cr(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return kr(e,"POST","/v2/accounts/mfaSignIn:finalize",Cr(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class pa{constructor(){}static assertion(e){return fa._fromCredential(e)}}pa.FACTOR_ID="phone";var ma="@firebase/auth",ga="1.7.1";class ya{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){mr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(e=>{var t;null===(t=ze())||void 0===t||t["_".concat(e)]})("authIdTokenMaxAge");var va;function _a(){return window}!function(e){_i=e}({loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=ur("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),va="Browser",pn(new xt("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;mr(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:va,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fi(va)},c=new gi(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Xr);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),pn(new xt("auth-internal",(e=>(e=>new ya(e))(yi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Nn(ma,ga,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(va)),Nn(ma,ga,"esm2017");async function wa(e,t,n){var r;const{BuildInfo:i}=_a();yr(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(yr(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return hi()?o.ibi=i.packageName:li()?o.apn=i.packageName:cr(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,ca(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function ba(e){const{cordova:t}=_a();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}const Ia=20;class Ea extends Vo{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function Ta(e){const t=await ka()._get(xa(e));return t&&await ka()._remove(xa(e)),t}function Sa(e,t){var n,r;const i=function(e){const t=Na(e),n=t.link?decodeURIComponent(t.link):void 0,r=Na(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Na(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=Na(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null===s||void 0===s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?ur(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Ca(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Ia;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function ka(){return Xr(qs)}function xa(e){return ti("authEvent",e.config.apiKey,e.name)}function Na(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return gt(n.join("?"))}const Ra=class{constructor(){this._redirectPersistence=zs,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Fo,this._overrideRedirectResult=Po}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Ea(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){cr(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,l,c,u;const h=_a();mr("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),mr("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),mr("function"===typeof(null===(s=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),mr("function"===typeof(null===(l=null===(a=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),mr("function"===typeof(null===(u=null===(c=null===h||void 0===h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===u?void 0:u.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),xo.clear(),await this._originValidation(e);const s=function(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:Ca(),postBody:null,tenantId:e.tenantId,error:ur(e,"no-auth-event")}}(e,n,r);await function(e,t){return ka()._set(xa(e),t)}(e,s);const o=await wa(e,s,t);return async function(e,t,n){const{cordova:r}=_a();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function l(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"===typeof t&&t(),"function"===typeof(null===n||void 0===n?void 0:n.close)&&n.close()}function c(){a||(a=window.setTimeout((()=>{o(ur(e,"redirect-cancelled-by-user"))}),2e3))}function u(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}t.addPassiveListener(l),document.addEventListener("resume",c,!1),li()&&document.addEventListener("visibilitychange",u,!1),i=()=>{t.removePassiveListener(l),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await ba(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=_a(),n={};hi()?n.iosBundleId=t.packageName:li()?n.androidPackageName=t.packageName:cr(e,"operation-not-supported-in-this-environment"),await Bo(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=_a(),s=setTimeout((async()=>{await Ta(e),t.onEvent(Pa())}),500),o=async n=>{clearTimeout(s);const r=await Ta(e);let i=null;r&&(null===n||void 0===n?void 0:n.url)&&(i=Sa(r,n.url)),t.onEvent(i||Pa())};"undefined"!==typeof n&&"function"===typeof n.subscribe&&n.subscribe(null,o);const a=r,l="".concat(i.packageName.toLowerCase(),"://");_a().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(l)&&o({url:e}),"function"===typeof a)try{a(e)}catch(t){console.error(t)}}}};function Pa(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ur("no-auth-event")}}function Aa(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Da(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return!("file:"!==Aa()&&"ionic:"!==Aa()&&"capacitor:"!==Aa()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Oa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return Ze()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/Edge\/\d+/.test(e)}(e)}function La(){try{const e=self.localStorage,t=Ks();if(e)return e.setItem(t,"1"),e.removeItem(t),!Oa()||nt()}catch(e){return Ma()&&nt()}return!1}function Ma(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Fa(){return("http:"===Aa()||"https:"===Aa()||$e()||Da())&&!(Xe()||Ye())&&La()&&!Ma()}function Ua(){return Da()&&"undefined"!==typeof document}const Va={LOCAL:"local",NONE:"none",SESSION:"session"},ja=mr,qa="persistence";async function Ba(e){await e._initializationPromise;const t=za(),n=ti(qa,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function za(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}const Wa=mr;class Ka{constructor(){this.browserResolver=Xr(ha),this.cordovaResolver=Xr(Ra),this.underlyingResolver=null,this._redirectPersistence=zs,this._completeRedirectFn=Fo,this._overrideRedirectResult=Po}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Ua()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Wa(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!Ua()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function Ha(e){return e.unwrap()}function Ga(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code)){t.resolver=new $a(e,function(e,t){var n;const r=kt(e),i=t;return mr(t.customData.operationType,r,"argument-error"),mr(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Ls._fromError(r,i)}(e,t))}else if(r){const e=Qa(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function Qa(e){const{_tokenResponse:t}=e instanceof rt?e.customData:e;if(!t)return null;if(!(e instanceof rt)&&"temporaryProof"in t&&"phoneNumber"in t)return vo.credentialFromResult(e);const n=t.providerId;if(!n||n===Jn.PASSWORD)return null;let r;switch(n){case Jn.GOOGLE:r=Hi;break;case Jn.FACEBOOK:r=Ki;break;case Jn.GITHUB:r=Gi;break;case Jn.TWITTER:r=Ji;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?Qi._create(n,o):Fi._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new Wi(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof rt?r.credentialFromError(e):r.credentialFromResult(e)}function Ya(e,t){return t.catch((t=>{throw t instanceof rt&&Ga(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,Qa(r)),additionalUserInfo:Ds(e),user:Xa.getOrCreate(n)};var r}))}async function Ja(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>Ya(e,n.confirm(t))}}class $a{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ya(Ha(this.auth),this.resolver.resolveSignIn(e))}}class Xa{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=kt(e);return Fs.has(t)||Fs.set(t,Ms._fromUser(t)),Fs.get(t)}(e)}static getOrCreate(e){return Xa.USER_MAP.has(e)||Xa.USER_MAP.set(e,new Xa(e)),Xa.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ya(this.auth,cs(this._delegate,e))}async linkWithPhoneNumber(e,t){return Ja(this.auth,async function(e,t,n){const r=kt(e);await ss(!1,r,"phone");const i=await yo(r.auth,t,kt(n));return new go(i,(e=>cs(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return Ya(this.auth,async function(e,t,n){const r=kt(e);fr(r.auth,t,Bi);const i=_o(r.auth,n);return new Co(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Ka))}async linkWithRedirect(e){return await Ba(yi(this.auth)),Mo(this._delegate,e,Ka)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ya(this.auth,us(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Ja(this.auth,async function(e,t,n){const r=kt(e);if(vn(r.auth.app))return Promise.reject(dr(r.auth));const i=await yo(r.auth,t,kt(n));return new go(i,(e=>us(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Ya(this.auth,async function(e,t,n){const r=kt(e);if(vn(r.auth.app))return Promise.reject(ur(r.auth,"operation-not-supported-in-this-environment"));fr(r.auth,t,Bi);const i=_o(r.auth,n);return new Co(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Ka))}async reauthenticateWithRedirect(e){return await Ba(yi(this.auth)),Lo(this._delegate,e,Ka)}sendEmailVerification(e){return Es(this._delegate,e)}async unlink(e){return await rs(this._delegate,e),this}updateEmail(e){return function(e,t){const n=kt(e);return vn(n.auth.app)?Promise.reject(dr(n.auth)):Cs(n,t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Cs(kt(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){const n=kt(e);if(vn(n.auth.app))return Promise.reject(dr(n.auth));await is(n,t)}(this._delegate,e)}updateProfile(e){return Ss(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Ts(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Xa.USER_MAP=new WeakMap;const Za=mr;class el{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;Za(n,"invalid-api-key",{appName:e.name}),Za(n,"invalid-api-key",{appName:e.name});const r="undefined"!==typeof window?Ka:void 0;this._delegate=t.initialize({options:{persistence:nl(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(ir),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Xa.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Si(this._delegate,e,t)}applyActionCode(e){return vs(this._delegate,e)}checkActionCode(e){return _s(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await Ni(kt(e),{oobCode:t,newPassword:n}).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&gs(e),t}))}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ya(this._delegate,ws(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Is(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=ji.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){Za(Fa(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await yi(e)._initializationPromise,Fo(e,t,!1)}(this._delegate,Ka);return e?Ya(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){yi(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=tl(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=tl(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return async function(e,t,n){const r=yi(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){mr(t.handleCodeInApp,r,"argument-error"),t&&ms(r,e,t)}(i,n),await Ti(r,i,"getOobCode",Oi)}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return ys(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){ja(Object.values(Va).includes(t),e,"invalid-persistence-type"),Xe()?ja(t!==Va.SESSION,e,"unsupported-persistence-type"):Ye()?ja(t===Va.NONE,e,"unsupported-persistence-type"):Ma()?ja(t===Va.NONE||t===Va.LOCAL&&nt(),e,"unsupported-persistence-type"):ja(t===Va.NONE||La(),e,"unsupported-persistence-type")}(this._delegate,e),e){case Va.SESSION:t=zs;break;case Va.LOCAL:t=await Xr(io)._isAvailable()?io:qs;break;case Va.NONE:t=ei;break;default:return cr("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ya(this._delegate,async function(e){var t;if(vn(e.app))return Promise.reject(dr(e));const n=yi(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Xi({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await $i(n,{returnSecureToken:!0}),i=await Xi._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return Ya(this._delegate,ls(this._delegate,e))}signInWithCustomToken(e){return Ya(this._delegate,hs(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ya(this._delegate,bs(this._delegate,e,t))}signInWithEmailLink(e,t){return Ya(this._delegate,async function(e,t,n){if(vn(e.app))return Promise.reject(dr(e));const r=kt(e),i=qi.credentialWithLink(t,n||vr());return mr(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),ls(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Ja(this._delegate,async function(e,t,n){if(vn(e.app))return Promise.reject(dr(e));const r=yi(e),i=await yo(r,t,kt(n));return new go(i,(e=>ls(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return Za(Fa(),this._delegate,"operation-not-supported-in-this-environment"),Ya(this._delegate,async function(e,t,n){if(vn(e.app))return Promise.reject(ur(e,"operation-not-supported-in-this-environment"));const r=yi(e);fr(e,t,Bi);const i=_o(r,n);return new Co(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,Ka))}async signInWithRedirect(e){return Za(Fa(),this._delegate,"operation-not-supported-in-this-environment"),await Ba(this._delegate),Oo(this._delegate,e,Ka)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await _s(kt(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function tl(e,t,n){let r=e;"function"!==typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Xa.getOrCreate(e)),error:t,complete:n}}function nl(e,t){const n=function(e,t){const n=za();if(!n)return[];const r=ti(qa,e,t);switch(n.getItem(r)){case Va.NONE:return[ei];case Va.LOCAL:return[io,zs];case Va.SESSION:return[zs];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(io)||n.push(io),"undefined"!==typeof window)for(const r of[qs,zs])n.includes(r)||n.push(r);return n.includes(ei)||n.push(ei),n}el.Persistence=Va;class rl{constructor(){this.providerId="phone",this._delegate=new vo(Ha(Qn.auth()))}static credential(e,t){return vo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}rl.PHONE_SIGN_IN_METHOD=vo.PHONE_SIGN_IN_METHOD,rl.PROVIDER_ID=vo.PROVIDER_ID;const il=mr;class sl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.app();var r;il(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new mo(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var ol;(ol=Qn).INTERNAL.registerComponent(new xt("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new el(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:$n,PASSWORD_RESET:Xn,RECOVER_EMAIL:Zn,REVERT_SECOND_FACTOR_ADDITION:er,VERIFY_AND_CHANGE_EMAIL:tr,VERIFY_EMAIL:nr}},EmailAuthProvider:qi,FacebookAuthProvider:Ki,GithubAuthProvider:Gi,GoogleAuthProvider:Hi,OAuthProvider:Wi,SAMLAuthProvider:Yi,PhoneAuthProvider:rl,PhoneMultiFactorGenerator:pa,RecaptchaVerifier:sl,TwitterAuthProvider:Ji,Auth:el,AuthCredential:xi,Error:rt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),ol.registerVersion("@firebase/auth-compat","0.5.6");var al,ll="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},cl={},ul=ul||{},hl=ll||self;function dl(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function fl(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var pl="closure_uid_"+(1e9*Math.random()>>>0),ml=0;function gl(e,t,n){return e.call.apply(e.bind,arguments)}function yl(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function vl(e,t,n){return(vl=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?gl:yl).apply(null,arguments)}function _l(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function wl(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function bl(){this.s=this.s,this.o=this.o}bl.prototype.s=!1,bl.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,pl)&&e[pl]||(e[pl]=++ml))},bl.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Il=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function El(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Tl(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(dl(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function Sl(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Sl.prototype.h=function(){this.defaultPrevented=!0};var Cl=function(){if(!hl.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};hl.addEventListener("test",e,t),hl.removeEventListener("test",e,t)}catch(n){}return e}();function kl(e){return/^[\s\xa0]*$/.test(e)}function xl(){var e=hl.navigator;return e&&(e=e.userAgent)?e:""}function Nl(e){return-1!=xl().indexOf(e)}function Rl(e){return Rl[" "](e),e}Rl[" "]=function(){};var Pl,Al,Dl=Nl("Opera"),Ol=Nl("Trident")||Nl("MSIE"),Ll=Nl("Edge"),Ml=Ll||Ol,Fl=Nl("Gecko")&&!(-1!=xl().toLowerCase().indexOf("webkit")&&!Nl("Edge"))&&!(Nl("Trident")||Nl("MSIE"))&&!Nl("Edge"),Ul=-1!=xl().toLowerCase().indexOf("webkit")&&!Nl("Edge");function Vl(){var e=hl.document;return e?e.documentMode:void 0}e:{var jl="",ql=function(){var e=xl();return Fl?/rv:([^\);]+)(\)|;)/.exec(e):Ll?/Edge\/([\d\.]+)/.exec(e):Ol?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Ul?/WebKit\/(\S+)/.exec(e):Dl?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(ql&&(jl=ql?ql[1]:""),Ol){var Bl=Vl();if(null!=Bl&&Bl>parseFloat(jl)){Pl=String(Bl);break e}}Pl=jl}if(hl.document&&Ol){var zl=Vl();Al=zl||(parseInt(Pl,10)||void 0)}else Al=void 0;var Wl=Al;function Kl(e,t){if(Sl.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Fl){e:{try{Rl(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Hl[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Kl.$.h.call(this)}}wl(Kl,Sl);var Hl={2:"touch",3:"pen",4:"mouse"};Kl.prototype.h=function(){Kl.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Gl="closure_listenable_"+(1e6*Math.random()|0),Ql=0;function Yl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Ql,this.fa=this.ia=!1}function Jl(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function $l(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Xl(e){const t={};for(const n in e)t[n]=e[n];return t}const Zl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ec(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<Zl.length;t++)n=Zl[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function tc(e){this.src=e,this.g={},this.h=0}function nc(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Il(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Jl(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function rc(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}tc.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=rc(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Yl(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var ic="closure_lm_"+(1e6*Math.random()|0),sc={};function oc(e,t,n,r,i){if(r&&r.once)return lc(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)oc(e,t[s],n,r,i);return null}return n=mc(n),e&&e[Gl]?e.O(t,n,fl(r)?!!r.capture:!!r,i):ac(e,t,n,!1,r,i)}function ac(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=fl(i)?!!i.capture:!!i,a=fc(e);if(a||(e[ic]=a=new tc(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=dc;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Cl||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(hc(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function lc(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)lc(e,t[s],n,r,i);return null}return n=mc(n),e&&e[Gl]?e.P(t,n,fl(r)?!!r.capture:!!r,i):ac(e,t,n,!0,r,i)}function cc(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)cc(e,t[s],n,r,i);else r=fl(r)?!!r.capture:!!r,n=mc(n),e&&e[Gl]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=rc(s=e.g[t],n,r,i))&&(Jl(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=fc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=rc(t,n,r,i)),(n=-1<e?t[e]:null)&&uc(n))}function uc(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Gl])nc(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(hc(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=fc(t))?(nc(n,e),0==n.h&&(n.src=null,t[ic]=null)):Jl(e)}}}function hc(e){return e in sc?sc[e]:sc[e]="on"+e}function dc(e,t){if(e.fa)e=!0;else{t=new Kl(t,this);var n=e.listener,r=e.la||e.src;e.ia&&uc(e),e=n.call(r,t)}return e}function fc(e){return(e=e[ic])instanceof tc?e:null}var pc="__closure_events_fn_"+(1e9*Math.random()>>>0);function mc(e){return"function"===typeof e?e:(e[pc]||(e[pc]=function(t){return e.handleEvent(t)}),e[pc])}function gc(){bl.call(this),this.i=new tc(this),this.S=this,this.J=null}function yc(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new Sl(t,e);else if(t instanceof Sl)t.target=t.target||e;else{var i=t;ec(t=new Sl(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=vc(o,r,!0,t)&&i}if(i=vc(o=t.g=e,r,!0,t)&&i,i=vc(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=vc(o=t.g=n[s],r,!1,t)&&i}function vc(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&nc(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}wl(gc,bl),gc.prototype[Gl]=!0,gc.prototype.removeEventListener=function(e,t,n,r){cc(this,e,t,n,r)},gc.prototype.N=function(){if(gc.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Jl(n[r]);delete t.g[e],t.h--}}this.J=null},gc.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},gc.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var _c=hl.JSON.stringify;function wc(){var e=kc;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var bc=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Ic),(e=>e.reset()));class Ic{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Ec(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Tc(e){hl.setTimeout((()=>{throw e}),0)}let Sc,Cc=!1,kc=new class{constructor(){this.h=this.g=null}add(e,t){const n=bc.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},xc=()=>{const e=hl.Promise.resolve(void 0);Sc=()=>{e.then(Nc)}};var Nc=()=>{for(var e;e=wc();){try{e.h.call(e.g)}catch(n){Tc(n)}var t=bc;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Cc=!1};function Rc(e,t){gc.call(this),this.h=e||1,this.g=t||hl,this.j=vl(this.qb,this),this.l=Date.now()}function Pc(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Ac(e,t,n){if("function"===typeof e)n&&(e=vl(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=vl(e.handleEvent,e)}return 2147483647<Number(t)?-1:hl.setTimeout(e,t||0)}function Dc(e){e.g=Ac((()=>{e.g=null,e.i&&(e.i=!1,Dc(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}wl(Rc,gc),(al=Rc.prototype).ga=!1,al.T=null,al.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),yc(this,"tick"),this.ga&&(Pc(this),this.start()))}},al.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},al.N=function(){Rc.$.N.call(this),Pc(this),delete this.g};class Oc extends bl{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Dc(this)}N(){super.N(),this.g&&(hl.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lc(e){bl.call(this),this.h=e,this.g={}}wl(Lc,bl);var Mc=[];function Fc(e,t,n,r){Array.isArray(n)||(n&&(Mc[0]=n.toString()),n=Mc);for(var i=0;i<n.length;i++){var s=oc(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Uc(e){$l(e.g,(function(e,t){this.g.hasOwnProperty(t)&&uc(e)}),e),e.g={}}function Vc(){this.g=!0}function jc(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return _c(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}Lc.prototype.N=function(){Lc.$.N.call(this),Uc(this)},Lc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vc.prototype.Ea=function(){this.g=!1},Vc.prototype.info=function(){};var qc={},Bc=null;function zc(){return Bc=Bc||new gc}function Wc(e){Sl.call(this,qc.Ta,e)}function Kc(e){const t=zc();yc(t,new Wc(t))}function Hc(e,t){Sl.call(this,qc.STAT_EVENT,e),this.stat=t}function Gc(e){const t=zc();yc(t,new Hc(t,e))}function Qc(e,t){Sl.call(this,qc.Ua,e),this.size=t}function Yc(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return hl.setTimeout((function(){e()}),t)}qc.Ta="serverreachability",wl(Wc,Sl),qc.STAT_EVENT="statevent",wl(Hc,Sl),qc.Ua="timingevent",wl(Qc,Sl);var Jc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},$c={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Xc(){}function Zc(e){return e.h||(e.h=e.i())}function eu(){}Xc.prototype.h=null;var tu,nu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ru(){Sl.call(this,"d")}function iu(){Sl.call(this,"c")}function su(){}function ou(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Lc(this),this.P=lu,e=Ml?125:void 0,this.V=new Rc(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new au}function au(){this.i=null,this.g="",this.h=!1}wl(ru,Sl),wl(iu,Sl),wl(su,Xc),su.prototype.g=function(){return new XMLHttpRequest},su.prototype.i=function(){return{}},tu=new su;var lu=45e3,cu={},uu={};function hu(e,t,n){e.L=1,e.A=Ru(Su(t)),e.u=n,e.S=!0,du(e,null)}function du(e,t){e.G=Date.now(),gu(e),e.B=Su(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),zu(n.i,"t",r),e.o=0,n=e.l.J,e.h=new au,e.g=Wh(e.l,n?t:null,!e.u),0<e.O&&(e.M=new Oc(vl(e.Pa,e,e.g),e.O)),Fc(e.U,e.g,"readystatechange",e.nb),t=e.I?Xl(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),Kc(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.W,e.u)}function fu(e){return!!e.g&&("GET"==e.v&&2!=e.L&&e.l.Ha)}function pu(e,t,n){let r,i=!0;for(;!e.J&&e.o<n.length;){if(r=mu(e,n),r==uu){4==t&&(e.s=4,Gc(14),i=!1),jc(e.j,e.m,null,"[Incomplete Response]");break}if(r==cu){e.s=4,Gc(15),jc(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}jc(e.j,e.m,r,null),bu(e,r)}fu(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,Gc(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Mh(t),t.M=!0,Gc(11))):(jc(e.j,e.m,n,"[Invalid Chunked Response]"),wu(e),_u(e))}function mu(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?uu:(n=Number(t.substring(n,r)),isNaN(n)?cu:(r+=1)+n>t.length?uu:(t=t.slice(r,r+n),e.o=r+n,t))}function gu(e){e.Y=Date.now()+e.P,yu(e,e.P)}function yu(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=Yc(vl(e.lb,e),t)}function vu(e){e.C&&(hl.clearTimeout(e.C),e.C=null)}function _u(e){0==e.l.H||e.J||Vh(e.l,e)}function wu(e){vu(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Pc(e.V),Uc(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function bu(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Ju(n.i,e)))if(!e.K&&Ju(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Uh(n),xh(n)}Lh(n),Gc(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Yc(vl(n.ib,n),6e3));if(1>=Yu(n.i)&&n.oa){try{n.oa()}catch(c){}n.oa=void 0}}else qh(n,11)}else if((e.K||n.g==e)&&Uh(n),!kl(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const t=c[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&($u(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Nu(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=zh(r,r.J?r.pa:null,r.Y),o.K){Xu(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(vu(a),gu(a)),r.g=o}else Oh(r);0<n.j.length&&Rh(n)}else"stop"!=c[0]&&"close"!=c[0]||qh(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?qh(n,7):kh(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}Kc()}catch(c){}}function Iu(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(dl(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(dl(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(dl(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(al=ou.prototype).setTimeout=function(e){this.P=e},al.nb=function(e){e=e.target;const t=this.M;t&&3==bh(e)?t.l():this.Pa(e)},al.Pa=function(e){try{if(e==this.g)e:{const u=bh(this.g);var t=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||Ml||this.g&&(this.h.h||this.g.ja()||Ih(this.g)))){this.J||4!=u||7==t||Kc(),vu(this);var n=this.g.da();this.ca=n;t:if(fu(this)){var r=Ih(this.g);e="";var i=r.length,s=4==bh(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){wu(this),_u(this);var o="";break t}this.h.i=new hl.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!kl(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.s=3,Gc(12),wu(this),_u(this);break e}jc(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bu(this,n)}this.S?(pu(this,u,o),Ml&&this.i&&3==u&&(Fc(this.U,this.V,"tick",this.mb),this.V.start())):(jc(this.j,this.m,o,null),bu(this,o)),4==u&&wu(this),this.i&&!this.J&&(4==u?Vh(this.l,this):(this.i=!1,gu(this)))}else(function(e){const t={};e=(e.g&&2<=bh(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(kl(e[r]))continue;var n=Ec(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Gc(12)):(this.s=0,Gc(13)),wu(this),_u(this)}}}catch(u){}},al.mb=function(){if(this.g){var e=bh(this.g),t=this.g.ja();this.o<t.length&&(vu(this),pu(this,e,t),this.i&&4!=e&&gu(this))}},al.cancel=function(){this.J=!0,wu(this)},al.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.L&&(Kc(),Gc(17)),wu(this),this.s=2,_u(this)):yu(this,this.Y-e)};var Eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Tu(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Tu){this.h=e.h,Cu(this,e.j),this.s=e.s,this.g=e.g,ku(this,e.m),this.l=e.l;var t=e.i,n=new Vu;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),xu(this,n),this.o=e.o}else e&&(t=String(e).match(Eu))?(this.h=!1,Cu(this,t[1]||"",!0),this.s=Pu(t[2]||""),this.g=Pu(t[3]||"",!0),ku(this,t[4]),this.l=Pu(t[5]||"",!0),xu(this,t[6]||"",!0),this.o=Pu(t[7]||"")):(this.h=!1,this.i=new Vu(null,this.h))}function Su(e){return new Tu(e)}function Cu(e,t,n){e.j=n?Pu(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ku(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function xu(e,t,n){t instanceof Vu?(e.i=t,function(e,t){t&&!e.j&&(ju(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(qu(this,t),zu(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Au(t,Fu)),e.i=new Vu(t,e.h))}function Nu(e,t,n){e.i.set(t,n)}function Ru(e){return Nu(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Pu(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Au(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Du),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Du(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Tu.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Au(t,Ou,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Au(t,Ou,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Au(n,"/"==n.charAt(0)?Mu:Lu,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Au(n,Uu)),e.join("")};var Ou=/[#\/\?@]/g,Lu=/[#\?:]/g,Mu=/[#\?]/g,Fu=/[#\?@]/g,Uu=/#/g;function Vu(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ju(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function qu(e,t){ju(e),t=Wu(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Bu(e,t){return ju(e),t=Wu(e,t),e.g.has(t)}function zu(e,t,n){qu(e,t),0<n.length&&(e.i=null,e.g.set(Wu(e,t),El(n)),e.h+=n.length)}function Wu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(al=Vu.prototype).add=function(e,t){ju(this),this.i=null,e=Wu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},al.forEach=function(e,t){ju(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},al.ta=function(){ju(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},al.Z=function(e){ju(this);let t=[];if("string"===typeof e)Bu(this,e)&&(t=t.concat(this.g.get(Wu(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},al.set=function(e,t){return ju(this),this.i=null,Bu(this,e=Wu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},al.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},al.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var Ku=class{constructor(e,t){this.g=e,this.map=t}};function Hu(e){this.l=e||Gu,hl.PerformanceNavigationTiming?e=0<(e=hl.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(hl.g&&hl.g.Ka&&hl.g.Ka()&&hl.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Gu=10;function Qu(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Yu(e){return e.h?1:e.g?e.g.size:0}function Ju(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function $u(e,t){e.g?e.g.add(t):e.h=t}function Xu(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Zu(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return El(e.i)}Hu.prototype.cancel=function(){if(this.i=Zu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var eh,th=class{stringify(e){return hl.JSON.stringify(e,void 0)}parse(e){return hl.JSON.parse(e,void 0)}};function nh(){this.g=new th}function rh(e,t,n){const r=n||"";try{Iu(e,(function(e,n){let i=e;fl(e)&&(i=_c(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function ih(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function sh(e){this.l=e.ec||null,this.j=e.ob||!1}function oh(e,t){gc.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=ah,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wl(sh,Xc),sh.prototype.g=function(){return new oh(this.l,this.j)},sh.prototype.i=(eh={},function(){return eh}),wl(oh,gc);var ah=0;function lh(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function ch(e){e.readyState=4,e.l=null,e.j=null,e.A=null,uh(e)}function uh(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(al=oh.prototype).open=function(e,t){if(this.readyState!=ah)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,uh(this)},al.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||hl).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},al.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ch(this)),this.readyState=ah},al.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,uh(this)),this.g&&(this.readyState=3,uh(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof hl.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;lh(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},al.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ch(this):uh(this),3==this.readyState&&lh(this)}},al.Za=function(e){this.g&&(this.response=this.responseText=e,ch(this))},al.Ya=function(e){this.g&&(this.response=e,ch(this))},al.ka=function(){this.g&&ch(this)},al.setRequestHeader=function(e,t){this.v.append(e,t)},al.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},al.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(oh.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var hh=hl.JSON.parse;function dh(e){gc.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=fh,this.L=this.M=!1}wl(dh,gc);var fh="",ph=/^https?$/i,mh=["POST","PUT"];function gh(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,yh(e),_h(e)}function yh(e){e.F||(e.F=!0,yc(e,"complete"),yc(e,"error"))}function vh(e){if(e.h&&"undefined"!=typeof ul&&(!e.C[1]||4!=bh(e)||2!=e.da()))if(e.v&&4==bh(e))Ac(e.La,0,e);else if(yc(e,"readystatechange"),4==bh(e)){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.I).match(Eu)[1]||null;!i&&hl.self&&hl.self.location&&(i=hl.self.location.protocol.slice(0,-1)),r=!ph.test(i?i.toLowerCase():"")}n=r}if(n)yc(e,"complete"),yc(e,"success");else{e.m=6;try{var s=2<bh(e)?e.g.statusText:""}catch(o){s=""}e.j=s+" ["+e.da()+"]",yh(e)}}finally{_h(e)}}}function _h(e,t){if(e.g){wh(e);const r=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||yc(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function wh(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(hl.clearTimeout(e.A),e.A=null)}function bh(e){return e.g?e.g.readyState:0}function Ih(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case fh:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Nd){return null}}function Eh(e){let t="";return $l(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Th(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Eh(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Nu(e,t,n))}function Sh(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ch(e){this.Ga=0,this.j=[],this.l=new Vc,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Sh("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Sh("baseRetryDelayMs",5e3,e),this.hb=Sh("retryDelaySeedMs",1e4,e),this.eb=Sh("forwardChannelMaxRetries",2,e),this.xa=Sh("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Hu(e&&e.concurrentRequestLimit),this.Ja=new nh,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function kh(e){if(Nh(e),3==e.H){var t=e.W++,n=Su(e.I);if(Nu(n,"SID",e.K),Nu(n,"RID",t),Nu(n,"TYPE","terminate"),Ah(e,n),(t=new ou(e,e.l,t)).L=2,t.A=Ru(Su(n)),n=!1,hl.navigator&&hl.navigator.sendBeacon)try{n=hl.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&hl.Image&&((new Image).src=t.A,n=!0),n||(t.g=Wh(t.l,null),t.g.ha(t.A)),t.G=Date.now(),gu(t)}Bh(e)}function xh(e){e.g&&(Mh(e),e.g.cancel(),e.g=null)}function Nh(e){xh(e),e.u&&(hl.clearTimeout(e.u),e.u=null),Uh(e),e.i.cancel(),e.m&&("number"===typeof e.m&&hl.clearTimeout(e.m),e.m=null)}function Rh(e){if(!Qu(e.i)&&!e.m){e.m=!0;var t=e.Na;Sc||xc(),Cc||(Sc(),Cc=!0),kc.add(t,e),e.C=0}}function Ph(e,t){var n;n=t?t.m:e.W++;const r=Su(e.I);Nu(r,"SID",e.K),Nu(r,"RID",n),Nu(r,"AID",e.V),Ah(e,r),e.o&&e.s&&Th(r,e.o,e.s),n=new ou(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Dh(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),$u(e.i,n),hu(n,r,t)}function Ah(e,t){e.na&&$l(e.na,(function(e,n){Nu(t,n,e)})),e.h&&Iu({},(function(e,n){Nu(t,n,e)}))}function Dh(e,t,n){n=Math.min(e.j.length,n);var r=e.h?vl(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{rh(a,e,"req"+n+"_")}catch(Hf){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Oh(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Sc||xc(),Cc||(Sc(),Cc=!0),kc.add(t,e),e.A=0}}function Lh(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Yc(vl(e.Ma,e),jh(e,e.A)),e.A++,!0)}function Mh(e){null!=e.B&&(hl.clearTimeout(e.B),e.B=null)}function Fh(e){e.g=new ou(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Su(e.wa);Nu(t,"RID","rpc"),Nu(t,"SID",e.K),Nu(t,"AID",e.V),Nu(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Nu(t,"TO",e.qa),Nu(t,"TYPE","xmlhttp"),Ah(e,t),e.o&&e.s&&Th(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=Ru(Su(t)),n.u=null,n.S=!0,du(n,e)}function Uh(e){null!=e.v&&(hl.clearTimeout(e.v),e.v=null)}function Vh(e,t){var n=null;if(e.g==t){Uh(e),Mh(e),e.g=null;var r=2}else{if(!Ju(e.i,t))return;n=t.F,Xu(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;yc(r=zc(),new Qc(r,n)),Rh(e)}else Oh(e);else if(3==(i=t.s)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(Yu(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Yc(vl(e.Na,e,t),jh(e,e.C)),e.C++,!0))}(e,t)||2==r&&Lh(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:qh(e,5);break;case 4:qh(e,10);break;case 3:qh(e,6);break;default:qh(e,2)}}function jh(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function qh(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=vl(e.pb,e);n||(n=new Tu("//www.google.com/images/cleardot.gif"),hl.location&&"http"==hl.location.protocol||Cu(n,"https"),Ru(n)),function(e,t){const n=new Vc;if(hl.Image){const r=new Image;r.onload=_l(ih,n,r,"TestLoadImage: loaded",!0,t),r.onerror=_l(ih,n,r,"TestLoadImage: error",!1,t),r.onabort=_l(ih,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=_l(ih,n,r,"TestLoadImage: timeout",!1,t),hl.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Gc(2);e.H=0,e.h&&e.h.za(t),Bh(e),Nh(e)}function Bh(e){if(e.H=0,e.ma=[],e.h){const t=Zu(e.i);0==t.length&&0==e.j.length||(Tl(e.ma,t),Tl(e.ma,e.j),e.i.i.length=0,El(e.j),e.j.length=0),e.h.ya()}}function zh(e,t,n){var r=n instanceof Tu?Su(n):new Tu(n);if(""!=r.g)t&&(r.g=t+"."+r.g),ku(r,r.m);else{var i=hl.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Tu(null);r&&Cu(s,r),t&&(s.g=t),i&&ku(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&Nu(r,n,t),Nu(r,"VER",e.ra),Ah(e,r),r}function Wh(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ha&&!e.va?new dh(new sh({ob:n})):new dh(e.va)).Oa(e.J),t}function Kh(){}function Hh(){if(Ol&&!(10<=Number(Wl)))throw Error("Environmental error: no available transport.")}function Gh(e,t){gc.call(this),this.g=new Ch(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!kl(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!kl(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Jh(this)}function Qh(e){ru.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Yh(){iu.call(this),this.status=1}function Jh(e){this.g=e}function $h(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Xh(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function Zh(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(al=dh.prototype).Oa=function(e){this.M=e},al.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():tu.g(),this.C=this.u?Zc(this.u):Zc(tu),this.g.onreadystatechange=vl(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void gh(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=hl.FormData&&e instanceof hl.FormData,!(0<=Il(mh,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{wh(this),0<this.B&&((this.L=function(e){return Ol&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=vl(this.ua,this)):this.A=Ac(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){gh(this,s)}},al.ua=function(){"undefined"!=typeof ul&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yc(this,"timeout"),this.abort(8))},al.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,yc(this,"complete"),yc(this,"abort"),_h(this))},al.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_h(this,!0)),dh.$.N.call(this)},al.La=function(){this.s||(this.G||this.v||this.l?vh(this):this.kb())},al.kb=function(){vh(this)},al.isActive=function(){return!!this.g},al.da=function(){try{return 2<bh(this)?this.g.status:-1}catch(eh){return-1}},al.ja=function(){try{return this.g?this.g.responseText:""}catch(eh){return""}},al.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),hh(t)}},al.Ia=function(){return this.m},al.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(al=Ch.prototype).ra=8,al.H=1,al.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new ou(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Xl(s),ec(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Dh(this,i,t),Nu(n=Su(this.I),"RID",e),Nu(n,"CVER",22),this.F&&Nu(n,"X-HTTP-Session-Id",this.F),Ah(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Eh(s)))+"&"+t:this.o&&Th(n,this.o,s)),$u(this.i,i),this.bb&&Nu(n,"TYPE","init"),this.P?(Nu(n,"$req",t),Nu(n,"SID","null"),i.aa=!0,hu(i,n,null)):hu(i,n,t),this.H=2}}else 3==this.H&&(e?Ph(this,e):0==this.j.length||Qu(this.i)||Ph(this))},al.Ma=function(){if(this.u=null,Fh(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Yc(vl(this.jb,this),e)}},al.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gc(10),xh(this),Fh(this))},al.ib=function(){null!=this.v&&(this.v=null,xh(this),Lh(this),Gc(19))},al.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Gc(2)):(this.l.info("Failed to ping google.com"),Gc(1))},al.isActive=function(){return!!this.h&&this.h.isActive(this)},(al=Kh.prototype).Ba=function(){},al.Aa=function(){},al.za=function(){},al.ya=function(){},al.isActive=function(){return!0},al.Va=function(){},Hh.prototype.g=function(e,t){return new Gh(e,t)},wl(Gh,gc),Gh.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Gc(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=zh(e,null,e.Y),Rh(e)},Gh.prototype.close=function(){kh(this.g)},Gh.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=_c(e),e=n);t.j.push(new Ku(t.fb++,e)),3==t.H&&Rh(t)},Gh.prototype.N=function(){this.g.h=null,delete this.j,kh(this.g),delete this.g,Gh.$.N.call(this)},wl(Qh,ru),wl(Yh,iu),wl(Jh,Kh),Jh.prototype.Ba=function(){yc(this.g,"a")},Jh.prototype.Aa=function(e){yc(this.g,new Qh(e))},Jh.prototype.za=function(e){yc(this.g,new Yh)},Jh.prototype.ya=function(){yc(this.g,"b")},wl($h,(function(){this.blockSize=-1})),$h.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},$h.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)Xh(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){Xh(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){Xh(this,r),i=0;break}}this.h=i,this.i+=t},$h.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var ed={};function td(e){return-128<=e&&128>e?function(e,t){var n=ed;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Zh([0|e],0>e?-1:0)})):new Zh([0|e],0>e?-1:0)}function nd(e){if(isNaN(e)||!isFinite(e))return id;if(0>e)return cd(nd(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=rd;return new Zh(t,0)}var rd=4294967296,id=td(0),sd=td(1),od=td(16777216);function ad(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function ld(e){return-1==e.h}function cd(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Zh(n,~e.h).add(sd)}function ud(e,t){return e.add(cd(t))}function hd(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function dd(e,t){this.g=e,this.h=t}function fd(e,t){if(ad(t))throw Error("division by zero");if(ad(e))return new dd(id,id);if(ld(e))return t=fd(cd(e),t),new dd(cd(t.g),cd(t.h));if(ld(t))return t=fd(e,cd(t)),new dd(cd(t.g),t.h);if(30<e.g.length){if(ld(e)||ld(t))throw Error("slowDivide_ only works with positive integers.");for(var n=sd,r=t;0>=r.X(e);)n=pd(n),r=pd(r);var i=md(n,1),s=md(r,1);for(r=md(r,2),n=md(n,2);!ad(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=md(r,1),n=md(n,1)}return t=ud(e,i.R(t)),new dd(i,t)}for(i=id;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=nd(n)).R(t);ld(o)||0<o.X(e);)o=(s=nd(n-=r)).R(t);ad(s)&&(s=sd),i=i.add(s),e=ud(e,o)}return new dd(i,e)}function pd(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Zh(n,e.h)}function md(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Zh(i,e.h)}(al=Zh.prototype).ea=function(){if(ld(this))return-cd(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:rd+r)*t,t*=rd}return e},al.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(ad(this))return"0";if(ld(this))return"-"+cd(this).toString(e);for(var t=nd(Math.pow(e,6)),n=this,r="";;){var i=fd(n,t).g,s=((0<(n=ud(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(ad(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},al.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},al.X=function(e){return ld(e=ud(this,e))?-1:ad(e)?0:1},al.abs=function(){return ld(this)?cd(this):this},al.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Zh(n,-2147483648&n[n.length-1]?-1:0)},al.R=function(e){if(ad(this)||ad(e))return id;if(ld(this))return ld(e)?cd(this).R(cd(e)):cd(cd(this).R(e));if(ld(e))return cd(this.R(cd(e)));if(0>this.X(od)&&0>e.X(od))return nd(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,hd(n,2*r+2*i),n[2*r+2*i+1]+=s*l,hd(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,hd(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,hd(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Zh(n,0)},al.gb=function(e){return fd(this,e).h},al.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Zh(n,this.h&e.h)},al.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Zh(n,this.h|e.h)},al.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Zh(n,this.h^e.h)},Hh.prototype.createWebChannel=Hh.prototype.g,Gh.prototype.send=Gh.prototype.u,Gh.prototype.open=Gh.prototype.m,Gh.prototype.close=Gh.prototype.close,Jc.NO_ERROR=0,Jc.TIMEOUT=8,Jc.HTTP_ERROR=6,$c.COMPLETE="complete",eu.EventType=nu,nu.OPEN="a",nu.CLOSE="b",nu.ERROR="c",nu.MESSAGE="d",gc.prototype.listen=gc.prototype.O,dh.prototype.listenOnce=dh.prototype.P,dh.prototype.getLastError=dh.prototype.Sa,dh.prototype.getLastErrorCode=dh.prototype.Ia,dh.prototype.getStatus=dh.prototype.da,dh.prototype.getResponseJson=dh.prototype.Wa,dh.prototype.getResponseText=dh.prototype.ja,dh.prototype.send=dh.prototype.ha,dh.prototype.setWithCredentials=dh.prototype.Oa,$h.prototype.digest=$h.prototype.l,$h.prototype.reset=$h.prototype.reset,$h.prototype.update=$h.prototype.j,Zh.prototype.add=Zh.prototype.add,Zh.prototype.multiply=Zh.prototype.R,Zh.prototype.modulo=Zh.prototype.gb,Zh.prototype.compare=Zh.prototype.X,Zh.prototype.toNumber=Zh.prototype.ea,Zh.prototype.toString=Zh.prototype.toString,Zh.prototype.getBits=Zh.prototype.D,Zh.fromNumber=nd,Zh.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return cd(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=nd(Math.pow(n,8)),i=id,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=nd(Math.pow(n,o)),i=i.R(o).add(nd(a))):i=(i=i.R(r)).add(nd(a))}return i};var gd=cl.createWebChannelTransport=function(){return new Hh},yd=cl.getStatEventTarget=function(){return zc()},vd=cl.ErrorCode=Jc,_d=cl.EventType=$c,wd=cl.Event=qc,bd=cl.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Id=(cl.FetchXmlHttpFactory=sh,cl.WebChannel=eu),Ed=cl.XhrIo=dh,Td=cl.Md5=$h,Sd=cl.Integer=Zh;const Cd="@firebase/firestore";class kd{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kd.UNAUTHENTICATED=new kd(null),kd.GOOGLE_CREDENTIALS=new kd("google-credentials-uid"),kd.FIRST_PARTY=new kd("first-party-uid"),kd.MOCK_USER=new kd("mock-user");let xd="10.11.0";const Nd=new Ut("@firebase/firestore");function Rd(){return Nd.logLevel}function Pd(e){if(Nd.logLevel<=Dt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Od);Nd.debug("Firestore (".concat(xd,"): ").concat(e),...i)}}function Ad(e){if(Nd.logLevel<=Dt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Od);Nd.error("Firestore (".concat(xd,"): ").concat(e),...i)}}function Dd(e){if(Nd.logLevel<=Dt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Od);Nd.warn("Firestore (".concat(xd,"): ").concat(e),...i)}}function Od(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ld(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(xd,") INTERNAL ASSERTION FAILED: ")+e;throw Ad(t),new Error(t)}function Md(e,t){e||Ld()}function Fd(e,t){return e}const Ud={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vd extends rt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class jd{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class qd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Bd{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(kd.UNAUTHENTICATED)))}shutdown(){}}class zd{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Wd{constructor(e){this.t=e,this.currentUser=kd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new jd;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jd,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Pd("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Pd("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jd)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Pd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Md("string"==typeof t.accessToken),new qd(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Md(null===e||"string"==typeof e),new kd(e)}}class Kd{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=kd.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Hd{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Kd(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(kd.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Gd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Qd{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&Pd("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,Pd("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Pd("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Pd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Md("string"==typeof e.token),this.R=e.token,new Gd(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Yd(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Jd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Yd(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function $d(e,t){return e<t?-1:e>t?1:0}function Xd(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function Zd(e){return e+"\0"}class ef{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Vd(Ud.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Vd(Ud.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Vd(Ud.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Vd(Ud.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ef.fromMillis(Date.now())}static fromDate(e){return ef.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ef(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$d(this.nanoseconds,e.nanoseconds):$d(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tf{constructor(e){this.timestamp=e}static fromTimestamp(e){return new tf(e)}static min(){return new tf(new ef(0,0))}static max(){return new tf(new ef(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class nf{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ld(),void 0===n?n=e.length-t:n>e.length-t&&Ld(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===nf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof nf?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class rf extends nf{construct(e,t,n){return new rf(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new rf(e)}static emptyPath(){return new rf([])}}const sf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class of extends nf{construct(e,t,n){return new of(e,t,n)}static isValidIdentifier(e){return sf.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),of.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new of(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Vd(Ud.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Vd(Ud.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Vd(Ud.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new of(t)}static emptyPath(){return new of([])}}class af{constructor(e){this.path=e}static fromPath(e){return new af(rf.fromString(e))}static fromName(e){return new af(rf.fromString(e).popFirst(5))}static empty(){return new af(rf.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===rf.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return rf.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new af(new rf(e.slice()))}}class lf{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function cf(e){return e.fields.find((e=>2===e.kind))}function uf(e){return e.fields.filter((e=>2!==e.kind))}lf.UNKNOWN_ID=-1;class hf{constructor(e,t){this.fieldPath=e,this.kind=t}}class df{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new df(0,mf.min())}}function ff(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=tf.fromTimestamp(1e9===r?new ef(n+1,0):new ef(n,r));return new mf(i,af.empty(),t)}function pf(e){return new mf(e.readTime,e.key,-1)}class mf{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new mf(tf.min(),af.empty(),-1)}static max(){return new mf(tf.max(),af.empty(),-1)}}function gf(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=af.comparator(e.documentKey,t.documentKey),0!==n?n:$d(e.largestBatchId,t.largestBatchId))}const yf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vf{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _f(e){if(e.code!==Ud.FAILED_PRECONDITION||e.message!==yf)throw e;Pd("LocalStore","Unexpectedly lost primary lease")}class wf{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ld(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new wf(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof wf?t:wf.resolve(t)}catch(e){return wf.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):wf.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):wf.reject(t)}static resolve(e){return new wf(((t,n)=>{t(e)}))}static reject(e){return new wf(((t,n)=>{n(e)}))}static waitFor(e){return new wf(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=wf.resolve(!1);for(const n of e)t=t.next((e=>e?wf.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new wf(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new wf(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class bf{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new jd,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Tf(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=Nf(t.target.error);this.V.reject(new Tf(e,n))}}static open(e,t,n,r){try{return new bf(t,e.transaction(r,n))}catch(e){throw new Tf(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Pd("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Cf(t)}}class If{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===If.S(Ge())&&Ad("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Pd("SimpleDb","Removing database:",e),kf(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!nt())return!1;if(If.C())return!0;const e=Ge(),t=If.S(e),n=0<t&&t<10,r=If.v(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(Pd("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Tf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Vd(Ud.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Vd(Ud.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Tf(e,r))},r.onupgradeneeded=e=>{Pd("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next((()=>{Pd("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}B(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.O(e);const t=bf.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),wf.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(Pd("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Ef{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return kf(this.k.delete())}}class Tf extends Vd{constructor(e,t){super(Ud.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function Sf(e){return"IndexedDbTransactionError"===e.name}class Cf{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Pd("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Pd("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),kf(n)}add(e){return Pd("SimpleDb","ADD",this.store.name,e,e),kf(this.store.add(e))}get(e){return kf(this.store.get(e)).next((t=>(void 0===t&&(t=null),Pd("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return Pd("SimpleDb","DELETE",this.store.name,e),kf(this.store.delete(e))}count(){return Pd("SimpleDb","COUNT",this.store.name),kf(this.store.count())}W(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new wf(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new wf(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){Pd("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new wf(((n,r)=>{t.onerror=e=>{const t=Nf(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new wf(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Ef(i),o=t(i.primaryKey,i.value,s);if(o instanceof wf){const e=o.catch((e=>(s.done(),wf.reject(e))));n.push(e)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>wf.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function kf(e){return new wf(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Nf(e.target.error);n(t)}}))}let xf=!1;function Nf(e){const t=If.S(Ge());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Vd("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return xf||(xf=!0,setTimeout((()=>{throw e}),0)),e}}return e}class Rf{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){Pd("IndexBackfiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{Pd("IndexBackfiller","Documents written: ".concat(await this.X.te()))}catch(e){Sf(e)?Pd("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await _f(e)}await this.ee(6e4)}))}}class Pf{constructor(e,t){this.localStore=e,this.persistence=t}async te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ne(t,e)))}ne(e,t){const n=new Set;let r=t,i=!0;return wf.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return Pd("IndexBackfiller","Processing collection: ".concat(t)),this.re(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}re(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.ie(r,n))).next((n=>(Pd("IndexBackfiller","Updating offset: ".concat(n)),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}ie(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=pf(t);gf(r,n)>0&&(n=r)})),new mf(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Af{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function Df(e){return null==e}function Of(e){return 0===e&&1/e==-1/0}function Lf(e){return"number"==typeof e&&Number.isInteger(e)&&!Of(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Mf(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Uf(t)),t=Ff(e.get(n),t);return Uf(t)}function Ff(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function Uf(e){return e+"\x01\x01"}function Vf(e){const t=e.length;if(Md(t>=2),2===t)return Md("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),rf.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&Ld(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:Ld()}s=t+2}return new rf(r)}Af._e=-1;const jf=["userId","batchId"];function qf(e,t){return[e,Mf(t)]}function Bf(e,t,n){return[e,Mf(t),n]}const zf={},Wf=["prefixPath","collectionGroup","readTime","documentId"],Kf=["prefixPath","collectionGroup","documentId"],Hf=["collectionGroup","readTime","prefixPath","documentId"],Gf=["canonicalId","targetId"],Qf=["targetId","path"],Yf=["path","targetId"],Jf=["collectionId","parent"],$f=["indexId","uid"],Xf=["uid","sequenceNumber"],Zf=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ep=["indexId","uid","orderedDocumentKey"],tp=["userId","collectionPath","documentId"],np=["userId","collectionPath","largestBatchId"],rp=["userId","collectionGroup","largestBatchId"],ip=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],sp=[...ip,"documentOverlays"],op=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ap=op,lp=[...ap,"indexConfiguration","indexState","indexEntries"],cp=lp;class up extends vf{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function hp(e,t){const n=Fd(e);return If.M(n.ae,t)}function dp(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function fp(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function pp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class mp{constructor(e,t){this.comparator=e,this.root=t||yp.EMPTY}insert(e,t){return new mp(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,yp.BLACK,null,null))}remove(e){return new mp(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yp.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gp(this.root,e,this.comparator,!1)}getReverseIterator(){return new gp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gp(this.root,e,this.comparator,!0)}}class gp{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yp{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:yp.RED,this.left=null!=r?r:yp.EMPTY,this.right=null!=i?i:yp.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new yp(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return yp.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return yp.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yp.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yp.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ld();if(this.right.isRed())throw Ld();const e=this.left.check();if(e!==this.right.check())throw Ld();return e+(this.isRed()?0:1)}}yp.EMPTY=null,yp.RED=!0,yp.BLACK=!1,yp.EMPTY=new class{constructor(){this.size=0}get key(){throw Ld()}get value(){throw Ld()}get color(){throw Ld()}get left(){throw Ld()}get right(){throw Ld()}copy(e,t,n,r,i){return this}insert(e,t,n){return new yp(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class vp{constructor(e){this.comparator=e,this.data=new mp(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _p(this.data.getIterator())}getIteratorFrom(e){return new _p(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof vp))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new vp(this.comparator);return t.data=e,t}}class _p{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function wp(e){return e.hasNext()?e.getNext():void 0}class bp{constructor(e){this.fields=e,e.sort(of.comparator)}static empty(){return new bp([])}unionWith(e){let t=new vp(of.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new bp(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xd(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ip extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ep{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ip("Invalid base64 string: "+e):e}}(e);return new Ep(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ep(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $d(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ep.EMPTY_BYTE_STRING=new Ep("");const Tp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sp(e){if(Md(!!e),"string"==typeof e){let t=0;const n=Tp.exec(e);if(Md(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Cp(e.seconds),nanos:Cp(e.nanos)}}function Cp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function kp(e){return"string"==typeof e?Ep.fromBase64String(e):Ep.fromUint8Array(e)}function xp(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Np(e){const t=e.mapValue.fields.__previous_value__;return xp(t)?Np(t):t}function Rp(e){const t=Sp(e.mapValue.fields.__local_write_time__.timestampValue);return new ef(t.seconds,t.nanos)}class Pp{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class Ap{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ap("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ap&&e.projectId===this.projectId&&e.database===this.database}}const Dp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Op={nullValue:"NULL_VALUE"};function Lp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xp(e)?4:Yp(e)?9007199254740991:10:Ld()}function Mp(e,t){if(e===t)return!0;const n=Lp(e);if(n!==Lp(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Rp(e).isEqual(Rp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Sp(e.timestampValue),r=Sp(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return kp(e.bytesValue).isEqual(kp(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Cp(e.geoPointValue.latitude)===Cp(t.geoPointValue.latitude)&&Cp(e.geoPointValue.longitude)===Cp(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Cp(e.integerValue)===Cp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Cp(e.doubleValue),r=Cp(t.doubleValue);return n===r?Of(n)===Of(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Xd(e.arrayValue.values||[],t.arrayValue.values||[],Mp);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(dp(n)!==dp(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Mp(n[i],r[i])))return!1;return!0}(e,t);default:return Ld()}}function Fp(e,t){return void 0!==(e.values||[]).find((e=>Mp(e,t)))}function Up(e,t){if(e===t)return 0;const n=Lp(e),r=Lp(t);if(n!==r)return $d(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $d(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Cp(e.integerValue||e.doubleValue),r=Cp(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Vp(e.timestampValue,t.timestampValue);case 4:return Vp(Rp(e),Rp(t));case 5:return $d(e.stringValue,t.stringValue);case 6:return function(e,t){const n=kp(e),r=kp(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=$d(n[i],r[i]);if(0!==e)return e}return $d(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=$d(Cp(e.latitude),Cp(t.latitude));return 0!==n?n:$d(Cp(e.longitude),Cp(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Up(n[i],r[i]);if(e)return e}return $d(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Dp.mapValue&&t===Dp.mapValue)return 0;if(e===Dp.mapValue)return 1;if(t===Dp.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=$d(r[o],s[o]);if(0!==e)return e;const t=Up(n[r[o]],i[s[o]]);if(0!==t)return t}return $d(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Ld()}}function Vp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return $d(e,t);const n=Sp(e),r=Sp(t),i=$d(n.seconds,r.seconds);return 0!==i?i:$d(n.nanos,r.nanos)}function jp(e){return qp(e)}function qp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Sp(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return kp(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return af.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=qp(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(qp(e.fields[i]));return n+"}"}(e.mapValue):Ld()}function Bp(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function zp(e){return!!e&&"integerValue"in e}function Wp(e){return!!e&&"arrayValue"in e}function Kp(e){return!!e&&"nullValue"in e}function Hp(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Gp(e){return!!e&&"mapValue"in e}function Qp(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return fp(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Qp(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Qp(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Yp(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Jp(e){return"nullValue"in e?Op:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Bp(Ap.empty(),af.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Ld()}function $p(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Bp(Ap.empty(),af.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?Dp:Ld()}function Xp(e,t){const n=Up(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Zp(e,t){const n=Up(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class em{constructor(e){this.value=e}static empty(){return new em({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Gp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qp(t)}setAll(e){let t=of.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Qp(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Gp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mp(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Gp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){fp(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new em(Qp(this.value))}}function tm(e){const t=[];return fp(e.fields,((e,n)=>{const r=new of([e]);if(Gp(n)){const e=tm(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new bp(t)}class nm{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new nm(e,0,tf.min(),tf.min(),tf.min(),em.empty(),0)}static newFoundDocument(e,t,n,r){return new nm(e,1,t,tf.min(),n,r,0)}static newNoDocument(e,t){return new nm(e,2,t,tf.min(),tf.min(),em.empty(),0)}static newUnknownDocument(e,t){return new nm(e,3,t,tf.min(),tf.min(),em.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tf.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=em.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=em.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tf.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof nm&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nm(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class rm{constructor(e,t){this.position=e,this.inclusive=t}}function im(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?af.comparator(af.fromName(o.referenceValue),n.key):Up(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function sm(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Mp(e.position[n],t.position[n]))return!1;return!0}class om{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function am(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class lm{}class cm extends lm{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new _m(e,t,n):"array-contains"===t?new Em(e,n):"in"===t?new Tm(e,n):"not-in"===t?new Sm(e,n):"array-contains-any"===t?new Cm(e,n):new cm(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new wm(e,n):new bm(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Up(t,this.value)):null!==t&&Lp(this.value)===Lp(t)&&this.matchesComparison(Up(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ld()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class um extends lm{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new um(e,t)}matches(e){return hm(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function hm(e){return"and"===e.op}function dm(e){return"or"===e.op}function fm(e){return pm(e)&&hm(e)}function pm(e){for(const t of e.filters)if(t instanceof um)return!1;return!0}function mm(e){if(e instanceof cm)return e.field.canonicalString()+e.op.toString()+jp(e.value);if(fm(e))return e.filters.map((e=>mm(e))).join(",");{const t=e.filters.map((e=>mm(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function gm(e,t){return e instanceof cm?function(e,t){return t instanceof cm&&e.op===t.op&&e.field.isEqual(t.field)&&Mp(e.value,t.value)}(e,t):e instanceof um?function(e,t){return t instanceof um&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&gm(n,t.filters[r])),!0)}(e,t):void Ld()}function ym(e,t){const n=e.filters.concat(t);return um.create(n,e.op)}function vm(e){return e instanceof cm?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(jp(e.value))}(e):e instanceof um?function(e){return e.op.toString()+" {"+e.getFilters().map(vm).join(" ,")+"}"}(e):"Filter"}class _m extends cm{constructor(e,t,n){super(e,t,n),this.key=af.fromName(n.referenceValue)}matches(e){const t=af.comparator(e.key,this.key);return this.matchesComparison(t)}}class wm extends cm{constructor(e,t){super(e,"in",t),this.keys=Im("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class bm extends cm{constructor(e,t){super(e,"not-in",t),this.keys=Im("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Im(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>af.fromName(e.referenceValue)))}class Em extends cm{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wp(t)&&Fp(t.arrayValue,this.value)}}class Tm extends cm{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Fp(this.value.arrayValue,t)}}class Sm extends cm{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Fp(this.value.arrayValue,t)}}class Cm extends cm{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Fp(this.value.arrayValue,e)))}}class km{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function xm(e){return new km(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Nm(e){const t=Fd(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>mm(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Df(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>jp(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>jp(e))).join(",")),t.ce=e}return t.ce}function Rm(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!am(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!gm(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!sm(e.startAt,t.startAt)&&sm(e.endAt,t.endAt)}function Pm(e){return af.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Am(e,t){return e.filters.filter((e=>e instanceof cm&&e.field.isEqual(t)))}function Dm(e,t,n){let r=Op,i=!0;for(const s of Am(e,t)){let e=Op,t=!0;switch(s.op){case"<":case"<=":e=Jp(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Op}Xp({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Xp({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Om(e,t,n){let r=Dp,i=!0;for(const s of Am(e,t)){let e=Dp,t=!0;switch(s.op){case">=":case">":e=$p(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Dp}Zp({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Zp({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Lm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Mm(e,t,n,r,i,s,o,a){return new Lm(e,t,n,r,i,s,o,a)}function Fm(e){return new Lm(e)}function Um(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Vm(e){return null!==e.collectionGroup}function jm(e){const t=Fd(e);if(null===t.le){t.le=[];const e=new Set;for(const i of t.explicitOrderBy)t.le.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new vp(of.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new om(r,n))})),e.has(of.keyField().canonicalString())||t.le.push(new om(of.keyField(),n))}return t.le}function qm(e){const t=Fd(e);return t.he||(t.he=Bm(t,jm(e))),t.he}function Bm(e,t){if("F"===e.limitType)return xm(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new om(e.field,t)}));const n=e.endAt?new rm(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new rm(e.startAt.position,e.startAt.inclusive):null;return xm(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function zm(e,t){const n=e.filters.concat([t]);return new Lm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Wm(e,t,n){return new Lm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Km(e,t){return Rm(qm(e),qm(t))&&e.limitType===t.limitType}function Hm(e){return"".concat(Nm(qm(e)),"|lt:").concat(e.limitType)}function Gm(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>vm(e))).join(", "),"]")),Df(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>jp(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>jp(e))).join(",")),"Target(".concat(t,")")}(qm(e)),"; limitType=").concat(e.limitType,")")}function Qm(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):af.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of jm(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=im(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,jm(e),t))&&!(e.endAt&&!function(e,t,n){const r=im(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,jm(e),t))}(e,t)}function Ym(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Jm(e){return(t,n)=>{let r=!1;for(const i of jm(e)){const e=$m(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function $m(e,t,n){const r=e.field.isKeyField()?af.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Up(r,i):Ld()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ld()}}class Xm{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){fp(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return pp(this.inner)}size(){return this.innerSize}}const Zm=new mp(af.comparator);function eg(){return Zm}const tg=new mp(af.comparator);function ng(){let e=tg;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function rg(e){let t=tg;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ig(){return og()}function sg(){return og()}function og(){return new Xm((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ag=new mp(af.comparator),lg=new vp(af.comparator);function cg(){let e=lg;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const ug=new vp($d);function hg(){return ug}function dg(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Of(t)?"-0":t}}function fg(e){return{integerValue:""+e}}function pg(e,t){return Lf(t)?fg(t):dg(e,t)}class mg{constructor(){this._=void 0}}function gg(e,t,n){return e instanceof _g?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&xp(t)&&(t=Np(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wg?bg(e,t):e instanceof Ig?Eg(e,t):function(e,t){const n=vg(e,t),r=Sg(n)+Sg(e.Ie);return zp(n)&&zp(e.Ie)?fg(r):dg(e.serializer,r)}(e,t)}function yg(e,t,n){return e instanceof wg?bg(e,t):e instanceof Ig?Eg(e,t):n}function vg(e,t){return e instanceof Tg?function(e){return zp(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class _g extends mg{}class wg extends mg{constructor(e){super(),this.elements=e}}function bg(e,t){const n=Cg(t);for(const r of e.elements)n.some((e=>Mp(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Ig extends mg{constructor(e){super(),this.elements=e}}function Eg(e,t){let n=Cg(t);for(const r of e.elements)n=n.filter((e=>!Mp(e,r)));return{arrayValue:{values:n}}}class Tg extends mg{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Sg(e){return Cp(e.integerValue||e.doubleValue)}function Cg(e){return Wp(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class kg{constructor(e,t){this.field=e,this.transform=t}}class xg{constructor(e,t){this.version=e,this.transformResults=t}}class Ng{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ng}static exists(e){return new Ng(void 0,e)}static updateTime(e){return new Ng(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rg(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Pg{}function Ag(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Bg(e.key,Ng.none()):new Fg(e.key,e.data,Ng.none());{const n=e.data,r=em.empty();let i=new vp(of.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ug(e.key,r,new bp(i.toArray()),Ng.none())}}function Dg(e,t,n){e instanceof Fg?function(e,t,n){const r=e.value.clone(),i=jg(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ug?function(e,t,n){if(!Rg(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=jg(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Vg(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Og(e,t,n,r){return e instanceof Fg?function(e,t,n,r){if(!Rg(e.precondition,t))return n;const i=e.value.clone(),s=qg(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ug?function(e,t,n,r){if(!Rg(e.precondition,t))return n;const i=qg(e.fieldTransforms,r,t),s=t.data;return s.setAll(Vg(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Rg(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Lg(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=vg(r.transform,e||null);null!=i&&(null===n&&(n=em.empty()),n.set(r.field,i))}return n||null}function Mg(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Xd(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wg&&t instanceof wg||e instanceof Ig&&t instanceof Ig?Xd(e.elements,t.elements,Mp):e instanceof Tg&&t instanceof Tg?Mp(e.Ie,t.Ie):e instanceof _g&&t instanceof _g}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Fg extends Pg{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ug extends Pg{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Vg(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function jg(e,t,n){const r=new Map;Md(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,yg(o,a,n[i]))}return r}function qg(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,gg(e,s,t))}return r}class Bg extends Pg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zg extends Pg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Wg{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Dg(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Og(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Og(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sg();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Ag(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(tf.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),cg())}isEqual(e){return this.batchId===e.batchId&&Xd(this.mutations,e.mutations,((e,t)=>Mg(e,t)))&&Xd(this.baseMutations,e.baseMutations,((e,t)=>Mg(e,t)))}}class Kg{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Md(e.mutations.length===n.length);let r=ag;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Kg(e,t,n,r)}}class Hg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Gg{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qg,Yg;function Jg(e){switch(e){default:return Ld();case Ud.CANCELLED:case Ud.UNKNOWN:case Ud.DEADLINE_EXCEEDED:case Ud.RESOURCE_EXHAUSTED:case Ud.INTERNAL:case Ud.UNAVAILABLE:case Ud.UNAUTHENTICATED:return!1;case Ud.INVALID_ARGUMENT:case Ud.NOT_FOUND:case Ud.ALREADY_EXISTS:case Ud.PERMISSION_DENIED:case Ud.FAILED_PRECONDITION:case Ud.ABORTED:case Ud.OUT_OF_RANGE:case Ud.UNIMPLEMENTED:case Ud.DATA_LOSS:return!0}}function $g(e){if(void 0===e)return Ad("GRPC error has no .code"),Ud.UNKNOWN;switch(e){case Qg.OK:return Ud.OK;case Qg.CANCELLED:return Ud.CANCELLED;case Qg.UNKNOWN:return Ud.UNKNOWN;case Qg.DEADLINE_EXCEEDED:return Ud.DEADLINE_EXCEEDED;case Qg.RESOURCE_EXHAUSTED:return Ud.RESOURCE_EXHAUSTED;case Qg.INTERNAL:return Ud.INTERNAL;case Qg.UNAVAILABLE:return Ud.UNAVAILABLE;case Qg.UNAUTHENTICATED:return Ud.UNAUTHENTICATED;case Qg.INVALID_ARGUMENT:return Ud.INVALID_ARGUMENT;case Qg.NOT_FOUND:return Ud.NOT_FOUND;case Qg.ALREADY_EXISTS:return Ud.ALREADY_EXISTS;case Qg.PERMISSION_DENIED:return Ud.PERMISSION_DENIED;case Qg.FAILED_PRECONDITION:return Ud.FAILED_PRECONDITION;case Qg.ABORTED:return Ud.ABORTED;case Qg.OUT_OF_RANGE:return Ud.OUT_OF_RANGE;case Qg.UNIMPLEMENTED:return Ud.UNIMPLEMENTED;case Qg.DATA_LOSS:return Ud.DATA_LOSS;default:return Ld()}}(Yg=Qg||(Qg={}))[Yg.OK=0]="OK",Yg[Yg.CANCELLED=1]="CANCELLED",Yg[Yg.UNKNOWN=2]="UNKNOWN",Yg[Yg.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yg[Yg.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yg[Yg.NOT_FOUND=5]="NOT_FOUND",Yg[Yg.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yg[Yg.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yg[Yg.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yg[Yg.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yg[Yg.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yg[Yg.ABORTED=10]="ABORTED",Yg[Yg.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yg[Yg.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yg[Yg.INTERNAL=13]="INTERNAL",Yg[Yg.UNAVAILABLE=14]="UNAVAILABLE",Yg[Yg.DATA_LOSS=15]="DATA_LOSS";let Xg=null;function Zg(){return new TextEncoder}const ey=new Sd([4294967295,4294967295],0);function ty(e){const t=Zg().encode(e),n=new Td;return n.update(t),new Uint8Array(n.digest())}function ny(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Sd([n,r],0),new Sd([i,s],0)]}class ry{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new iy("Invalid padding: ".concat(t));if(n<0)throw new iy("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new iy("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new iy("Invalid padding when bitmap length is 0: ".concat(t));this.Te=8*e.length-t,this.Ee=Sd.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(Sd.fromNumber(n)));return 1===r.compare(ey)&&(r=new Sd([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=ty(e),[n,r]=ny(t);for(let i=0;i<this.hashCount;i++){const e=this.de(n,r,i);if(!this.Ae(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ry(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Te)return;const t=ty(e),[n,r]=ny(t);for(let i=0;i<this.hashCount;i++){const e=this.de(n,r,i);this.Re(e)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class iy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sy{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,oy.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sy(tf.min(),r,new mp($d),eg(),cg())}}class oy{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new oy(n,t,cg(),cg(),cg())}}class ay{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class ly{constructor(e,t){this.targetId=e,this.fe=t}}class cy{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ep.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class uy{constructor(){this.ge=0,this.pe=fy(),this.ye=Ep.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=cg(),t=cg(),n=cg();return this.pe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ld()}})),new oy(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=fy()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Md(this.ge>=0)}Le(){this.Se=!0,this.we=!0}}class hy{constructor(e){this.Be=e,this.ke=new Map,this.qe=eg(),this.Qe=dy(),this.Ke=new mp($d)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:Ld()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach(((e,n)=>{this.je(n)&&t(n)}))}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const i=r.target;if(Pm(i))if(0===n){const e=new af(i.path);this.We(t,e,nm.newNoDocument(e,tf.min()))}else Md(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),i=n?this.et(n,e,r):1;if(0!==i){this.He(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Xg||Xg.tt(function(e,t,n,r,i){var s,o,a,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.fe,this.Be.nt(),n,i))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=kp(n).toUint8Array()}catch(e){if(e instanceof Ip)return Dd("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new ry(s,r,i)}catch(e){return Dd(e instanceof iy?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Te?null:o}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Be.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Be.nt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.We(t,n,null),r++)})),r}it(e){const t=new Map;this.ke.forEach(((n,r)=>{const i=this.Ye(r);if(i){if(n.current&&Pm(i.target)){const t=new af(i.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,nm.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}}));let n=cg();this.Qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.qe.forEach(((t,n)=>n.setReadTime(e)));const r=new sy(e,t,this.Ke,this.qe,n);return this.qe=eg(),this.Qe=dy(),this.Ke=new mp($d),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new uy,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new vp($d),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||Pd("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Be._t(e)}He(e){this.ke.set(e,new uy),this.Be.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function dy(){return new mp(af.comparator)}function fy(){return new mp(af.comparator)}const py={asc:"ASCENDING",desc:"DESCENDING"},my={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gy={and:"AND",or:"OR"};class yy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vy(e,t){return e.useProto3Json||Df(t)?t:{value:t}}function _y(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function wy(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function by(e,t){return _y(e,t.toTimestamp())}function Iy(e){return Md(!!e),tf.fromTimestamp(function(e){const t=Sp(e);return new ef(t.seconds,t.nanos)}(e))}function Ey(e,t){return Ty(e,t).canonicalString()}function Ty(e,t){const n=function(e){return new rf(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Sy(e){const t=rf.fromString(e);return Md(Gy(t)),t}function Cy(e,t){return Ey(e.databaseId,t.path)}function ky(e,t){const n=Sy(t);if(n.get(1)!==e.databaseId.projectId)throw new Vd(Ud.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Vd(Ud.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new af(Py(n))}function xy(e,t){return Ey(e.databaseId,t)}function Ny(e){const t=Sy(e);return 4===t.length?rf.emptyPath():Py(t)}function Ry(e){return new rf(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Py(e){return Md(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Ay(e,t,n){return{name:Cy(e,t),fields:n.value.mapValue.fields}}function Dy(e,t,n){const r=ky(e,t.name),i=Iy(t.updateTime),s=t.createTime?Iy(t.createTime):tf.min(),o=new em({mapValue:{fields:t.fields}}),a=nm.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Oy(e,t){let n;if(t instanceof Fg)n={update:Ay(e,t.key,t.value)};else if(t instanceof Bg)n={delete:Cy(e,t.key)};else if(t instanceof Ug)n={update:Ay(e,t.key,t.data),updateMask:Hy(t.fieldMask)};else{if(!(t instanceof zg))return Ld();n={verify:Cy(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof _g)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ig)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Tg)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw Ld()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:by(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ld()}(e,t.precondition)),n}function Ly(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ng.updateTime(Iy(e.updateTime)):void 0!==e.exists?Ng.exists(e.exists):Ng.none()}(t.currentDocument):Ng.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Md("REQUEST_TIME"===t.setToServerValue),n=new _g;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new wg(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Ig(e)}else"increment"in t?n=new Tg(e,t.increment):Ld();const r=of.fromServerFormat(t.fieldPath);return new kg(r,n)}(e,t))):[];if(t.update){t.update.name;const i=ky(e,t.update.name),s=new em({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new bp(t.map((e=>of.fromServerFormat(e))))}(t.updateMask);return new Ug(i,s,e,n,r)}return new Fg(i,s,n,r)}if(t.delete){const r=ky(e,t.delete);return new Bg(r,n)}if(t.verify){const r=ky(e,t.verify);return new zg(r,n)}return Ld()}function My(e,t){return{documents:[xy(e,t.path)]}}function Fy(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=xy(e,i);const s=function(e){if(0!==e.length)return Ky(um.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:zy(e.field),direction:jy(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=vy(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ut:n,parent:i}}function Uy(e){let t=Ny(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Md(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Vy(e);return t instanceof um&&fm(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new om(Wy(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Df(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new rm(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new rm(n,t)}(n.endAt)),Mm(t,i,o,s,a,"F",l,c)}function Vy(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Wy(e.unaryFilter.field);return cm.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Wy(e.unaryFilter.field);return cm.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Wy(e.unaryFilter.field);return cm.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Wy(e.unaryFilter.field);return cm.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ld()}}(e):void 0!==e.fieldFilter?function(e){return cm.create(Wy(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ld()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return um.create(e.compositeFilter.filters.map((e=>Vy(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ld()}}(e.compositeFilter.op))}(e):Ld()}function jy(e){return py[e]}function qy(e){return my[e]}function By(e){return gy[e]}function zy(e){return{fieldPath:e.canonicalString()}}function Wy(e){return of.fromServerFormat(e.fieldPath)}function Ky(e){return e instanceof cm?function(e){if("=="===e.op){if(Hp(e.value))return{unaryFilter:{field:zy(e.field),op:"IS_NAN"}};if(Kp(e.value))return{unaryFilter:{field:zy(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Hp(e.value))return{unaryFilter:{field:zy(e.field),op:"IS_NOT_NAN"}};if(Kp(e.value))return{unaryFilter:{field:zy(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zy(e.field),op:qy(e.op),value:e.value}}}(e):e instanceof um?function(e){const t=e.getFilters().map((e=>Ky(e)));return 1===t.length?t[0]:{compositeFilter:{op:By(e.op),filters:t}}}(e):Ld()}function Hy(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Gy(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Qy{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tf.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:tf.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ep.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Qy(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qy(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qy(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qy(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yy{constructor(e){this.ct=e}}function Jy(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:$y(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Cy(e,t.key),fields:t.data.value.mapValue.fields,updateTime:_y(e,t.version.toTimestamp()),createTime:_y(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Xy(t.version)};else{if(!t.isUnknownDocument())return Ld();r.unknownDocument={path:n.path.toArray(),version:Xy(t.version)}}return r}function $y(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Xy(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Zy(e){const t=new ef(e.seconds,e.nanoseconds);return tf.fromTimestamp(t)}function ev(e,t){const n=(t.baseMutations||[]).map((t=>Ly(e.ct,t)));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map((t=>Ly(e.ct,t))),i=ef.fromMillis(t.localWriteTimeMs);return new Wg(t.batchId,i,n,r)}function tv(e){const t=Zy(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Zy(e.lastLimboFreeSnapshotVersion):tf.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return Md(1===e.documents.length),qm(Fm(Ny(e.documents[0])))}(e.query):function(e){return qm(Uy(e))}(e.query),new Qy(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Ep.fromBase64String(e.resumeToken))}function nv(e,t){const n=Xy(t.snapshotVersion),r=Xy(t.lastLimboFreeSnapshotVersion);let i;i=Pm(t.target)?My(e.ct,t.target):Fy(e.ct,t.target).ut;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Nm(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function rv(e){const t=Uy({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Wm(t,t.limit,"L"):t}function iv(e,t){return new Hg(t.largestBatchId,Ly(e.ct,t.overlayMutation))}function sv(e,t){const n=t.path.lastSegment();return[e,Mf(t.path.popLast()),n]}function ov(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Xy(r.readTime),documentKey:Mf(r.documentKey.path),largestBatchId:r.largestBatchId}}class av{getBundleMetadata(e,t){return lv(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Zy(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return lv(e).put(function(e){return{bundleId:e.id,createTime:Xy(Iy(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return cv(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:rv(e.bundledQuery),readTime:Zy(e.readTime)}}(e)}))}saveNamedQuery(e,t){return cv(e).put(function(e){return{name:e.name,readTime:Xy(Iy(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function lv(e){return hp(e,"bundles")}function cv(e){return hp(e,"namedQueries")}class uv{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new uv(e,n)}getOverlay(e,t){return hv(e).get(sv(this.userId,t)).next((e=>e?iv(this.serializer,e):null))}getOverlays(e,t){const n=ig();return wf.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new Hg(t,i);r.push(this.ht(e,s))})),wf.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Mf(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(hv(e).H("collectionPathOverlayIndex",r))})),wf.waitFor(i)}getOverlaysForCollection(e,t,n){const r=ig(),i=Mf(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return hv(e).W("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=iv(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=ig();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return hv(e).Y({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=iv(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return hv(e).put(function(e,t,n){const[r,i,s]=sv(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Oy(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function hv(e){return hp(e,"documentOverlays")}class dv{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Cp(e.integerValue));else if("doubleValue"in e){const n=Cp(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),Of(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),"string"==typeof n&&(n=Sp(n)),t.At("".concat(n.seconds||"")),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(kp(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Yp(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Ld()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const r of Object.keys(n))this.Rt(r,t),this.It(n[r],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const r of n)this.It(r,t)}gt(e,t){this.Et(t,37),af.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function fv(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function pv(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=fv(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}dv.bt=new dv;class mv{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ct(e);else if(e<2048)this.Ct(960|e>>>6),this.Ct(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e);else{const e=t.codePointAt(0);this.Ct(240|e>>>18),this.Ct(128|63&e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e)}}this.vt()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Lt(e){const t=this.Bt(e),n=pv(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}qt(e){const t=this.Bt(e),n=pv(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class gv{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class yv{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class vv{constructor(){this.Gt=new mv,this.zt=new gv(this.Gt),this.jt=new yv(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class _v{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new _v(this.indexId,this.documentKey,this.arrayValue,n)}}function wv(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=bv(e.arrayValue,t.arrayValue),0!==n?n:(n=bv(e.directionalValue,t.directionalValue),0!==n?n:af.comparator(e.documentKey,t.documentKey)))}function bv(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Iv{constructor(e){this.Yt=new vp(((e,t)=>of.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Yt=this.Yt.add(e):this.Xt.push(e)}}get en(){return this.Yt.size>1}tn(e){if(Md(e.collectionGroup===this.collectionId),this.en)return!1;const t=cf(e);if(void 0!==t&&!this.nn(t))return!1;const n=uf(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.nn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Yt.size>0){const e=this.Yt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.rn(e,t)||!this.sn(this.Zt[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Zt.length||!this.sn(this.Zt[s++],e))return!1}return!0}on(){if(this.en)return null;let e=new vp(of.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new hf(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new hf(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new hf(n.field,"asc"===n.dir?0:1)));return new lf(lf.UNKNOWN_ID,this.collectionId,t,df.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Ev(e){var t,n;if(Md(e instanceof cm||e instanceof um),e instanceof cm){if(e instanceof Tm){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>cm.create(e.field,"==",t))))||[];return um.create(r,"or")}return e}const r=e.filters.map((e=>Ev(e)));return um.create(r,e.op)}function Tv(e){if(0===e.getFilters().length)return[];const t=xv(Ev(e));return Md(kv(t)),Sv(t)||Cv(t)?[t]:t.getFilters()}function Sv(e){return e instanceof cm}function Cv(e){return e instanceof um&&fm(e)}function kv(e){return Sv(e)||Cv(e)||function(e){if(e instanceof um&&dm(e)){for(const t of e.getFilters())if(!Sv(t)&&!Cv(t))return!1;return!0}return!1}(e)}function xv(e){if(Md(e instanceof cm||e instanceof um),e instanceof cm)return e;if(1===e.filters.length)return xv(e.filters[0]);const t=e.filters.map((e=>xv(e)));let n=um.create(t,e.op);return n=Pv(n),kv(n)?n:(Md(n instanceof um),Md(hm(n)),Md(n.filters.length>1),n.filters.reduce(((e,t)=>Nv(e,t))))}function Nv(e,t){let n;return Md(e instanceof cm||e instanceof um),Md(t instanceof cm||t instanceof um),n=e instanceof cm?t instanceof cm?function(e,t){return um.create([e,t],"and")}(e,t):Rv(e,t):t instanceof cm?Rv(t,e):function(e,t){if(Md(e.filters.length>0&&t.filters.length>0),hm(e)&&hm(t))return ym(e,t.getFilters());const n=dm(e)?e:t,r=dm(e)?t:e,i=n.filters.map((e=>Nv(e,r)));return um.create(i,"or")}(e,t),Pv(n)}function Rv(e,t){if(hm(t))return ym(t,e.getFilters());{const n=t.filters.map((t=>Nv(e,t)));return um.create(n,"or")}}function Pv(e){if(Md(e instanceof cm||e instanceof um),e instanceof cm)return e;const t=e.getFilters();if(1===t.length)return Pv(t[0]);if(pm(e))return e;const n=t.map((e=>Pv(e))),r=[];return n.forEach((t=>{t instanceof cm?r.push(t):t instanceof um&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:um.create(r,e.op)}class Av{constructor(){this._n=new Dv}addToCollectionParentIndex(e,t){return this._n.add(t),wf.resolve()}getCollectionParents(e,t){return wf.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return wf.resolve()}deleteFieldIndex(e,t){return wf.resolve()}deleteAllFieldIndexes(e){return wf.resolve()}createTargetIndexes(e,t){return wf.resolve()}getDocumentsMatchingTarget(e,t){return wf.resolve(null)}getIndexType(e,t){return wf.resolve(0)}getFieldIndexes(e,t){return wf.resolve([])}getNextCollectionGroupToUpdate(e){return wf.resolve(null)}getMinOffset(e,t){return wf.resolve(mf.min())}getMinOffsetFromCollectionGroup(e,t){return wf.resolve(mf.min())}updateCollectionGroup(e,t,n){return wf.resolve()}updateIndexEntries(e,t){return wf.resolve()}}class Dv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new vp(rf.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new vp(rf.comparator)).toArray()}}const Ov=new Uint8Array(0);class Lv{constructor(e,t){this.databaseId=t,this.an=new Dv,this.un=new Xm((e=>Nm(e)),((e,t)=>Rm(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.an.add(t)}));const i={collectionId:n,parent:Mf(r)};return Mv(e).put(i)}return wf.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Zd(t),""],!1,!0);return Mv(e).W(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Vf(r.parent))}return n}))}addFieldIndex(e,t){const n=Uv(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Vv(e);return i.next((e=>{n.put(ov(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=Uv(e),r=Vv(e),i=Fv(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Uv(e),n=Fv(e),r=Vv(e);return t.H().next((()=>n.H())).next((()=>r.H()))}createTargetIndexes(e,t){return wf.forEach(this.cn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Iv(t).on();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Fv(e);let r=!0;const i=new Map;return wf.forEach(this.cn(t),(t=>this.ln(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=cg();const r=[];return wf.forEach(i,((i,s)=>{Pd("IndexedDbIndexManager","Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map((e=>"".concat(e.fieldPath,":").concat(e.kind))).join(","))}(i)," to execute ").concat(Nm(t)));const o=function(e,t){const n=cf(t);if(void 0===n)return null;for(const r of Am(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of uf(t))for(const t of Am(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of uf(t)){const t=0===i.kind?Dm(e,i.fieldPath,e.startAt):Om(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new rm(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of uf(t)){const t=0===i.kind?Om(e,i.fieldPath,e.endAt):Dm(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new rm(n,r)}(s,i),u=this.hn(i,s,l),h=this.hn(i,s,c),d=this.Pn(i,s,a),f=this.In(i.indexId,o,u,l.inclusive,h,c.inclusive,d);return wf.forEach(f,(i=>n.j(i,t.limit).next((t=>{t.forEach((t=>{const n=af.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return wf.resolve(null)}))}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Tv(um.create(e.filters,"and")).map((t=>xm(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.un.set(e,t),t)}In(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.Tn(t[u/l]):Ov,h=this.En(e,a,n[u%l],r),d=this.dn(e,a,i[u%l],s),f=o.map((t=>this.En(e,a,t,!0)));c.push(...this.createRange(h,d,f))}return c}En(e,t,n,r){const i=new _v(e,af.empty(),t,n);return r?i:i.Jt()}dn(e,t,n,r){const i=new _v(e,af.empty(),t,n);return r?i.Jt():i}ln(e,t){const n=new Iv(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.cn(t);return wf.forEach(r,(t=>this.ln(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new vp(of.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}An(e,t){const n=new vv;for(const r of uf(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Ht(r.kind);dv.bt.Pt(e,i)}return n.Wt()}Tn(e){const t=new vv;return dv.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new vv;return dv.bt.Pt(Bp(this.databaseId,t),n.Ht(function(e){const t=uf(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let r=[];r.push(new vv);let i=0;for(const s of uf(e)){const e=n[i++];for(const n of r)if(this.Vn(t,s.fieldPath)&&Wp(e))r=this.mn(r,s,e);else{const t=n.Ht(s.kind);dv.bt.Pt(e,t)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new vv;n.seed(e.Wt()),dv.bt.Pt(s,n.Ht(t.kind)),i.push(n)}return i}Vn(e,t){return!!e.filters.find((e=>e instanceof cm&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Uv(e),r=Vv(e);return(t?n.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.W()).next((e=>{const t=[];return wf.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new df(t.sequenceNumber,new mf(Zy(t.readTime),new af(Vf(t.documentKey)),t.largestBatchId)):df.empty(),r=e.fields.map((e=>{let[t,n]=e;return new hf(of.fromServerFormat(t),n)}));return new lf(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:$d(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Uv(e),i=Vv(e);return this.gn(e).next((e=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>wf.forEach(t,(t=>i.put(ov(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return wf.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?wf.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),wf.forEach(i,(n=>this.pn(e,t,n).next((t=>{const i=this.yn(r,n);return t.isEqual(i)?wf.resolve():this.wn(e,r,n,t,i)})))))))}))}Sn(e,t,n,r){return Fv(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return Fv(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const r=Fv(e);let i=new vp(wv);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},((e,r)=>{i=i.add(new _v(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}yn(e,t){let n=new vp(wv);const r=this.An(t,e);if(null==r)return n;const i=cf(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Wp(s))for(const i of s.arrayValue.values||[])n=n.add(new _v(t.indexId,e.key,this.Tn(i),r))}else n=n.add(new _v(t.indexId,e.key,Ov,r));return n}wn(e,t,n,r,i){Pd("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=wp(s),l=wp(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=wp(o)):t?(i(a),a=wp(s)):(a=wp(s),l=wp(o))}}(r,i,wv,(r=>{s.push(this.Sn(e,t,n,r))}),(r=>{s.push(this.bn(e,t,n,r))})),wf.waitFor(s)}gn(e){let t=1;return Vv(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>wv(e,t))).filter(((e,t,n)=>!t||0!==wv(e,n[t-1])));const r=[];r.push(e);for(const s of n){const n=wv(s,e),i=wv(s,t);if(0===n)r[0]=e.Jt();else if(n>0&&i<0)r.push(s),r.push(s.Jt());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Dn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,Ov,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,Ov,[]];i.push(IDBKeyRange.bound(e,t))}return i}Dn(e,t){return wv(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(jv)}getMinOffset(e,t){return wf.mapArray(this.cn(t),(t=>this.ln(e,t).next((e=>e||Ld())))).next(jv)}}function Mv(e){return hp(e,"collectionParents")}function Fv(e){return hp(e,"indexEntries")}function Uv(e){return hp(e,"indexConfiguration")}function Vv(e){return hp(e,"indexState")}function jv(e){Md(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;gf(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new mf(t.readTime,t.documentKey,n)}const qv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bv{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Bv(e,Bv.DEFAULT_COLLECTION_PERCENTILE,Bv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function zv(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.Y({range:o},((e,t,n)=>(a++,n.delete())));s.push(l.next((()=>{Md(1===a)})));const c=[];for(const u of n.mutations){const e=Bf(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return wf.waitFor(s).next((()=>c))}function Wv(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Ld();t=e.noDocument}return JSON.stringify(t).length}Bv.DEFAULT_COLLECTION_PERCENTILE=10,Bv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bv.DEFAULT=new Bv(41943040,Bv.DEFAULT_COLLECTION_PERCENTILE,Bv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bv.DISABLED=new Bv(-1,0,0);class Kv{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){Md(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Kv(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gv(e).Y({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Qv(e),s=Gv(e);return s.add({}).next((o=>{Md("number"==typeof o);const a=new Wg(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>Oy(e.ct,t))),i=n.mutations.map((t=>Oy(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new vp(((e,t)=>$d(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Bf(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,zf))}return u.forEach((t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Cn[o]=a.keys()})),wf.waitFor(c).next((()=>a))}))}lookupMutationBatch(e,t){return Gv(e).get(t).next((e=>e?(Md(e.userId===this.userId),ev(this.serializer,e)):null))}vn(e,t){return this.Cn[t]?wf.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Cn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Gv(e).Y({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(Md(t.batchId>=n),i=ev(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Gv(e).Y({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gv(e).W("userMutationsIndex",t).next((e=>e.map((e=>ev(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=qf(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Qv(e).Y({range:r},((n,r,s)=>{const[o,a,l]=n,c=Vf(a);if(o===this.userId&&t.path.isEqual(c))return Gv(e).get(l).next((e=>{if(!e)throw Ld();Md(e.userId===this.userId),i.push(ev(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new vp($d);const r=[];return t.forEach((t=>{const i=qf(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Qv(e).Y({range:s},((e,r,i)=>{const[s,o,a]=e,l=Vf(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()}));r.push(o)})),wf.waitFor(r).next((()=>this.Fn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=qf(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new vp($d);return Qv(e).Y({range:s},((e,t,i)=>{const[s,a,l]=e,c=Vf(a);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(o=o.add(l)):i.done()})).next((()=>this.Fn(e,o)))}Fn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Gv(e).get(t).next((e=>{if(null===e)throw Ld();Md(e.userId===this.userId),n.push(ev(this.serializer,e))})))})),wf.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return zv(e.ae,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Mn(t.batchId)})),wf.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return wf.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Qv(e).Y({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Vf(e[1]);r.push(t)}else n.done()})).next((()=>{Md(0===r.length)}))}))}containsKey(e,t){return Hv(e,this.userId,t)}xn(e){return Yv(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function Hv(e,t,n){const r=qf(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Qv(e).Y({range:s,J:!0},((e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Gv(e){return hp(e,"mutations")}function Qv(e){return hp(e,"documentMutations")}function Yv(e){return hp(e,"mutationQueues")}class Jv{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Jv(0)}static Ln(){return new Jv(-1)}}class $v{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next((t=>{const n=new Jv(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Bn(e).next((e=>tf.fromTimestamp(new ef(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Bn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Bn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r))))}addTargetData(e,t){return this.qn(e,t).next((()=>this.Bn(e).next((n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Xv(e).delete(t.targetId))).next((()=>this.Bn(e))).next((t=>(Md(t.targetCount>0),t.targetCount-=1,this.kn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Xv(e).Y(((s,o)=>{const a=tv(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>wf.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Xv(e).Y(((e,n)=>{const r=tv(n);t(r)}))}Bn(e){return Zv(e).get("targetGlobalKey").next((e=>(Md(null!==e),e)))}kn(e,t){return Zv(e).put("targetGlobalKey",t)}qn(e,t){return Xv(e).put(nv(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Nm(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Xv(e).Y({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=tv(n);Rm(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=e_(e);return t.forEach((t=>{const s=Mf(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),wf.waitFor(r)}removeMatchingKeys(e,t,n){const r=e_(e);return wf.forEach(t,(t=>{const i=Mf(t.path);return wf.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=e_(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=e_(e);let i=cg();return r.Y({range:n,J:!0},((e,t,n)=>{const r=Vf(e[1]),s=new af(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=Mf(t.path),r=IDBKeyRange.bound([n],[Zd(n)],!1,!0);let i=0;return e_(e).Y({index:"documentTargetsIndex",J:!0,range:r},((e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}_t(e,t){return Xv(e).get(t).next((e=>e?tv(e):null))}}function Xv(e){return hp(e,"targets")}function Zv(e){return hp(e,"targetGlobal")}function e_(e){return hp(e,"targetDocuments")}function t_(e,t){let[n,r]=e,[i,s]=t;const o=$d(n,i);return 0===o?$d(r,s):o}class n_{constructor(e){this.Kn=e,this.buffer=new vp(t_),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();t_(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class r_{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){Pd("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Sf(e)?Pd("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await _f(e)}await this.zn(3e5)}))}}class i_{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return wf.resolve(Af._e);const n=new n_(t);return this.jn.forEachTarget(e,(e=>n.Wn(e.sequenceNumber))).next((()=>this.jn.Jn(e,(e=>n.Wn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Pd("LruGarbageCollector","Garbage collection skipped; disabled"),wf.resolve(qv)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Pd("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),qv):this.Yn(e,t)))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(Pd("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),Rd()<=Dt.DEBUG&&Pd("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(a-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-a)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),wf.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function s_(e,t){return new i_(e,t)}class o_{constructor(e,t){this.db=e,this.garbageCollector=s_(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,((e,n)=>t(n)))}addReference(e,t,n){return a_(e,n)}removeReference(e,t,n){return a_(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return a_(e,t)}er(e,t){return function(e,t){let n=!1;return Yv(e).Z((r=>Hv(e,r,t).next((e=>(e&&(n=!0),wf.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Xn(e,((s,o)=>{if(o<=t){const t=this.er(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,tf.min()),e_(e).delete(function(e){return[0,Mf(e.path)]}(s)))))}));r.push(t)}})).next((()=>wf.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return a_(e,t)}Xn(e,t){const n=e_(e);let r,i=Af._e;return n.Y({index:"documentTargetsIndex"},((e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==Af._e&&t(new af(Vf(r)),i),i=l,r=a):i=Af._e})).next((()=>{i!==Af._e&&t(new af(Vf(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function a_(e,t){return e_(e).put(function(e,t){return{targetId:0,path:Mf(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class l_{constructor(){this.changes=new Xm((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nm.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?wf.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class c_{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return f_(e).put(n)}removeEntry(e,t,n){return f_(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],$y(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.tr(e,n))))}getEntry(e,t){let n=nm.newInvalidDocument(t);return f_(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(p_(t))},((e,r)=>{n=this.nr(t,r)})).next((()=>n))}rr(e,t){let n={size:0,document:nm.newInvalidDocument(t)};return f_(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(p_(t))},((e,r)=>{n={document:this.nr(t,r),size:Wv(r)}})).next((()=>n))}getEntries(e,t){let n=eg();return this.ir(e,t,((e,t)=>{const r=this.nr(e,t);n=n.insert(e,r)})).next((()=>n))}sr(e,t){let n=eg(),r=new mp(af.comparator);return this.ir(e,t,((e,t)=>{const i=this.nr(e,t);n=n.insert(e,i),r=r.insert(e,Wv(t))})).next((()=>({documents:n,_r:r})))}ir(e,t,n){if(t.isEmpty())return wf.resolve();let r=new vp(g_);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(p_(r.first()),p_(r.last())),s=r.getIterator();let o=s.getNext();return f_(e).Y({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=af.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&g_(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.U(p_(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),$y(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return f_(e).W(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=eg();for(const i of e){const e=this.nr(af.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Qm(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=eg();const s=m_(t,n),o=m_(t,mf.max());return f_(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.nr(af.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new h_(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return d_(e).get("remoteDocumentGlobalKey").next((e=>(Md(!!e),e)))}tr(e,t){return d_(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Dy(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=af.fromSegments(t.noDocument.path),r=Zy(t.noDocument.readTime);n=nm.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Ld();{const e=af.fromSegments(t.unknownDocument.path),r=Zy(t.unknownDocument.version);n=nm.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new ef(e[0],e[1]);return tf.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(tf.min()))return e}return nm.newInvalidDocument(e)}}function u_(e){return new c_(e)}class h_ extends l_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Xm((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new vp(((e,t)=>$d(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.ur.get(i);if(t.push(this.ar.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Jy(this.ar.serializer,s);r=r.add(i.path.popLast());const l=Wv(a);n+=l-o.size,t.push(this.ar.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Jy(this.ar.serializer,s.convertToNoDocument(tf.min()));t.push(this.ar.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.ar.updateMetadata(e,n)),wf.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next((e=>(this.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.ar.sr(e,t).next((e=>{let{documents:t,_r:n}=e;return n.forEach(((e,n)=>{this.ur.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function d_(e){return hp(e,"remoteDocumentGlobal")}function f_(e){return hp(e,"remoteDocumentsV14")}function p_(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function m_(e,t){const n=t.documentKey.path.toArray();return[e,$y(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function g_(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=$d(n[s],r[s]),i)return i;return i=$d(n.length,r.length),i||(i=$d(n[n.length-2],r[r.length-2]),i||$d(n[n.length-1],r[r.length-1]))}class y_{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class v_{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Og(n.mutation,e,bp.empty(),ef.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,cg()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cg();const r=ig();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ng();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=ig();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,cg())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=eg();const s=og(),o=og();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ug)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Og(o.mutation,t,o.mutation.getFieldMask(),ef.now())):s.set(t.key,bp.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new y_(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=og();let r=new mp(((e,t)=>e-t)),i=cg();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||bp.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||cg()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=sg();l.forEach((e=>{if(!i.has(e)){const r=Ag(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return wf.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return af.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):wf.resolve(ig());let o=-1,a=i;return s.next((t=>wf.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?wf.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,cg()))).next((e=>({batchId:o,changes:rg(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new af(t)).next((e=>{let t=ng();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=ng();return this.indexManager.getCollectionParents(e,i).next((o=>wf.forEach(o,(o=>{const a=function(e,t){return new Lm(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,nm.newInvalidDocument(r)))}));let n=ng();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&Og(s.mutation,r,bp.empty(),ef.now()),Qm(t,r)&&(n=n.insert(e,r))})),n}))}}class __{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return wf.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Iy(e.createTime)}}(t)),wf.resolve()}getNamedQuery(e,t){return wf.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:rv(e.bundledQuery),readTime:Iy(e.readTime)}}(t)),wf.resolve()}}class w_{constructor(){this.overlays=new mp(af.comparator),this.hr=new Map}getOverlay(e,t){return wf.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ig();return wf.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),wf.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),wf.resolve()}getOverlaysForCollection(e,t,n){const r=ig(),i=t.length+1,s=new af(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return wf.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new mp(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ig(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=ig(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return wf.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Hg(t,n));let i=this.hr.get(t);void 0===i&&(i=cg(),this.hr.set(t,i)),this.hr.set(t,i.add(n.key))}}class b_{constructor(){this.Pr=new vp(I_.Ir),this.Tr=new vp(I_.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new I_(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new I_(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new af(new rf([])),n=new I_(t,e),r=new I_(t,e+1),i=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),i.push(e.key)})),i}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new af(new rf([])),n=new I_(t,e),r=new I_(t,e+1);let i=cg();return this.Tr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new I_(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class I_{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return af.comparator(e.key,t.key)||$d(e.pr,t.pr)}static Er(e,t){return $d(e.pr,t.pr)||af.comparator(e.key,t.key)}}class E_{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new vp(I_.Ir)}checkEmpty(e){return wf.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Wg(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.wr=this.wr.add(new I_(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return wf.resolve(s)}lookupMutationBatch(e,t){return wf.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),i=r<0?0:r;return wf.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return wf.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return wf.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new I_(t,0),r=new I_(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);i.push(t)})),wf.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new vp($d);return t.forEach((e=>{const t=new I_(e,0),r=new I_(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),wf.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;af.isDocumentKey(i)||(i=i.child(""));const s=new I_(new af(i),0);let o=new vp($d);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)}),s),wf.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Md(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return wf.forEach(t.mutations,(r=>{const i=new I_(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new I_(t,0),r=this.wr.firstAfterOrEqual(n);return wf.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,wf.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class T_{constructor(e){this.vr=e,this.docs=new mp(af.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return wf.resolve(n?n.document.mutableCopy():nm.newInvalidDocument(t))}getEntries(e,t){let n=eg();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():nm.newInvalidDocument(e))})),wf.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=eg();const s=t.path,o=new af(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||gf(pf(o),n)<=0||(r.has(o.key)||Qm(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return wf.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ld()}Fr(e,t){return wf.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new S_(this)}getSize(e){return wf.resolve(this.size)}}class S_ extends l_{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),wf.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class C_{constructor(e){this.persistence=e,this.Mr=new Xm((e=>Nm(e)),Rm),this.lastRemoteSnapshotVersion=tf.min(),this.highestTargetId=0,this.Or=0,this.Nr=new b_,this.targetCount=0,this.Lr=Jv.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),wf.resolve()}getLastRemoteSnapshotVersion(e){return wf.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return wf.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),wf.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),wf.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Jv(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,wf.resolve()}updateTargetData(e,t){return this.qn(t),wf.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,wf.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),wf.waitFor(i).next((()=>r))}getTargetCount(e){return wf.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return wf.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),wf.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),wf.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),wf.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return wf.resolve(n)}containsKey(e,t){return wf.resolve(this.Nr.containsKey(t))}}class k_{constructor(e,t){this.Br={},this.overlays={},this.kr=new Af(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new C_(this),this.indexManager=new Av,this.remoteDocumentCache=function(e){return new T_(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Yy(t),this.$r=new __(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new w_,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new E_(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){Pd("MemoryPersistence","Starting transaction:",e);const r=new x_(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return wf.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class x_ extends vf{constructor(e){super(),this.currentSequenceNumber=e}}class N_{constructor(e){this.persistence=e,this.zr=new b_,this.jr=null}static Hr(e){return new N_(e)}get Jr(){if(this.jr)return this.jr;throw Ld()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),wf.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),wf.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),wf.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wf.forEach(this.Jr,(n=>{const r=af.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,tf.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return wf.or([()=>wf.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class R_{constructor(e){this.serializer=e}N(e,t,n,r){const i=new bf("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jf,{unique:!0}),e.createObjectStore("documentMutations")}(e),P_(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=wf.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),P_(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:tf.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").W().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jf,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return wf.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Xr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ei(i))))),n<7&&r>=7&&(s=s.next((()=>this.ti(i)))),n<8&&r>=8&&(s=s.next((()=>this.ni(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ri(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:tp});t.createIndex("collectionPathOverlayIndex",np,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",rp,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Wf});t.createIndex("documentKeyIndex",Kf),t.createIndex("collectionGroupIndex",Hf)}(e))).next((()=>this.ii(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.si(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:$f}).createIndex("sequenceNumberIndex",Xf,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Zf}).createIndex("documentKeyIndex",ep,{unique:!1})}(e)))),n<16&&r>=16&&(s=s.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),s}ei(e){let t=0;return e.store("remoteDocuments").Y(((e,n)=>{t+=Wv(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.W().next((t=>wf.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",r).next((n=>wf.forEach(n,(n=>{Md(n.userId===t.userId);const r=ev(this.serializer,n);return zv(e,t.userId,r).next((()=>{}))}))))}))))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Y(((n,i)=>{const s=new rf(n),o=function(e){return[0,Mf(e)]}(s);r.push(t.get(o).next((n=>n?wf.resolve():(n=>t.put({targetId:0,path:Mf(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>wf.waitFor(r)))}))}ni(e,t){e.createObjectStore("collectionParents",{keyPath:Jf});const n=t.store("collectionParents"),r=new Dv,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Mf(r)})}};return t.store("remoteDocuments").Y({J:!0},((e,t)=>{const n=new rf(e);return i(n.popLast())})).next((()=>t.store("documentMutations").Y({J:!0},((e,t)=>{let[n,r,s]=e;const o=Vf(r);return i(o.popLast())}))))}ri(e){const t=e.store("targets");return t.Y(((e,n)=>{const r=tv(n),i=nv(this.serializer,r);return t.put(i)}))}ii(e,t){const n=t.store("remoteDocuments"),r=[];return n.Y(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new af(rf.fromString(e.document.name).popFirst(5)):e.noDocument?af.fromSegments(e.noDocument.path):e.unknownDocument?af.fromSegments(e.unknownDocument.path):Ld()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>wf.waitFor(r)))}si(e,t){const n=t.store("mutations"),r=u_(this.serializer),i=new k_(N_.Hr,this.serializer.ct);return n.W().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:cg();ev(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),wf.forEach(n,((e,n)=>{const s=new kd(n),o=uv.lt(this.serializer,s),a=i.getIndexManager(s),l=Kv.lt(s,this.serializer,a,i.referenceDelegate);return new v_(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new up(t,Af._e),e).next()}))}))}}function P_(e){e.createObjectStore("targetDocuments",{keyPath:Qf}).createIndex("documentTargetsIndex",Yf,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Gf,{unique:!0}),e.createObjectStore("targetGlobal")}const A_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class D_{constructor(e,t,n,r,i,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:16;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=i,this.window=s,this.document=o,this._i=l,this.ai=c,this.ui=u,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=e=>Promise.resolve(),!D_.D())throw new Vd(Ud.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new o_(this,r),this.Ti=t+"main",this.serializer=new Yy(a),this.Ei=new If(this.Ti,this.ui,new R_(this.serializer)),this.Qr=new $v(this.referenceDelegate,this.serializer),this.remoteDocumentCache=u_(this.serializer),this.$r=new av,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===c&&Ad("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Vd(Ud.FAILED_PRECONDITION,A_);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Qr.getHighestSequenceNumber(e)))})).then((e=>{this.kr=new Af(e,this._i)})).then((()=>{this.qr=!0})).catch((e=>(this.Ei&&this.Ei.close(),Promise.reject(e))))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget((async()=>{this.started&&await this.Ai()})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>L_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.gi(e).next((e=>{e||(this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))))}))})).next((()=>this.pi(e))).next((t=>this.isPrimary&&!t?this.yi(e).next((()=>!1)):!!t&&this.wi(e).next((()=>!0)))))).catch((e=>{if(Sf(e))return Pd("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Pd("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.oi.enqueueRetryable((()=>this.Ii(e))),this.isPrimary=e}))}gi(e){return O_(e).get("owner").next((e=>wf.resolve(this.Si(e))))}bi(e){return L_(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=hp(e,"clientMetadata");return t.W().next((e=>{const n=this.vi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return wf.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ai().then((()=>this.Di())).then((()=>this.mi()))))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?wf.resolve(!0):O_(e).get("owner").next((t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new Vd(Ud.FAILED_PRECONDITION,A_);return!1}}return!(!this.networkEnabled||!this.inForeground)||L_(e).W().next((e=>void 0===this.vi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&Pd("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e)))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new up(e,Af._e);return this.yi(t).next((()=>this.bi(t)))})),this.Ei.close(),this.Li()}vi(e,t){return e.filter((e=>this.Ci(e.updateTimeMs,t)&&!this.Mi(e.clientId)))}Bi(){return this.runTransaction("getActiveClients","readonly",(e=>L_(e).W().next((e=>this.vi(e,18e5).map((e=>e.clientId))))))}get started(){return this.qr}getMutationQueue(e,t){return Kv.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Lv(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return uv.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){Pd("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 16===e?cp:15===e?lp:14===e?ap:13===e?op:12===e?sp:11===e?ip:void Ld()}(this.ui);let s;return this.Ei.runTransaction(e,r,i,(r=>(s=new up(r,this.kr?this.kr.next():Af._e),"readwrite-primary"===t?this.gi(s).next((e=>!!e||this.pi(s))).next((t=>{if(!t)throw Ad("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))),new Vd(Ud.FAILED_PRECONDITION,yf);return n(s)})).next((e=>this.wi(s).next((()=>e)))):this.ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}ki(e){return O_(e).get("owner").next((e=>{if(null!==e&&this.Ci(e.leaseTimestampMs,5e3)&&!this.Mi(e.ownerId)&&!this.Si(e)&&!(this.ai||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Vd(Ud.FAILED_PRECONDITION,A_)}))}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return O_(e).put("owner",t)}static D(){return If.D()}yi(e){const t=O_(e);return t.get("owner").next((e=>this.Si(e)?(Pd("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):wf.resolve()))}Ci(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Ad("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=()=>{this.oi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai())))},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;tt()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return Pd("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Ad("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ad("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}Fi(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function O_(e){return hp(e,"owner")}function L_(e){return hp(e,"clientMetadata")}function M_(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class F_{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=cg(),r=cg();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new F_(e,t.fromCache,n,r)}}class U_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class V_{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=tt()?8:If.v(Ge())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ji(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Hi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new U_;return this.Ji(e,t,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>i.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(Rd()<=Dt.DEBUG&&Pd("QueryEngine","SDK will not create cache indexes for query:",Gm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),wf.resolve()):(Rd()<=Dt.DEBUG&&Pd("QueryEngine","Query:",Gm(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(Rd()<=Dt.DEBUG&&Pd("QueryEngine","The SDK decides to create cache indexes for query:",Gm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qm(t))):wf.resolve())}ji(e,t){if(Um(t))return wf.resolve(null);let n=qm(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Wm(t,null,"F"),n=qm(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=cg(...r);return this.zi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Zi(t,r);return this.Xi(t,s,i,n.readTime)?this.ji(e,Wm(t,null,"F")):this.es(e,s,t,n)}))))})))))}Hi(e,t,n,r){return Um(t)||r.isEqual(tf.min())?wf.resolve(null):this.zi.getDocuments(e,n).next((i=>{const s=this.Zi(t,i);return this.Xi(t,s,n,r)?wf.resolve(null):(Rd()<=Dt.DEBUG&&Pd("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gm(t)),this.es(e,s,t,ff(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new vp(Jm(e));return t.forEach(((t,r)=>{Qm(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(e,t,n){return Rd()<=Dt.DEBUG&&Pd("QueryEngine","Using full collection scan to execute query:",Gm(t)),this.zi.getDocumentsMatchingQuery(e,t,mf.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class j_{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new mp($d),this.rs=new Xm((e=>Nm(e)),Rm),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}function q_(e,t,n,r){return new j_(e,t,n,r)}async function B_(e,t){const n=Fd(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=cg();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function z_(e){const t=Fd(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function W_(e,t,n){let r=cg(),i=cg();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=eg();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(tf.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Pd("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:r,ls:i}}))}function K_(e,t){const n=Fd(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function H_(e,t){const n=Fd(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((i=>i?(r=i,wf.resolve(r)):n.Qr.allocateTargetId(e).next((i=>(r=new Qy(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}async function G_(e,t,n){const r=Fd(e),i=r.ns.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Sf(e))throw e;Pd("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.ns=r.ns.remove(t),r.rs.delete(i.target)}function Q_(e,t,n){const r=Fd(e);let i=tf.min(),s=cg();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Fd(e),i=r.rs.get(n);return void 0!==i?wf.resolve(r.ns.get(i)):r.Qr.getTargetData(t,n)}(r,e,qm(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?i:tf.min(),n?s:cg()))).next((e=>($_(r,Ym(t),e),{documents:e,hs:s})))))}function Y_(e,t){const n=Fd(e),r=Fd(n.Qr),i=n.ns.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r._t(e,t).next((e=>e?e.target:null))))}function J_(e,t){const n=Fd(e),r=n.ss.get(t)||tf.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.os.getAllFromCollectionGroup(e,t,ff(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>($_(n,t,e),e)))}function $_(e,t,n){let r=e.ss.get(t)||tf.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}async function X_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cg();const r=await H_(e,qm(rv(t.bundledQuery))),i=Fd(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=Iy(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.$r.saveNamedQuery(e,t);const o=r.withResumeToken(Ep.EMPTY_BYTE_STRING,s);return i.ns=i.ns.insert(o.targetId,o),i.Qr.updateTargetData(e,o).next((()=>i.Qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.$r.saveNamedQuery(e,t)))}))}function Z_(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function ew(e,t,n){let r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function tw(e,t){return"firestore_targets_".concat(e,"_").concat(t)}class nw{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Vd(r.error.code,r.error.message))),s?new nw(e,t,r.state,i):(Ad("SharedClientState","Failed to parse mutation state for ID '".concat(t,"': ").concat(n)),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rw{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new Vd(n.error.code,n.error.message))),i?new rw(e,n.state,r):(Ad("SharedClientState","Failed to parse target state for ID '".concat(e,"': ").concat(t)),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class iw{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=hg();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Lf(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new iw(e,i):(Ad("SharedClientState","Failed to parse client data for instance '".concat(e,"': ").concat(t)),null)}}class sw{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new sw(t.clientId,t.onlineState):(Ad("SharedClientState","Failed to parse online state: ".concat(e)),null)}}class ow{constructor(){this.activeTargetIds=hg()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aw{constructor(e,t,n,r,i){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new mp($d),this.started=!1,this.ys=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ws=Z_(this.persistenceKey,this.Vs),this.Ss=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new ow),this.bs=new RegExp("^firestore_clients_".concat(s,"_([^_]*)$")),this.Ds=new RegExp("^firestore_mutations_".concat(s,"_(\\d+)(?:_(.*))?$")),this.Cs=new RegExp("^firestore_targets_".concat(s,"_(\\d+)$")),this.vs=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Fs=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const n of e){if(n===this.Vs)continue;const e=this.getItem(Z_(this.persistenceKey,n));if(e){const t=iw.Es(n,e);t&&(this.ps=this.ps.insert(t.clientId,t))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const e=this.xs(t);e&&this.Os(e)}for(const n of this.ys)this.gs(n);this.ys=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(tw(this.persistenceKey,e));if(n){const r=rw.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(tw(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Bs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Pd("SharedClientState","READ",e,t),t}setItem(e,t){Pd("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Pd("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(Pd("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void Ad("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.bs.test(t.key)){if(null==t.newValue){const e=this.$s(t.key);return this.Us(e,null)}{const e=this.Ws(t.key,t.newValue);if(e)return this.Us(e.clientId,e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.Gs(t.key,t.newValue);if(e)return this.zs(e)}}else if(this.Cs.test(t.key)){if(null!==t.newValue){const e=this.js(t.key,t.newValue);if(e)return this.Hs(e)}}else if(t.key===this.vs){if(null!==t.newValue){const e=this.xs(t.newValue);if(e)return this.Os(e)}}else if(t.key===this.Ss){const e=function(e){let t=Af._e;if(null!=e)try{const n=JSON.parse(e);Md("number"==typeof n),t=n}catch(e){Ad("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Af._e&&this.sequenceNumberHandler(e)}else if(t.key===this.Fs){const e=this.Js(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Ys(e))))}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){const r=new nw(this.currentUser,e,t,n),i=ew(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ds())}Bs(e){const t=ew(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){const r=tw(this.persistenceKey,e),i=new rw(e,t,n);this.setItem(r,i.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return iw.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return nw.Es(new kd(i),r,t)}js(e,t){const n=this.Cs.exec(e),r=Number(n[1]);return rw.Es(r,t)}xs(e){return sw.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);Pd("SharedClientState","Ignoring mutation for non-active user ".concat(e.user.uid))}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),i=this.Ns(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.eo(s,o).then((()=>{this.ps=n}))}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=hg();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class lw{constructor(){this.no=new ow,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new ow,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cw{io(e){}shutdown(){}}class uw{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Pd("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Pd("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let hw=null;function dw(){return null===hw?hw=268435456+Math.round(2147483648*Math.random()):hw++,"0x"+hw.toString(16)}const fw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pw{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const mw="WebChannelConnection";class gw extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po="projects/".concat(n,"/databases/").concat(r),this.yo="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get wo(){return!1}So(e,t,n,r,i){const s=dw(),o=this.bo(e,t.toUriEncodedString());Pd("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(e,o,a,n).then((t=>(Pd("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t)),(t=>{throw Dd("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t}))}vo(e,t,n,r,i,s){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+xd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=fw[e];return"".concat(this.fo,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const i=dw();return new Promise(((s,o)=>{const a=new Ed;a.setWithCredentials(!0),a.listenOnce(_d.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case vd.NO_ERROR:const t=a.getResponseJson();Pd(mw,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case vd.TIMEOUT:Pd(mw,"RPC '".concat(e,"' ").concat(i," timed out")),o(new Vd(Ud.DEADLINE_EXCEEDED,"Request time out"));break;case vd.HTTP_ERROR:const n=a.getStatus();if(Pd(mw,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ud).indexOf(t)>=0?t:Ud.UNKNOWN}(t.status);o(new Vd(e,t.message))}else o(new Vd(Ud.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Vd(Ud.UNAVAILABLE,"Connection failed."));break;default:Ld()}}finally{Pd(mw,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(r);Pd(mw,"RPC '".concat(e,"' ").concat(i," sending request:"),r),a.send(t,"POST",l,n,15)}))}Fo(e,t,n){const r=dw(),i=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=gd(),o=yd(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Pd(mw,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new pw({lo:t=>{d?Pd(mw,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Pd(mw,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),Pd(mw,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},ho:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,Id.EventType.OPEN,(()=>{d||Pd(mw,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(u,Id.EventType.CLOSE,(()=>{d||(d=!0,Pd(mw,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.Vo())})),p(u,Id.EventType.ERROR,(t=>{d||(d=!0,Dd(mw,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.Vo(new Vd(Ud.UNAVAILABLE,"The operation could not be completed")))})),p(u,Id.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];Md(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Pd(mw,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=Qg[e];if(void 0!==t)return $g(t)}(t),i=o.message;void 0===n&&(n=Ud.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.Vo(new Vd(n,i)),u.close()}else Pd(mw,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.mo(i)}})),p(o,wd.STAT_EVENT,(t=>{t.stat===bd.PROXY?Pd(mw,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===bd.NOPROXY&&Pd(mw,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{f.Ro()}),0),f}}function yw(){return"undefined"!=typeof window?window:null}function vw(){return"undefined"!=typeof document?document:null}function _w(e){return new yy(e,!0)}class ww{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-n);r>0&&Pd("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.No," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class bw{constructor(e,t,n,r,i,s,o,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new ww(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===Ud.RESOURCE_EXHAUSTED?(Ad(t.toString()),Ad("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===Ud.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Wo===t&&this.o_(n,r)}),(t=>{e((()=>{const e=new Vd(Ud.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return Pd("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(Pd("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Iw extends bw{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ld()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Md(void 0===t||"string"==typeof t),Ep.fromBase64String(t||"")):(Md(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Ep.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ud.UNKNOWN:$g(e.code);return new Vd(t,e.message||"")}(o);n=new cy(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=ky(e,r.document.name),s=Iy(r.document.updateTime),o=r.document.createTime?Iy(r.document.createTime):tf.min(),a=new em({mapValue:{fields:r.document.fields}}),l=nm.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new ay(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=ky(e,r.document),s=r.readTime?Iy(r.readTime):tf.min(),o=nm.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ay([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=ky(e,r.document),s=r.removedTargetIds||[];n=new ay([],s,i,null)}else{if(!("filter"in t))return Ld();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Gg(r,i),o=e.targetId;n=new ly(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return tf.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?tf.min():t.readTime?Iy(t.readTime):tf.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=Ry(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Pm(r)?{documents:My(e,r)}:{query:Fy(e,r).ut},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=wy(e,t.resumeToken);const r=vy(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(tf.min())>0){n.readTime=_y(e,t.snapshotVersion.toTimestamp());const r=vy(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ld()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=Ry(this.serializer),t.removeTarget=e,this.t_(t)}}class Ew extends bw{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(Md(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(Md(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Iy(e.updateTime):Iy(t);return n.isEqual(tf.min())&&(n=Iy(t)),new xg(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Iy(e.commitTime);return this.listener.T_(n,t)}return Md(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=Ry(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Oy(this.serializer,e)))};this.t_(t)}}class Tw extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new Vd(Ud.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.So(e,Ty(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ud.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vd(Ud.UNKNOWN,e.toString())}))}vo(e,t,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.vo(e,Ty(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ud.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vd(Ud.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Sw{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.g_?(Ad(t),this.g_=!1):Pd("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Cw{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((e=>{n.enqueueAndForget((async()=>{Lw(this)&&(Pd("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Fd(e);t.v_.add(4),await xw(t),t.x_.set("Unknown"),t.v_.delete(4),await kw(t)}(this))}))})),this.x_=new Sw(n,r)}}async function kw(e){if(Lw(e))for(const t of e.F_)await t(!0)}async function xw(e){for(const t of e.F_)await t(!1)}function Nw(e,t){const n=Fd(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),Ow(n)?Dw(n):Zw(n).Jo()&&Pw(n,t))}function Rw(e,t){const n=Fd(e),r=Zw(n);n.C_.delete(t),r.Jo()&&Aw(n,t),0===n.C_.size&&(r.Jo()?r.Xo():Lw(n)&&n.x_.set("Unknown"))}function Pw(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(tf.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Zw(e).c_(t)}function Aw(e,t){e.O_.Oe(t),Zw(e).l_(t)}function Dw(e){e.O_=new hy({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Zw(e).start(),e.x_.p_()}function Ow(e){return Lw(e)&&!Zw(e).Ho()&&e.C_.size>0}function Lw(e){return 0===Fd(e).v_.size}function Mw(e){e.O_=void 0}async function Fw(e){e.C_.forEach(((t,n)=>{Pw(e,t)}))}async function Uw(e,t){Mw(e),Ow(e)?(e.x_.S_(t),Dw(e)):e.x_.set("Unknown")}async function Vw(e,t,n){if(e.x_.set("Online"),t instanceof cy&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){Pd("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await jw(e,n)}else if(t instanceof ay?e.O_.$e(t):t instanceof ly?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(tf.min()))try{const t=await z_(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.O_.it(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.C_.get(r);i&&e.C_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(Ep.EMPTY_BYTE_STRING,r.snapshotVersion)),Aw(e,t);const i=new Qy(r.target,t,n,r.sequenceNumber);Pw(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Pd("RemoteStore","Failed to raise snapshot:",t),await jw(e,t)}}async function jw(e,t,n){if(!Sf(t))throw t;e.v_.add(1),await xw(e),e.x_.set("Offline"),n||(n=()=>z_(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Pd("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await kw(e)}))}function qw(e,t){return t().catch((n=>jw(e,n,t)))}async function Bw(e){const t=Fd(e),n=eb(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;zw(t);)try{const e=await K_(t.localStore,r);if(null===e){0===t.D_.length&&n.Xo();break}r=e.batchId,Ww(t,e)}catch(e){await jw(t,e)}Kw(t)&&Hw(t)}function zw(e){return Lw(e)&&e.D_.length<10}function Ww(e,t){e.D_.push(t);const n=eb(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Kw(e){return Lw(e)&&!eb(e).Ho()&&e.D_.length>0}function Hw(e){eb(e).start()}async function Gw(e){eb(e).d_()}async function Qw(e){const t=eb(e);for(const n of e.D_)t.I_(n.mutations)}async function Yw(e,t,n){const r=e.D_.shift(),i=Kg.from(r,t,n);await qw(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Bw(e)}async function Jw(e,t){t&&eb(e).P_&&await async function(e,t){if(function(e){return Jg(e)&&e!==Ud.ABORTED}(t.code)){const n=e.D_.shift();eb(e).Zo(),await qw(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Bw(e)}}(e,t),Kw(e)&&Hw(e)}async function $w(e,t){const n=Fd(e);n.asyncQueue.verifyOperationInProgress(),Pd("RemoteStore","RemoteStore received new credentials");const r=Lw(n);n.v_.add(3),await xw(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await kw(n)}async function Xw(e,t){const n=Fd(e);t?(n.v_.delete(2),await kw(n)):t||(n.v_.add(2),await xw(n),n.x_.set("Unknown"))}function Zw(e){return e.N_||(e.N_=function(e,t,n){const r=Fd(e);return r.R_(),new Iw(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Fw.bind(null,e),To:Uw.bind(null,e),u_:Vw.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),Ow(e)?Dw(e):e.x_.set("Unknown")):(await e.N_.stop(),Mw(e))}))),e.N_}function eb(e){return e.L_||(e.L_=function(e,t,n){const r=Fd(e);return r.R_(),new Ew(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Gw.bind(null,e),To:Jw.bind(null,e),E_:Qw.bind(null,e),T_:Yw.bind(null,e)}),e.F_.push((async t=>{t?(e.L_.Zo(),await Bw(e)):(await e.L_.stop(),e.D_.length>0&&(Pd("RemoteStore","Stopping write stream with ".concat(e.D_.length," pending writes")),e.D_=[]))}))),e.L_}class tb{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new jd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new tb(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vd(Ud.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nb(e,t){if(Ad("AsyncQueue","".concat(t,": ").concat(e)),Sf(e))return new Vd(Ud.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class rb{constructor(e){this.comparator=e?(t,n)=>e(t,n)||af.comparator(t.key,n.key):(e,t)=>af.comparator(e.key,t.key),this.keyedMap=ng(),this.sortedSet=new mp(this.comparator)}static emptySet(e){return new rb(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof rb))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new rb;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ib{constructor(){this.B_=new mp(af.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):Ld():this.B_=this.B_.insert(t,e)}k_(){const e=[];return this.B_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class sb{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new sb(e,t,rb.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Km(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class ob{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((e=>e.U_()))}}class ab{constructor(){this.queries=new Xm((e=>Hm(e)),Km),this.onlineState="Unknown",this.W_=new Set}}async function lb(e,t){const n=Fd(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.K_()&&t.U_()&&(r=2):(s=new ob,r=t.U_()?0:1);try{switch(r){case 0:s.q_=await n.onListen(i,!0);break;case 1:s.q_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=nb(e,"Initialization of query '".concat(Gm(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.Q_.push(t),t.G_(n.onlineState),s.q_&&t.z_(s.q_)&&db(n)}async function cb(e,t){const n=Fd(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Q_.indexOf(t);e>=0&&(s.Q_.splice(e,1),0===s.Q_.length?i=t.U_()?0:1:!s.K_()&&t.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ub(e,t){const n=Fd(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Q_)e.z_(i)&&(r=!0);t.q_=i}}r&&db(n)}function hb(e,t,n){const r=Fd(e),i=r.queries.get(t);if(i)for(const s of i.Q_)s.onError(n);r.queries.delete(t)}function db(e){e.W_.forEach((e=>{e.next()}))}var fb,pb;(pb=fb||(fb={})).j_="default",pb.Cache="cache";class mb{constructor(e,t,n){this.query=e,this.H_=t,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=n||{}}z_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new sb(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),t=!0):this.X_(e,this.onlineState)&&(this.ea(e),t=!0),this.Y_=e,t}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let t=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),t=!0),t}X_(e,t){if(!e.fromCache)return!0;if(!this.U_())return!0;const n="Offline"!==t;return(!this.options.ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Z_(e){if(e.docChanges.length>0)return!0;const t=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ea(e){e=sb.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==fb.Cache}}class gb{constructor(e,t){this.na=e,this.byteLength=t}ra(){return"metadata"in this.na}}class yb{constructor(e){this.serializer=e}Ps(e){return ky(this.serializer,e)}Is(e){return e.metadata.exists?Dy(this.serializer,e.document,!1):nm.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Iy(e)}}class vb{constructor(e,t,n){this.ia=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=_b(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++t;const n=rf.fromString(e.na.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}oa(e){const t=new Map,n=new yb(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Ps(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||cg()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=Fd(e);let s=cg(),o=eg();for(const c of n){const e=t.Ps(c.metadata.name);c.document&&(s=s.add(e));const n=t.Is(c);n.setReadTime(t.Ts(c.metadata.readTime)),o=o.insert(e,n)}const a=i.os.newChangeBuffer({trackRemovals:!0}),l=await H_(i,function(e){return qm(Fm(rf.fromString("__bundle__/docs/".concat(e))))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>W_(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Qr.removeMatchingKeysForTargetId(e,l.targetId).next((()=>i.Qr.addMatchingKeys(e,s,l.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls))).next((()=>t.cs))))))}(this.localStore,new yb(this.serializer),this.documents,this.ia.id),t=this.oa(this.documents);for(const n of this.queries)await X_(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}}}function _b(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class wb{constructor(e){this.key=e}}class bb{constructor(e){this.key=e}}class Ib{constructor(e,t){this.query=e,this.ua=t,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=cg(),this.mutatedKeys=cg(),this.ha=Jm(e),this.Pa=new rb(this.ha)}get Ia(){return this.ua}Ta(e,t){const n=t?t.Ea:new ib,r=t?t.Pa:this.Pa;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Qm(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.da(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ha(u,a)>0||l&&this.ha(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Pa:s,Ea:n,Xi:o,mutatedKeys:i}}da(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;const s=e.Ea.k_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ld()}};return n(e)-n(t)}(e.type,t.type)||this.ha(e.doc,t.doc))),this.Aa(n),r=null!=r&&r;const o=t&&!r?this.Ra():[],a=0===this.la.size&&this.current&&!r?1:0,l=a!==this.ca;return this.ca=a,0!==s.length||l?{snapshot:new sb(this.query,e.Pa,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Va:o}:{Va:o}}G_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new ib,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach((e=>this.ua=this.ua.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ua=this.ua.delete(e))),this.current=e.current)}Ra(){if(!this.current)return[];const e=this.la;this.la=cg(),this.Pa.forEach((e=>{this.ma(e.key)&&(this.la=this.la.add(e.key))}));const t=[];return e.forEach((e=>{this.la.has(e)||t.push(new bb(e))})),this.la.forEach((n=>{e.has(n)||t.push(new wb(n))})),t}fa(e){this.ua=e.hs,this.la=cg();const t=this.Ta(e.documents);return this.applyChanges(t,!0)}ga(){return sb.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class Eb{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Tb{constructor(e){this.key=e,this.pa=!1}}class Sb{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.ya={},this.wa=new Xm((e=>Hm(e)),Km),this.Sa=new Map,this.ba=new Set,this.Da=new mp(af.comparator),this.Ca=new Map,this.va=new b_,this.Fa={},this.Ma=new Map,this.xa=Jv.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function Cb(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=tI(e);let i;const s=r.wa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=await xb(r,t,n,!0),i}async function kb(e,t){const n=tI(e);await xb(n,t,!0,!1)}async function xb(e,t,n,r){const i=await H_(e.localStore,qm(t)),s=i.targetId,o=n?e.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=await Nb(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Nw(e.remoteStore,i),a}async function Nb(e,t,n,r,i){e.Na=(t,n,r)=>async function(e,t,n,r){let i=t.view.Ta(n);i.Xi&&(i=await Q_(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.Ta(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return qb(e,t.targetId,a.Va),a.snapshot}(e,t,n,r);const s=await Q_(e.localStore,t,!0),o=new Ib(t,s.hs),a=o.Ta(s.documents),l=oy.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);qb(e,n,c.Va);const u=new Eb(t,n,o);return e.wa.set(t,u),e.Sa.has(n)?e.Sa.get(n).push(t):e.Sa.set(n,[t]),c.snapshot}async function Rb(e,t,n){const r=Fd(e),i=r.wa.get(t),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter((e=>!Km(e,t)))),void r.wa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await G_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Rw(r.remoteStore,i.targetId),Vb(r,i.targetId)})).catch(_f)):(Vb(r,i.targetId),await G_(r.localStore,i.targetId,!0))}async function Pb(e,t){const n=Fd(e),r=n.wa.get(t),i=n.Sa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Rw(n.remoteStore,r.targetId))}async function Ab(e,t){const n=Fd(e);try{const e=await function(e,t){const n=Fd(e),r=t.snapshotVersion;let i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(e,s.addedDocuments,a))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Ep.EMPTY_BYTE_STRING,tf.min()).withLastLimboFreeSnapshotVersion(tf.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Qr.updateTargetData(e,c))}));let a=eg(),l=cg();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(W_(e,s,t.documentUpdates).next((e=>{a=e.cs,l=e.ls}))),!r.isEqual(tf.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return wf.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.ns=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ca.get(t);r&&(Md(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.pa=!0:e.modifiedDocuments.size>0?Md(r.pa):e.removedDocuments.size>0&&(Md(r.pa),r.pa=!1))})),await Wb(n,e,t)}catch(e){await _f(e)}}function Db(e,t,n){const r=Fd(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wa.forEach(((n,r)=>{const i=r.view.G_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Fd(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.Q_)i.G_(t)&&(r=!0)})),r&&db(n)}(r.eventManager,t),e.length&&r.ya.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ob(e,t,n){const r=Fd(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ca.get(t),s=i&&i.key;if(s){let e=new mp(af.comparator);e=e.insert(s,nm.newNoDocument(s,tf.min()));const n=cg().add(s),i=new sy(tf.min(),new Map,new mp($d),e,n);await Ab(r,i),r.Da=r.Da.remove(s),r.Ca.delete(t),zb(r)}else await G_(r.localStore,t,!1).then((()=>Vb(r,t,n))).catch(_f)}async function Lb(e,t){const n=Fd(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Fd(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=wf.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);Md(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=cg();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Ub(n,r,null),Fb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Wb(n,e)}catch(e){await _f(e)}}async function Mb(e,t,n){const r=Fd(e);try{const e=await function(e,t){const n=Fd(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Md(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Ub(r,t,n),Fb(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Wb(r,e)}catch(n){await _f(n)}}function Fb(e,t){(e.Ma.get(t)||[]).forEach((e=>{e.resolve()})),e.Ma.delete(t)}function Ub(e,t,n){const r=Fd(e);let i=r.Fa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Fa[r.currentUser.toKey()]=i}}function Vb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Sa.get(t))e.wa.delete(r),n&&e.ya.La(r,n);e.Sa.delete(t),e.isPrimaryClient&&e.va.Vr(t).forEach((t=>{e.va.containsKey(t)||jb(e,t)}))}function jb(e,t){e.ba.delete(t.path.canonicalString());const n=e.Da.get(t);null!==n&&(Rw(e.remoteStore,n),e.Da=e.Da.remove(t),e.Ca.delete(n),zb(e))}function qb(e,t,n){for(const r of n)r instanceof wb?(e.va.addReference(r.key,t),Bb(e,r)):r instanceof bb?(Pd("SyncEngine","Document no longer in limbo: "+r.key),e.va.removeReference(r.key,t),e.va.containsKey(r.key)||jb(e,r.key)):Ld()}function Bb(e,t){const n=t.key,r=n.path.canonicalString();e.Da.get(n)||e.ba.has(r)||(Pd("SyncEngine","New document in limbo: "+n),e.ba.add(r),zb(e))}function zb(e){for(;e.ba.size>0&&e.Da.size<e.maxConcurrentLimboResolutions;){const t=e.ba.values().next().value;e.ba.delete(t);const n=new af(rf.fromString(t)),r=e.xa.next();e.Ca.set(r,new Tb(n)),e.Da=e.Da.insert(n,r),Nw(e.remoteStore,new Qy(qm(Fm(n.path)),r,"TargetPurposeLimboResolution",Af._e))}}async function Wb(e,t,n){const r=Fd(e),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach(((e,a)=>{o.push(r.Na(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=F_.Ki(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.ya.u_(i),await async function(e,t){const n=Fd(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>wf.forEach(t,(t=>wf.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>wf.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Sf(e))throw e;Pd("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,i)}}}(r.localStore,s))}async function Kb(e,t){const n=Fd(e);if(!n.currentUser.isEqual(t)){Pd("SyncEngine","User change. New user:",t.toKey());const e=await B_(n.localStore,t);n.currentUser=t,function(e,t){e.Ma.forEach((e=>{e.forEach((e=>{e.reject(new Vd(Ud.CANCELLED,t))}))})),e.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Wb(n,e.us)}}function Hb(e,t){const n=Fd(e),r=n.Ca.get(t);if(r&&r.pa)return cg().add(r.key);{let e=cg();const r=n.Sa.get(t);if(!r)return e;for(const t of r){const r=n.wa.get(t);e=e.unionWith(r.view.Ia)}return e}}async function Gb(e,t){const n=Fd(e),r=await Q_(n.localStore,t.query,!0),i=t.view.fa(r);return n.isPrimaryClient&&qb(n,t.targetId,i.Va),i}async function Qb(e,t){const n=Fd(e);return J_(n.localStore,t).then((e=>Wb(n,e)))}async function Yb(e,t,n,r){const i=Fd(e),s=await function(e,t){const n=Fd(e),r=Fd(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.vn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):wf.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Bw(i.remoteStore):"acknowledged"===n||"rejected"===n?(Ub(i,t,r||null),Fb(i,t),function(e,t){Fd(Fd(e).mutationQueue).Mn(t)}(i.localStore,t)):Ld(),await Wb(i,s)):Pd("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Jb(e,t,n){const r=Fd(e),i=[],s=[];for(const o of t){let e;const t=r.Sa.get(o);if(t&&0!==t.length){e=await H_(r.localStore,qm(t[0]));for(const e of t){const t=r.wa.get(e),n=await Gb(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await Y_(r.localStore,o);e=await H_(r.localStore,t),await Nb(r,$b(t),o,!1,e.resumeToken)}i.push(e)}return r.ya.u_(s),i}function $b(e){return Mm(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Xb(e){return function(e){return Fd(Fd(e).persistence).Bi()}(Fd(e).localStore)}async function Zb(e,t,n,r){const i=Fd(e);if(i.Oa)return void Pd("SyncEngine","Ignoring unexpected query state notification.");const s=i.Sa.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await J_(i.localStore,Ym(s[0])),r=sy.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,Ep.EMPTY_BYTE_STRING);await Wb(i,e,r);break}case"rejected":await G_(i.localStore,t,!0),Vb(i,t,r);break;default:Ld()}}async function eI(e,t,n){const r=tI(e);if(r.Oa){for(const e of t){if(r.Sa.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){Pd("SyncEngine","Adding an already active target "+e);continue}const t=await Y_(r.localStore,e),n=await H_(r.localStore,t);await Nb(r,$b(t),n.targetId,!1,n.resumeToken),Nw(r.remoteStore,n)}for(const e of n)r.Sa.has(e)&&await G_(r.localStore,e,!1).then((()=>{Rw(r.remoteStore,e),Vb(r,e)})).catch(_f)}}function tI(e){const t=Fd(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ab.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hb.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ob.bind(null,t),t.ya.u_=ub.bind(null,t.eventManager),t.ya.La=hb.bind(null,t.eventManager),t}function nI(e){const t=Fd(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Lb.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Mb.bind(null,t),t}class rI{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=_w(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return q_(this.persistence,new V_,e.initialUser,this.serializer)}createPersistence(e){return new k_(N_.Hr,this.serializer)}createSharedClientState(e){return new lw}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class iI extends rI{constructor(e,t,n){super(),this.ka=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ka.initialize(this,e),await nI(this.ka.syncEngine),await Bw(this.ka.remoteStore),await this.persistence.fi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return q_(this.persistence,new V_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new r_(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new Pf(t,this.persistence);return new Rf(e.asyncQueue,n)}createPersistence(e){const t=M_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Bv.withCacheSize(this.cacheSizeBytes):Bv.DEFAULT;return new D_(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,yw(),vw(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new lw}}class sI extends iI{constructor(e,t){super(e,t,!1),this.ka=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ka.syncEngine;this.sharedClientState instanceof aw&&(this.sharedClientState.syncEngine={Zs:Yb.bind(null,t),Xs:Zb.bind(null,t),eo:eI.bind(null,t),Bi:Xb.bind(null,t),Ys:Qb.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi((async e=>{await async function(e,t){const n=Fd(e);if(tI(n),nI(n),!0===t&&!0!==n.Oa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Jb(n,e.toArray());n.Oa=!0,await Xw(n.remoteStore,!0);for(const r of t)Nw(n.remoteStore,r)}else if(!1===t&&!1!==n.Oa){const e=[];let t=Promise.resolve();n.Sa.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(Vb(n,i),G_(n.localStore,i,!0)))),Rw(n.remoteStore,i)})),await t,await Jb(n,e),function(e){const t=Fd(e);t.Ca.forEach(((e,n)=>{Rw(t.remoteStore,n)})),t.va.mr(),t.Ca=new Map,t.Da=new mp(af.comparator)}(n),n.Oa=!1,await Xw(n.remoteStore,!1)}}(this.ka.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=yw();if(!aw.D(t))throw new Vd(Ud.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=M_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new aw(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class oI{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Db(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kb.bind(null,this.syncEngine),await Xw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ab}createDatastore(e){const t=_w(e.databaseInfo.databaseId),n=function(e){return new gw(e)}(e.databaseInfo);return function(e,t,n,r){return new Tw(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Cw(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Db(this.syncEngine,e,0)),uw.D()?new uw:new cw)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Sb(e,t,n,r,i,s);return o&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=Fd(e);Pd("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await xw(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}function aI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class lI{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Ad("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class cI{constructor(e,t){this.Ka=e,this.serializer=t,this.metadata=new jd,this.buffer=new Uint8Array,this.$a=new TextDecoder("utf-8"),this.Ua().then((e=>{e&&e.ra()?this.metadata.resolve(e.na.metadata):this.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.na))))}),(e=>this.metadata.reject(e)))}close(){return this.Ka.cancel()}async getMetadata(){return this.metadata.promise}async Ba(){return await this.getMetadata(),this.Ua()}async Ua(){const e=await this.Wa();if(null===e)return null;const t=this.$a.decode(e),n=Number(t);isNaN(n)&&this.Ga("length string (".concat(t,") is not valid number"));const r=await this.za(n);return new gb(JSON.parse(r),e.length+n)}ja(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Wa(){for(;this.ja()<0&&!await this.Ha(););if(0===this.buffer.length)return null;const e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async za(e){for(;this.buffer.length<e;)await this.Ha()&&this.Ga("Reached the end of bundle when more is expected.");const t=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Ga(e){throw this.Ka.cancel(),new Error("Invalid bundle format: ".concat(e))}async Ha(){const e=await this.Ka.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class uI{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Vd(Ud.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=Fd(e),r={documents:t.map((e=>Cy(n.serializer,e)))},i=await n.vo("BatchGetDocuments",n.serializer.databaseId,rf.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){Md(!!t.found),t.found.name,t.found.updateTime;const n=ky(e,t.found.name),r=Iy(t.found.updateTime),i=t.found.createTime?Iy(t.found.createTime):tf.min(),s=new em({mapValue:{fields:t.found.fields}});return nm.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){Md(!!t.missing),Md(!!t.readTime);const n=ky(e,t.missing),r=Iy(t.readTime);return nm.newNoDocument(n,r)}(e,t):Ld()}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());Md(!!t),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Bg(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=af.fromPath(t);this.mutations.push(new zg(n,this.precondition(n)))})),await async function(e,t){const n=Fd(e),r={writes:t.map((e=>Oy(n.serializer,e)))};await n.So("Commit",n.serializer.databaseId,rf.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ld();t=tf.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Vd(Ud.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(tf.min())?Ng.exists(!1):Ng.updateTime(t):Ng.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(tf.min()))throw new Vd(Ud.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ng.updateTime(t)}return Ng.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class hI{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Ja=n.maxAttempts,this.jo=new ww(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo((async()=>{const e=new uI(this.datastore),t=this.Xa(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.eu(e)}))))})).catch((e=>{this.eu(e)}))}))}Xa(e){try{const t=this.updateFunction(e);return!Df(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget((()=>(this.Za(),Promise.resolve())))):this.deferred.reject(e)}tu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Jg(t)}return!1}}class dI{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=kd.UNAUTHENTICATED,this.clientId=Jd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Pd("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Pd("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Vd(Ud.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=nb(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fI(e,t){e.asyncQueue.verifyOperationInProgress(),Pd("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await B_(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function pI(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gI(e);Pd("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>$w(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>$w(t.remoteStore,n))),e._onlineComponents=t}function mI(e){return"FirebaseError"===e.name?e.code===Ud.FAILED_PRECONDITION||e.code===Ud.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function gI(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Pd("FirestoreClient","Using user provided OfflineComponentProvider");try{await fI(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!mI(n))throw n;Dd("Error using user provided cache. Falling back to memory cache: "+n),await fI(e,new rI)}}else Pd("FirestoreClient","Using default OfflineComponentProvider"),await fI(e,new rI);return e._offlineComponents}async function yI(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Pd("FirestoreClient","Using user provided OnlineComponentProvider"),await pI(e,e._uninitializedComponentsProvider._online)):(Pd("FirestoreClient","Using default OnlineComponentProvider"),await pI(e,new oI))),e._onlineComponents}function vI(e){return gI(e).then((e=>e.persistence))}function _I(e){return gI(e).then((e=>e.localStore))}function wI(e){return yI(e).then((e=>e.remoteStore))}function bI(e){return yI(e).then((e=>e.syncEngine))}function II(e){return yI(e).then((e=>e.datastore))}async function EI(e){const t=await yI(e),n=t.eventManager;return n.onListen=Cb.bind(null,t.syncEngine),n.onUnlisten=Rb.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=kb.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Pb.bind(null,t.syncEngine),n}function TI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new jd;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new lI({next:s=>{t.enqueueAndForget((()=>cb(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Vd(Ud.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Vd(Ud.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new mb(Fm(n.path),s,{includeMetadataChanges:!0,ta:!0});return lb(e,o)}(await EI(e),e.asyncQueue,t,n,r))),r.promise}function SI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new jd;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new lI({next:n=>{t.enqueueAndForget((()=>cb(e,o))),n.fromCache&&"server"===r.source?i.reject(new Vd(Ud.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new mb(n,s,{includeMetadataChanges:!0,ta:!0});return lb(e,o)}(await EI(e),e.asyncQueue,t,n,r))),r.promise}function CI(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Zg().encode(e):e,function(e,t){return new cI(e,t)}(function(e,t){if(e instanceof Uint8Array)return aI(e,t);if(e instanceof ArrayBuffer)return aI(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,_w(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=Fd(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=Fd(e),r=Iy(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.$r.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(_b(r));const i=new vb(r,e.localStore,t.serializer);let s=await t.Ba();for(;s;){const e=await i.sa(s);e&&n._updateProgress(e),s=await t.Ba()}const o=await i.complete();return await Wb(e,o.aa,void 0),await function(e,t){const n=Fd(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.$r.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o._a)}catch(e){return Dd("SyncEngine","Loading bundle failed with ".concat(e)),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await bI(e),i,r)}))}function kI(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const xI=new Map;function NI(e,t,n){if(!n)throw new Vd(Ud.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function RI(e,t,n,r){if(!0===t&&!0===r)throw new Vd(Ud.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function PI(e){if(!af.isDocumentKey(e))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function AI(e){if(af.isDocumentKey(e))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function DI(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Ld()}function OI(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Vd(Ud.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=DI(e);throw new Vd(Ud.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function LI(e,t){if(t<=0)throw new Vd(Ud.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class MI{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Vd(Ud.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Vd(Ud.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kI(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Vd(Ud.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Vd(Ud.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Vd(Ud.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class FI{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Vd(Ud.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Vd(Ud.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MI(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Bd;switch(e.type){case"firstParty":return new Hd(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Vd(Ud.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=xI.get(e);t&&(Pd("ComponentProvider","Removing Datastore"),xI.delete(e),t.terminate())}(this),Promise.resolve()}}function UI(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=OI(e,FI))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==o&&Dd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=kd.MOCK_USER;else{t=He(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Vd(Ud.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new kd(s)}e._authCredentials=new zd(new qd(t,n))}}class VI{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new VI(this.firestore,e,this._query)}}class jI{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qI(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jI(this.firestore,e,this._key)}}class qI extends VI{constructor(e,t,n){super(e,t,Fm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jI(this.firestore,null,new af(e))}withConverter(e){return new qI(this.firestore,e,this._path)}}function BI(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=kt(e),NI("collection","path",t),e instanceof FI){const n=rf.fromString(t,...r);return AI(n),new qI(e,null,n)}{if(!(e instanceof jI||e instanceof qI))throw new Vd(Ud.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(rf.fromString(t,...r));return AI(n),new qI(e.firestore,null,n)}}function zI(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=kt(e),1===arguments.length&&(t=Jd.newId()),NI("doc","path",t),e instanceof FI){const n=rf.fromString(t,...r);return PI(n),new jI(e,null,new af(n))}{if(!(e instanceof jI||e instanceof qI))throw new Vd(Ud.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(rf.fromString(t,...r));return PI(n),new jI(e.firestore,e instanceof qI?e.converter:null,new af(n))}}function WI(e,t){return e=kt(e),t=kt(t),(e instanceof jI||e instanceof qI)&&(t instanceof jI||t instanceof qI)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function KI(e,t){return e=kt(e),t=kt(t),e instanceof VI&&t instanceof VI&&e.firestore===t.firestore&&Km(e._query,t._query)&&e.converter===t.converter}class HI{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new ww(this,"async_queue_retry"),this.cu=()=>{const e=vw();e&&Pd("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=vw();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;const t=vw();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise((()=>{}));const t=new jd;return this.hu((()=>this.iu&&this.au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.ru.push(e),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Sf(e))throw e;Pd("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(e){const t=this.nu.then((()=>(this._u=!0,e().catch((e=>{this.ou=e,this._u=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ad("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this._u=!1,e))))));return this.nu=t,t}enqueueAfterDelay(e,t,n){this.lu(),this.uu.indexOf(e)>-1&&(t=0);const r=tb.createAndSchedule(this,e,t,n,(e=>this.Iu(e)));return this.su.push(r),r}lu(){this.ou&&Ld()}verifyOperationInProgress(){}async Tu(){let e;do{e=this.nu,await e}while(e!==this.nu)}Eu(e){for(const t of this.su)if(t.timerId===e)return!0;return!1}du(e){return this.Tu().then((()=>{this.su.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.su)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tu()}))}Au(e){this.uu.push(e)}Iu(e){const t=this.su.indexOf(e);this.su.splice(t,1)}}function GI(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class QI{constructor(){this._progressObserver={},this._taskCompletionResolver=new jd,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class YI extends FI{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new HI,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||$I(this),this._firestoreClient.terminate()}}function JI(e){return e._firestoreClient||$I(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function $I(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Pp(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,kI(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new dI(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function XI(e,t,n){const r=new jd;return e.asyncQueue.enqueue((async()=>{try{await fI(e,n),await pI(e,t),r.resolve()}catch(e){const n=e;if(!mI(n))throw n;Dd("Error enabling indexeddb cache. Falling back to memory cache: "+n),r.reject(n)}})).then((()=>r.promise))}function ZI(e){return function(e){const t=new jd;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Fd(e);Lw(n.remoteStore)||Pd("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=Fd(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Ma.get(e)||[];r.push(t),n.Ma.set(e,r)}catch(e){const n=nb(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await bI(e),t))),t.promise}(JI(e=OI(e,YI)))}function eE(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await vI(e),n=await wI(e);return t.setNetworkEnabled(!0),function(e){const t=Fd(e);return t.v_.delete(0),kw(t)}(n)}))}(JI(e=OI(e,YI)))}function tE(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await vI(e),n=await wI(e);return t.setNetworkEnabled(!1),async function(e){const t=Fd(e);t.v_.add(0),await xw(t),t.x_.set("Offline")}(n)}))}(JI(e=OI(e,YI)))}function nE(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=Fd(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.$r.getNamedQuery(e,t)))}(await _I(e),t)))}(JI(e=OI(e,YI)),t).then((t=>t?new VI(e,null,t.query):null))}function rE(e){if(e._initialized||e._terminated)throw new Vd(Ud.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class iE{constructor(e){this._byteString=e}static fromBase64String(e){try{return new iE(Ep.fromBase64String(e))}catch(e){throw new Vd(Ud.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new iE(Ep.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class sE{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new of(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class oE{constructor(e){this._methodName=e}}class aE{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Vd(Ud.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Vd(Ud.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $d(this._lat,e._lat)||$d(this._long,e._long)}}const lE=/^__.*__$/;class cE{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ug(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fg(e,this.data,t,this.fieldTransforms)}}class uE{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ug(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hE(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ld()}}class dE{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ru(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new dE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.pu(e),r}yu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return AE(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(0===e.length)throw this.Su("Document fields must not be empty");if(hE(this.Vu)&&lE.test(e))throw this.Su('Document fields cannot begin and end with "__"')}}class fE{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||_w(e)}Cu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new dE({Vu:e,methodName:t,Du:n,path:of.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pE(e){const t=e._freezeSettings(),n=_w(e._databaseId);return new fE(e._databaseId,!!t.ignoreUndefinedProperties,n)}function mE(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Cu(s.merge||s.mergeFields?2:0,t,n,i);xE("Data must be an object, but it was:",o,r);const a=CE(r,o);let l,c;if(s.merge)l=new bp(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=NE(t,r,n);if(!o.contains(i))throw new Vd(Ud.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));DE(e,i)||e.push(i)}l=new bp(e),c=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=o.fieldTransforms;return new cE(new em(a),l,c)}class gE extends oE{_toFieldTransform(e){if(2!==e.Vu)throw 1===e.Vu?e.Su("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Su("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gE}}function yE(e,t,n){return new dE({Vu:3,Du:t.settings.Du,methodName:e._methodName,gu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class vE extends oE{_toFieldTransform(e){return new kg(e.path,new _g)}isEqual(e){return e instanceof vE}}class _E extends oE{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=yE(this,e,!0),n=this.vu.map((e=>SE(e,t))),r=new wg(n);return new kg(e.path,r)}isEqual(e){return e instanceof _E&&ft(this.vu,e.vu)}}class wE extends oE{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=yE(this,e,!0),n=this.vu.map((e=>SE(e,t))),r=new Ig(n);return new kg(e.path,r)}isEqual(e){return e instanceof wE&&ft(this.vu,e.vu)}}class bE extends oE{constructor(e,t){super(e),this.Fu=t}_toFieldTransform(e){const t=new Tg(e.serializer,pg(e.serializer,this.Fu));return new kg(e.path,t)}isEqual(e){return e instanceof bE&&this.Fu===e.Fu}}function IE(e,t,n,r){const i=e.Cu(1,t,n);xE("Data must be an object, but it was:",i,r);const s=[],o=em.empty();fp(r,((e,r)=>{const a=PE(t,e,n);r=kt(r);const l=i.yu(a);if(r instanceof gE)s.push(a);else{const e=SE(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new bp(s);return new uE(o,a,i.fieldTransforms)}function EE(e,t,n,r,i,s){const o=e.Cu(1,t,n),a=[NE(t,r,n)],l=[i];if(s.length%2!=0)throw new Vd(Ud.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)a.push(NE(t,s[d])),l.push(s[d+1]);const c=[],u=em.empty();for(let d=a.length-1;d>=0;--d)if(!DE(c,a[d])){const e=a[d];let t=l[d];t=kt(t);const n=o.yu(e);if(t instanceof gE)c.push(e);else{const r=SE(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new bp(c);return new uE(u,h,o.fieldTransforms)}function TE(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return SE(n,e.Cu(r?4:3,t))}function SE(e,t){if(kE(e=kt(e)))return xE("Unsupported field value:",t,e),CE(e,t);if(e instanceof oE)return function(e,t){if(!hE(t.Vu))throw t.Su("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Su("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.gu&&4!==t.Vu)throw t.Su("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=SE(i,t.wu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=kt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pg(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ef.fromDate(e);return{timestampValue:_y(t.serializer,n)}}if(e instanceof ef){const n=new ef(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:_y(t.serializer,n)}}if(e instanceof aE)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof iE)return{bytesValue:wy(t.serializer,e._byteString)};if(e instanceof jI){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Su("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ey(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Su("Unsupported field value: ".concat(DI(e)))}(e,t)}function CE(e,t){const n={};return pp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):fp(e,((e,r)=>{const i=SE(r,t.fu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function kE(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ef||e instanceof aE||e instanceof iE||e instanceof jI||e instanceof oE)}function xE(e,t,n){if(!kE(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=DI(n);throw"an object"===r?t.Su(e+" a custom object"):t.Su(e+" "+r)}}function NE(e,t,n){if((t=kt(t))instanceof sE)return t._internalPath;if("string"==typeof t)return PE(e,t);throw AE("Field path arguments must be of type string or ",e,!1,void 0,n)}const RE=new RegExp("[~\\*/\\[\\]]");function PE(e,t,n){if(t.search(RE)>=0)throw AE("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new sE(...t.split("."))._internalPath}catch(wl){throw AE("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function AE(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(i)),l+=")"),new Vd(Ud.INVALID_ARGUMENT,a+e+l)}function DE(e,t){return e.some((e=>e.isEqual(t)))}class OE{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new jI(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new LE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ME("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class LE extends OE{data(){return super.data()}}function ME(e,t){return"string"==typeof t?PE(e,t):t instanceof sE?t._internalPath:t._delegate._internalPath}function FE(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Vd(Ud.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class UE{}class VE extends UE{}function jE(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof UE&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof BE)).length,n=e.filter((e=>e instanceof qE)).length;if(t>1||t>0&&n>0)throw new Vd(Ud.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class qE extends VE{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new qE(e,t,n)}_apply(e){const t=this._parse(e);return JE(e._query,t),new VI(e.firestore,e.converter,zm(e._query,t))}_parse(e){const t=pE(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){YE(o,s);const t=[];for(const n of o)t.push(QE(r,e,n));a={arrayValue:{values:t}}}else a=QE(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||YE(o,s),a=TE(n,t,o,"in"===s||"not-in"===s);return cm.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class BE extends UE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new BE(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:um.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)JE(n,i),n=zm(n,i)}(e._query,t),new VI(e.firestore,e.converter,zm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class zE extends VE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zE(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new om(t,n)}(e._query,this._field,this._direction);return new VI(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Lm(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class WE extends VE{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new WE(e,t,n)}_apply(e){return new VI(e.firestore,e.converter,Wm(e._query,this._limit,this._limitType))}}class KE extends VE{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new KE(e,t,n)}_apply(e){const t=GE(e,this.type,this._docOrFields,this._inclusive);return new VI(e.firestore,e.converter,function(e,t){return new Lm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class HE extends VE{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new HE(e,t,n)}_apply(e){const t=GE(e,this.type,this._docOrFields,this._inclusive);return new VI(e.firestore,e.converter,function(e,t){return new Lm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function GE(e,t,n,r){if(n[0]=kt(n[0]),n[0]instanceof OE)return function(e,t,n,r,i){if(!r)throw new Vd(Ud.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const o of jm(e))if(o.field.isKeyField())s.push(Bp(t,r.key));else{const e=r.data.field(o.field);if(xp(e))throw new Vd(Ud.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new rm(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=pE(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Vd(Ud.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const a=[];for(let l=0;l<i.length;l++){const s=i[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!Vm(e)&&-1!==s.indexOf("/"))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child(rf.fromString(s));if(!af.isDocumentKey(n))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const i=new af(n);a.push(Bp(t,i))}else{const e=TE(n,r,s);a.push(e)}}return new rm(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function QE(e,t,n){if("string"==typeof(n=kt(n))){if(""===n)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vm(t)&&-1!==n.indexOf("/"))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(rf.fromString(n));if(!af.isDocumentKey(r))throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Bp(e,new af(r))}if(n instanceof jI)return Bp(e,n._key);throw new Vd(Ud.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(DI(n),"."))}function YE(e,t){if(!Array.isArray(e)||0===e.length)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function JE(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Vd(Ud.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Vd(Ud.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class $E{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Lp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ld()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return fp(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new aE(Cp(e.latitude),Cp(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Np(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Rp(e));default:return null}}convertTimestamp(e){const t=Sp(e);return new ef(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=rf.fromString(e);Md(Gy(n));const r=new Ap(n.get(1),n.get(3)),i=new af(n.popFirst(5));return r.isEqual(t)||Ad("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function XE(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class ZE extends $E{constructor(e){super(),this.firestore=e}convertBytes(e){return new iE(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jI(this.firestore,null,t)}}class eT{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class tT extends OE{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new nT(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(ME("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class nT extends tT{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class rT{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new eT(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new nT(this._firestore,this._userDataWriter,n.key,n,new eT(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Vd(Ud.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new nT(e._firestore,e._userDataWriter,n.doc.key,n.doc,new eT(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new nT(e._firestore,e._userDataWriter,t.doc.key,t.doc,new eT(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:iT(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function iT(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ld()}}function sT(e,t){return e instanceof tT&&t instanceof tT?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof rT&&t instanceof rT&&e._firestore===t._firestore&&KI(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}class oT extends $E{constructor(e){super(),this.firestore=e}convertBytes(e){return new iE(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jI(this.firestore,null,t)}}function aT(e){e=OI(e,jI);const t=OI(e.firestore,YI),n=JI(t),r=new oT(t);return function(e,t){const n=new jd;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=Fd(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new Vd(Ud.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=nb(e,"Failed to get document '".concat(t," from cache"));n.reject(r)}}(await _I(e),t,n))),n.promise}(n,e._key).then((n=>new tT(t,r,e._key,n,new eT(null!==n&&n.hasLocalMutations,!0),e.converter)))}function lT(e){e=OI(e,VI);const t=OI(e.firestore,YI),n=JI(t),r=new oT(t);return function(e,t){const n=new jd;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Q_(e,t,!0),i=new Ib(t,r.hs),s=i.Ta(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=nb(e,"Failed to execute query '".concat(t," against cache"));n.reject(r)}}(await _I(e),t,n))),n.promise}(n,e._query).then((n=>new rT(t,r,e,n)))}function cT(e,t,n){e=OI(e,jI);const r=OI(e.firestore,YI),i=XE(e.converter,t,n);return pT(r,[mE(pE(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Ng.none())])}function uT(e,t,n){e=OI(e,jI);const r=OI(e.firestore,YI),i=pE(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=kt(t))||t instanceof sE?EE(i,"updateDoc",e._key,t,n,a):IE(i,"updateDoc",e._key,t),pT(r,[s.toMutation(e._key,Ng.exists(!0))])}function hT(e,t){const n=OI(e.firestore,YI),r=zI(e),i=XE(e.converter,t);return pT(n,[mE(pE(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Ng.exists(!1))]).then((()=>r))}function dT(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=kt(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||GI(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(GI(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,h,d;if(e instanceof jI)h=OI(e.firestore,YI),d=Fm(e._key.path),u={next:t=>{n[l]&&n[l](mT(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=OI(e,VI);h=OI(t.firestore,YI),d=t._query;const r=new oT(h);u={next:e=>{n[l]&&n[l](new rT(h,r,t,e))},error:n[l+1],complete:n[l+2]},FE(e._query)}return function(e,t,n,r){const i=new lI(r),s=new mb(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>lb(await EI(e),s))),()=>{i.Qa(),e.asyncQueue.enqueueAndForget((async()=>cb(await EI(e),s)))}}(JI(h),d,c,u)}function fT(e,t){return function(e,t){const n=new lI(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){Fd(e).W_.add(t),t.next()}(await EI(e),n))),()=>{n.Qa(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){Fd(e).W_.delete(t)}(await EI(e),n)))}}(JI(e=OI(e,YI)),GI(t)?t:{next:t})}function pT(e,t){return function(e,t){const n=new jd;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=nI(e);try{const e=await function(e,t){const n=Fd(e),r=ef.now(),i=t.reduce(((e,t)=>e.add(t.key)),cg());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=eg(),l=cg();return n.os.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Lg(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Ug(e.key,t,tm(t.value.mapValue),Ng.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:rg(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Fa[e.currentUser.toKey()];r||(r=new mp($d)),r=r.insert(t,n),e.Fa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Wb(r,e.changes),await Bw(r.remoteStore)}catch(e){const t=nb(e,"Failed to persist write");n.reject(t)}}(await bI(e),t,n))),n.promise}(JI(e),t)}function mT(e,t,n){const r=n.docs.get(t._key),i=new oT(e);return new tT(e,i,t._key,r,new eT(n.hasPendingWrites,n.fromCache),t.converter)}const gT={maxAttempts:5};class yT{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=pE(e)}set(e,t,n){this._verifyNotCommitted();const r=vT(e,this._firestore),i=XE(r.converter,t,n),s=mE(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Ng.none())),this}update(e,t,n){this._verifyNotCommitted();const r=vT(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=kt(t))||t instanceof sE?EE(this._dataReader,"WriteBatch.update",r._key,t,n,o):IE(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Ng.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=vT(e,this._firestore);return this._mutations=this._mutations.concat(new Bg(t._key,Ng.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Vd(Ud.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function vT(e,t){if((e=kt(e)).firestore!==t)throw new Vd(Ud.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class _T extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=pE(e)}get(e){const t=vT(e,this._firestore),n=new ZE(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return Ld();const r=e[0];if(r.isFoundDocument())return new OE(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new OE(this._firestore,n,t._key,null,t.converter);throw Ld()}))}set(e,t,n){const r=vT(e,this._firestore),i=XE(r.converter,t,n),s=mE(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=vT(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=kt(t))||t instanceof sE?EE(this._dataReader,"Transaction.update",r._key,t,n,o):IE(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=vT(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=vT(e,this._firestore),n=new oT(this._firestore);return super.get(e).then((e=>new tT(this._firestore,n,t._key,e._document,new eT(!1,!1),t.converter)))}}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){xd=e}(En),pn(new xt("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new YI(new Wd(e.getProvider("auth-internal")),new Qd(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Vd(Ud.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ap(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Nn(Cd,"4.6.0",e),Nn(Cd,"4.6.0","esm2017")}();function wT(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Vd("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function bT(){if("undefined"===typeof Uint8Array)throw new Vd("unimplemented","Uint8Arrays are not available in this environment.")}function IT(){if("undefined"==typeof atob)throw new Vd("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ET{constructor(e){this._delegate=e}static fromBase64String(e){return IT(),new ET(iE.fromBase64String(e))}static fromUint8Array(e){return bT(),new ET(iE.fromUint8Array(e))}toBase64(){return IT(),this._delegate.toBase64()}toUint8Array(){return bT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function TT(e){return function(e,t){if("object"!==typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"===typeof n[r])return!0;return!1}(e,["next","error","complete"])}class ST{enableIndexedDbPersistence(e,t){return function(e,t){rE(e=OI(e,YI));const n=JI(e);if(n._uninitializedComponentsProvider)throw new Vd(Ud.FAILED_PRECONDITION,"SDK cache is already specified.");Dd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new oI;return XI(n,i,new iI(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){rE(e=OI(e,YI));const t=JI(e);if(t._uninitializedComponentsProvider)throw new Vd(Ud.FAILED_PRECONDITION,"SDK cache is already specified.");Dd("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new oI;return XI(t,r,new sI(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new Vd(Ud.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new jd;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!If.D())return Promise.resolve();const t=e+"main";await If.delete(t)}(M_(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class CT{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ap||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||Dd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};UI(this._delegate,e,t,n)}enableNetwork(){return eE(this._delegate)}disableNetwork(){return tE(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,RI("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return ZI(this._delegate)}onSnapshotsInSync(e){return fT(this._delegate,e)}get app(){if(!this._appCompat)throw new Vd("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jT(this,BI(this._delegate,e))}catch(t){throw AT(t,"collection()","Firestore.collection()")}}doc(e){try{return new PT(this,zI(this._delegate,e))}catch(t){throw AT(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new FT(this,function(e,t){if(e=OI(e,FI),NI("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Vd(Ud.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new VI(e,null,function(e){return new Lm(rf.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw AT(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function(e,t,n){e=OI(e,YI);const r=Object.assign(Object.assign({},gT),n);return function(e){if(e.maxAttempts<1)throw new Vd(Ud.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new jd;return e.asyncQueue.enqueueAndForget((async()=>{const i=await II(e);new hI(e.asyncQueue,i,n,t,r).Ya()})),r.promise}(JI(e),(n=>t(new _T(e,n))),r)}(this._delegate,(t=>e(new xT(this,t))))}batch(){return JI(this._delegate),new NT(new yT(this._delegate,(e=>pT(this._delegate,e))))}loadBundle(e){return function(e,t){const n=JI(e=OI(e,YI)),r=new QI;return CI(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){return nE(this._delegate,e).then((e=>e?new FT(this,e):null))}}class kT extends $E{constructor(e){super(),this.firestore=e}convertBytes(e){return new ET(new iE(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return PT.forKey(t,this.firestore,null)}}class xT{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new kT(e)}get(e){const t=qT(e);return this._delegate.get(t).then((e=>new LT(this._firestore,new tT(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=qT(e);return n?(wT("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=qT(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=qT(e);return this._delegate.delete(t),this}}class NT{constructor(e){this._delegate=e}set(e,t,n){const r=qT(e);return n?(wT("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=qT(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=qT(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class RT{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new nT(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new MT(this._firestore,n),null!==t&&void 0!==t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=RT.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new RT(e,new kT(e),t),r.set(t,i)),i}}RT.INSTANCES=new WeakMap;class PT{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kT(e)}static forPath(e,t,n){if(e.length%2!==0)throw new Vd("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(e.canonicalString()," has ").concat(e.length));return new PT(t,new jI(t._delegate,n,new af(e)))}static forKey(e,t,n){return new PT(t,new jI(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new jT(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jT(this.firestore,BI(this._delegate,e))}catch(t){throw AT(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=kt(e))instanceof jI&&WI(this._delegate,e)}set(e,t){t=wT("DocumentReference.set",t);try{return t?cT(this._delegate,e,t):cT(this._delegate,e)}catch(n){throw AT(n,"setDoc()","DocumentReference.set()")}}update(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?uT(this._delegate,e):uT(this._delegate,e,t,...r)}catch(s){throw AT(s,"updateDoc()","DocumentReference.update()")}}delete(){return pT(OI((e=this._delegate).firestore,YI),[new Bg(e._key,Ng.none())]);var e}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=DT(t),i=OT(t,(e=>new LT(this.firestore,new tT(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return dT(this._delegate,r,i)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?aT(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=OI(e,jI);const t=OI(e.firestore,YI);return TI(JI(t),e._key,{source:"server"}).then((n=>mT(t,e,n)))}(this._delegate):function(e){e=OI(e,jI);const t=OI(e.firestore,YI);return TI(JI(t),e._key).then((n=>mT(t,e,n)))}(this._delegate),t.then((e=>new LT(this.firestore,new tT(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new PT(this.firestore,e?this._delegate.withConverter(RT.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function AT(e,t,n){return e.message=e.message.replace(t,n),e}function DT(e){for(const t of e)if("object"===typeof t&&!TT(t))return t;return{}}function OT(e,t){var n,r;let i;return i=TT(e[0])?e[0]:TT(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class LT{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new PT(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return sT(this._delegate,e._delegate)}}class MT extends LT{data(e){const t=this._delegate.data(e);return this._delegate._converter||void 0!==t||Ld(),t}}class FT{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kT(e)}where(e,t,n){try{return new FT(this.firestore,jE(this._delegate,function(e,t,n){const r=t,i=ME("where",e);return qE._create(i,r,n)}(e,t,n)))}catch(r){throw AT(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new FT(this.firestore,jE(this._delegate,function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=ME("orderBy",e);return zE._create(n,t)}(e,t)))}catch(n){throw AT(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new FT(this.firestore,jE(this._delegate,(LI("limit",t=e),WE._create("limit",t,"F"))))}catch(t){throw AT(t,"limit()","Query.limit()")}var t}limitToLast(e){try{return new FT(this.firestore,jE(this._delegate,(LI("limitToLast",t=e),WE._create("limitToLast",t,"L"))))}catch(t){throw AT(t,"limitToLast()","Query.limitToLast()")}var t}startAt(){try{return new FT(this.firestore,jE(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KE._create("startAt",t,!0)}(...arguments)))}catch(e){throw AT(e,"startAt()","Query.startAt()")}}startAfter(){try{return new FT(this.firestore,jE(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KE._create("startAfter",t,!1)}(...arguments)))}catch(e){throw AT(e,"startAfter()","Query.startAfter()")}}endBefore(){try{return new FT(this.firestore,jE(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return HE._create("endBefore",t,!1)}(...arguments)))}catch(e){throw AT(e,"endBefore()","Query.endBefore()")}}endAt(){try{return new FT(this.firestore,jE(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return HE._create("endAt",t,!0)}(...arguments)))}catch(e){throw AT(e,"endAt()","Query.endAt()")}}isEqual(e){return KI(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?lT(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=OI(e,VI);const t=OI(e.firestore,YI),n=JI(t),r=new oT(t);return SI(n,e._query,{source:"server"}).then((n=>new rT(t,r,e,n)))}(this._delegate):function(e){e=OI(e,VI);const t=OI(e.firestore,YI),n=JI(t),r=new oT(t);return FE(e._query),SI(n,e._query).then((n=>new rT(t,r,e,n)))}(this._delegate),t.then((e=>new VT(this.firestore,new rT(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=DT(t),i=OT(t,(e=>new VT(this.firestore,new rT(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return dT(this._delegate,r,i)}withConverter(e){return new FT(this.firestore,e?this._delegate.withConverter(RT.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class UT{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new MT(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class VT{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new FT(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new MT(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new UT(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new MT(this._firestore,n))}))}isEqual(e){return sT(this._delegate,e._delegate)}}class jT extends FT{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new PT(this.firestore,e):null}doc(e){try{return new PT(this.firestore,void 0===e?zI(this._delegate):zI(this._delegate,e))}catch(t){throw AT(t,"doc()","CollectionReference.doc()")}}add(e){return hT(this._delegate,e).then((e=>new PT(this.firestore,e)))}isEqual(e){return WI(this._delegate,e._delegate)}withConverter(e){return new jT(this.firestore,e?this._delegate.withConverter(RT.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function qT(e){return OI(e,jI)}class BT{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._delegate=new sE(...t)}static documentId(){return new BT(of.keyField().canonicalString())}isEqual(e){return(e=kt(e))instanceof sE&&this._delegate._internalPath.isEqual(e._internalPath)}}class zT{constructor(e){this._delegate=e}static serverTimestamp(){const e=new vE("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new zT(e)}static delete(){const e=new gE("deleteField");return e._methodName="FieldValue.delete",new zT(e)}static arrayUnion(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new _E("arrayUnion",t)}(...arguments);return e._methodName="FieldValue.arrayUnion",new zT(e)}static arrayRemove(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new wE("arrayRemove",t)}(...arguments);return e._methodName="FieldValue.arrayRemove",new zT(e)}static increment(e){const t=new bE("increment",e);return t._methodName="FieldValue.increment",new zT(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const WT={Firestore:CT,GeoPoint:aE,Timestamp:ef,Blob:ET,Transaction:xT,WriteBatch:NT,DocumentReference:PT,DocumentSnapshot:LT,Query:FT,QueryDocumentSnapshot:MT,QuerySnapshot:VT,CollectionReference:jT,FieldPath:BT,FieldValue:zT,setLogLevel:function(e){var t;t=e,Nd.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!function(e){!function(e,t){e.INTERNAL.registerComponent(new xt("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},WT)))}(e,((e,t)=>new CT(e,t,new ST))),e.registerVersion("@firebase/firestore-compat","0.3.29")}(Qn);const KT="firebasestorage.googleapis.com",HT="storageBucket";class GT extends rt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(JT(e),"Firebase Storage: ".concat(t," (").concat(JT(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,GT.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return JT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var QT,YT;function JT(e){return"storage/"+e}function $T(){return new GT(QT.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function XT(){return new GT(QT.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ZT(){return new GT(QT.CANCELED,"User canceled the upload/download.")}function eS(){return new GT(QT.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function tS(e){return new GT(QT.INVALID_ARGUMENT,e)}function nS(){return new GT(QT.APP_DELETED,"The Firebase app was deleted.")}function rS(e){return new GT(QT.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function iS(e,t){return new GT(QT.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function sS(e){throw new GT(QT.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(QT||(QT={}));class oS{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=oS.makeFromUrl(e,t)}catch(i){return new oS(e,"")}if(""===n.path)return n;throw r=e,new GT(QT.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===KT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new oS(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new GT(QT.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class aS{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function lS(e){return"string"===typeof e||e instanceof String}function cS(e){return uS()&&e instanceof Blob}function uS(){return"undefined"!==typeof Blob}function hS(e,t,n,r){if(r<t)throw tS("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw tS("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function dS(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function fS(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function pS(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(YT||(YT={}));class mS{constructor(e,t,n,r,i,s,o,a,l,c,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new gS(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===YT.NO_ERROR,i=n.getStatus();if(!t||pS(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===YT.ABORT;return void e(!1,new gS(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new gS(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(s){r(s)}else if(null!==i){const e=$T();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?nS():ZT())}else{r(XT())}};this.canceled_?t(0,new gS(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return 2===a}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout((()=>{i=null,e(f,l())}),t)}function d(){s&&clearTimeout(s)}function f(e){if(c)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void u.call(null,e,...n);if(l()||o)return d(),void u.call(null,e,...n);let s;r<64&&(r*=2),1===a?(a=2,s=0):s=1e3*(r+Math.random()),h(s)}let p=!1;function m(e){p||(p=!0,d(),c||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class gS{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function yS(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function vS(){const e=yS();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(uS())return new Blob(n);throw new GT(QT.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function _S(e){if("undefined"===typeof atob)throw t="base-64",new GT(QT.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const wS={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class bS{constructor(e,t){this.data=e,this.contentType=t||null}}function IS(e,t){switch(e){case wS.RAW:return new bS(ES(t));case wS.BASE64:case wS.BASE64URL:return new bS(TS(e,t));case wS.DATA_URL:return new bS(function(e){const t=new SS(e);return t.base64?TS(wS.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw iS(wS.DATA_URL,"Malformed data URL.")}return ES(t)}(t.rest)}(t),new SS(t).contentType)}throw $T()}function ES(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function TS(e,t){switch(e){case wS.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw iS(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case wS.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw iS(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=_S(t)}catch(i){if(i.message.includes("polyfill"))throw i;throw iS(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class SS{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw iS(wS.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class CS{constructor(e,t){let n=0,r="";cS(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(cS(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new CS(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new CS(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(uS()){const e=t.map((e=>e instanceof CS?e.data_:e));return new CS(vS.apply(null,e))}{const e=t.map((e=>lS(e)?IS(wS.RAW,e).data:e.data_));let n=0;e.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return e.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new CS(r,!0)}}uploadData(){return this.data_}}function kS(e){let t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function xS(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function NS(e,t){return t}class RS{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||NS}}let PS=null;function AS(){if(PS)return PS;const e=[];e.push(new RS("bucket")),e.push(new RS("generation")),e.push(new RS("metageneration")),e.push(new RS("name","fullPath",!0));const t=new RS("name");t.xform=function(e,t){return function(e){return!lS(e)||e.length<2?e:xS(e)}(t)},e.push(t);const n=new RS("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new RS("timeCreated")),e.push(new RS("updated")),e.push(new RS("md5Hash",null,!0)),e.push(new RS("cacheControl",null,!0)),e.push(new RS("contentDisposition",null,!0)),e.push(new RS("contentEncoding",null,!0)),e.push(new RS("contentLanguage",null,!0)),e.push(new RS("contentType",null,!0)),e.push(new RS("metadata","customMetadata",!0)),PS=e,PS}function DS(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new oS(n,r);return t._makeStorageReference(i)}})}(r,e),r}function OS(e,t,n){const r=kS(t);if(null===r)return null;return DS(e,r,n)}function LS(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}const MS="prefixes",FS="items";function US(e,t,n){const r=kS(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[MS])for(const i of n[MS]){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new oS(t,n));r.prefixes.push(s)}if(n[FS])for(const i of n[FS]){const n=e._makeStorageReference(new oS(t,i.name));r.items.push(n)}return r}(e,t,r)}class VS{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function jS(e){if(!e)throw $T()}function qS(e,t){return function(n,r){const i=OS(e,r,t);return jS(null!==i),i}}function BS(e,t){return function(n,r){const i=OS(e,r,t);return jS(null!==i),function(e,t,n,r){const i=kS(t);if(null===i)return null;if(!lS(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.bucket,s=e.fullPath;return dS("/b/"+o(i)+"/o/"+o(s),n,r)+fS({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function zS(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new GT(QT.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new GT(QT.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new GT(QT.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new GT(QT.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function WS(e){const t=zS(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new GT(QT.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function KS(e,t,n){const r=dS(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new VS(r,"GET",qS(e,n),i);return s.errorHandler=WS(t),s}function HS(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=dS(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,l=new VS(o,"GET",function(e,t){return function(n,r){const i=US(e,t,r);return jS(null!==i),i}}(e,t.bucket),a);return l.urlParams=s,l.errorHandler=zS(t),l}function GS(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function QS(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const l=GS(t,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+LS(l,n)+"\r\n--"+a+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+a+"--",h=CS.getBlob(c,r,u);if(null===h)throw eS();const d={name:l.fullPath},f=dS(s,e.host,e._protocol),p=e.maxUploadRetryTime,m=new VS(f,"POST",qS(e,n),p);return m.urlParams=d,m.headers=o,m.body=h.uploadData(),m.errorHandler=zS(t),m}class YS{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function JS(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){jS(!1)}return jS(!!n&&-1!==(t||["active"]).indexOf(n)),n}const $S=262144;function XS(e,t,n,r,i,s,o,a){const l=new YS(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw new GT(QT.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const c=l.total-l.current;let u=c;i>0&&(u=Math.min(u,i));const h=l.current,d=h+u;let f="";f=0===u?"finalize":c===u?"upload, finalize":"upload";const p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":"".concat(l.current)},m=r.slice(h,d);if(null===m)throw eS();const g=t.maxUploadRetryTime,y=new VS(n,"POST",(function(e,n){const i=JS(e,["active","final"]),o=l.current+u,a=r.size();let c;return c="final"===i?qS(t,s)(e,n):null,new YS(o,a,"final"===i,c)}),g);return y.headers=p,y.body=m.uploadData(),y.progressCallback=a||null,y.errorHandler=zS(e),y}const ZS={STATE_CHANGED:"state_changed"},eC={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function tC(e){switch(e){case"running":case"pausing":case"canceling":return eC.RUNNING;case"paused":return eC.PAUSED;case"success":return eC.SUCCESS;case"canceled":return eC.CANCELED;default:return eC.ERROR}}class nC{constructor(e,t,n){const r=function(e){return"function"===typeof e}(e)||null!=t||null!=n;if(r)this.next=e,this.error=null!==t&&void 0!==t?t:void 0,this.complete=null!==n&&void 0!==n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function rC(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((()=>e(...n)))}}let iC=null;class sC{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=YT.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=YT.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=YT.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw sS("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw sS("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw sS("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw sS("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw sS("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class oC extends sC{initXhr(){this.xhr_.responseType="text"}}function aC(){return iC?iC():new oC}class lC{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=AS(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(QT.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(pS(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=XT()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(QT.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((t=>{let[n,r]=t;switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=GS(t,r,i),a={name:o.fullPath},l=dS(s,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},u=LS(o,n),h=e.maxUploadRetryTime,d=new VS(l,"POST",(function(e){let t;JS(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){jS(!1)}return jS(lS(t)),t}),h);return d.urlParams=a,d.headers=c,d.body=u,d.errorHandler=zS(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,aC,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new VS(n,"POST",(function(e){const t=JS(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(s){jS(!1)}n||jS(!1);const i=Number(n);return jS(!isNaN(i)),new YS(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=zS(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,aC,t,n);this._request=i,i.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=$S*this._chunkMultiplier,t=new YS(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=XS(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(a){return this._error=a,void this._transition("error")}const o=this._ref.storage._makeRequest(s,aC,r,i,!1);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*($S*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=KS(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,aC,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=QS(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,aC,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=ZT(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=tC(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new nC(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(tC(this._state)){case eC.SUCCESS:rC(this._resolve.bind(null,this.snapshot))();break;case eC.CANCELED:case eC.ERROR:rC(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(tC(this._state)){case eC.RUNNING:case eC.PAUSED:e.next&&rC(e.next.bind(e,this.snapshot))();break;case eC.SUCCESS:e.complete&&rC(e.complete.bind(e))();break;default:e.error&&rC(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class cC{constructor(e,t){this._service=e,this._location=t instanceof oS?t:oS.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new cC(e,t)}get root(){const e=new oS(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xS(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new oS(this._location.bucket,e);return new cC(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw rS(e)}}function uC(e){const t={prefixes:[],items:[]};return hC(e,t).then((()=>t))}async function hC(e,t,n){const r={pageToken:n},i=await dC(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await hC(e,t,i.nextPageToken)}function dC(e,t){null!=t&&"number"===typeof t.maxResults&&hS("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=HS(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,aC)}function fC(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=dS(t.fullServerUrl(),e.host,e._protocol),s=LS(n,r),o=e.maxOperationRetryTime,a=new VS(i,"PATCH",qS(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=WS(t),a}(e.storage,e._location,t,AS());return e.storage.makeRequestWithTokens(n,aC)}function pC(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=dS(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new VS(r,"GET",BS(e,n),i);return s.errorHandler=WS(t),s}(e.storage,e._location,AS());return e.storage.makeRequestWithTokens(t,aC).then((e=>{if(null===e)throw new GT(QT.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function mC(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=dS(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new VS(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=WS(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,aC)}function gC(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new oS(e._location.bucket,n);return new cC(e.storage,r)}function yC(e,t){if(e instanceof wC){const n=e;if(null==n._bucket)throw new GT(QT.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+HT+"' property when initializing the app?");const r=new cC(n,n._bucket);return null!=t?yC(r,t):r}return void 0!==t?gC(e,t):e}function vC(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof wC)return new cC(e,t);throw tS("To use ref(service, url), the first argument must be a Storage instance.")}return yC(e,t)}function _C(e,t){const n=null===t||void 0===t?void 0:t[HT];return null==n?null:oS.makeFromBucketSpec(n,e)}class wC{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=KT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?oS.makeFromBucketSpec(r,this._host):_C(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=oS.makeFromBucketSpec(this._url,e):this._bucket=_C(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new cC(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new aS(nS());{const s=function(e,t,n,r,i,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const a=fS(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new mS(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const bC="@firebase/storage",IC="0.12.4",EC="storage";function TC(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new lC(e,new CS(t),n)}(e=kt(e),t,n)}function SC(e){return function(e){e._throwIfRoot("getMetadata");const t=KS(e.storage,e._location,AS());return e.storage.makeRequestWithTokens(t,aC)}(e=kt(e))}function CC(e,t){return vC(e=kt(e),t)}function kC(e,t,n){!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:He(i,e.app.options.projectId))}(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}function xC(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new wC(r,i,s,n,En)}pn(new xt(EC,xC,"PUBLIC").setMultipleInstances(!0)),Nn(bC,IC,""),Nn(bC,IC,"esm2017");class NC{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class RC{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new NC(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new NC(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"===typeof t?e=>t(new NC(e,this,this._ref)):{next:t.next?e=>t.next(new NC(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class PC{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new AC(e,this._service)))}get items(){return this._delegate.items.map((e=>new AC(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}class AC{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return gC(e,t)}(this._delegate,e);return new AC(t,this.storage)}get root(){return new AC(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new AC(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new RC(TC(this._delegate,e,t),this)}putString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wS.RAW,n=arguments.length>2?arguments[2]:void 0;this._throwIfRoot("putString");const r=IS(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new RC(new lC(this._delegate,new CS(r.data,!0),i),this)}listAll(){return function(e){return uC(e=kt(e))}(this._delegate).then((e=>new PC(e,this.storage)))}list(e){return function(e,t){return dC(e=kt(e),t)}(this._delegate,e||void 0).then((e=>new PC(e,this.storage)))}getMetadata(){return SC(this._delegate)}updateMetadata(e){return function(e,t){return fC(e=kt(e),t)}(this._delegate,e)}getDownloadURL(){return function(e){return pC(e=kt(e))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function(e){return mC(e=kt(e))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw rS(e)}}class DC{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(OC(e))throw tS("ref() expected a child path but got a URL, use refFromURL instead.");return new AC(CC(this._delegate,e),this)}refFromURL(e){if(!OC(e))throw tS("refFromURL() expected a full URL but got a child path, use ref() instead.");try{oS.makeFromUrl(e,this._delegate.host)}catch(t){throw tS("refFromUrl() expected a valid full URL but got an invalid one.")}return new AC(CC(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};kC(this._delegate,e,t,n)}}function OC(e){return/^[A-Za-z]+:\/\//.test(e)}function LC(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("storage").getImmediate({identifier:n});return new DC(r,i)}!function(e){const t={TaskState:eC,TaskEvent:ZS,StringFormat:wS,Storage:DC,Reference:AC};e.INTERNAL.registerComponent(new xt("storage-compat",LC,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.7")}(Qn);const MC="@firebase/database",FC="1.0.4";let UC="";function VC(e){UC=e}class jC{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),at(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:ot(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class qC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ct(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const BC=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new jC(t)}}catch(t){}return new qC},zC=BC("localStorage"),WC=BC("sessionStorage"),KC=new Ut("@firebase/database"),HC=function(){let e=1;return function(){return e++}}(),GC=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,De(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new vt;n.update(t);const r=n.digest();return Me.encodeByteArray(r)},QC=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=QC.apply(null,n):e+="object"===typeof n?at(n):n,e+=" "}return e};let YC=null,JC=!0;const $C=function(e,t){De(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(KC.logLevel=Dt.VERBOSE,YC=KC.log.bind(KC),t&&WC.set("logging_enabled",!0)):"function"===typeof e?YC=e:(YC=null,WC.remove("logging_enabled"))},XC=function(){if(!0===JC&&(JC=!1,null===YC&&!0===WC.get("logging_enabled")&&$C(!0)),YC){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=QC.apply(null,t);YC(r)}},ZC=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];XC(e,...n)}},ek=function(){const e="FIREBASE INTERNAL ERROR: "+QC(...arguments);KC.error(e)},tk=function(){const e="FIREBASE FATAL ERROR: ".concat(QC(...arguments));throw KC.error(e),new Error(e)},nk=function(){const e="FIREBASE WARNING: "+QC(...arguments);KC.warn(e)},rk=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},ik="[MIN_NAME]",sk="[MAX_NAME]",ok=function(e,t){if(e===t)return 0;if(e===ik||t===sk)return-1;if(t===ik||e===sk)return 1;{const n=pk(e),r=pk(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},ak=function(e,t){return e===t?0:e<t?-1:1},lk=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+at(t))},ck=function(e){if("object"!==typeof e||null===e)return at(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=at(t[r]),n+=":",n+=ck(e[t[r]]);return n+="}",n},uk=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function hk(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const dk=function(e){De(!rk(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const fk=new RegExp("^-?(0*)\\d{1,10}$"),pk=function(e){if(fk.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},mk=function(e){try{e()}catch(t){setTimeout((()=>{const e=t.stack||"";throw nk("Exception was thrown by user callback.",e),t}),Math.floor(0))}},gk=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class yk{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){nk('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class vk{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(XC("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nk(e)}}class _k{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}_k.OWNER="owner";const wk="5",bk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ik="ac",Ek="websocket",Tk="long_polling";class Sk{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=zC.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&zC.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function Ck(e,t,n){let r;if(De("string"===typeof t,"typeof type must == string"),De("object"===typeof n,"typeof params must == object"),t===Ek)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Tk)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return hk(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class kk{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ct(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return qe(void 0,this.counters_)}}const xk={},Nk={};function Rk(e){const t=e.toString();return xk[t]||(xk[t]=new kk),xk[t]}class Pk{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&mk((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Ak="start";class Dk{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ZC(e),this.stats_=Rk(t),this.urlFn=e=>(this.appCheckToken&&(e[Ik]=this.appCheckToken),Ck(t,Tk,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Pk(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(et()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ok((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Ak)n.id=s,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[Ak]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=wk,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Ik]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&bk.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Dk.forceAllow_=!0}static forceDisallow(){Dk.forceDisallow_=!0}static isAvailable(){return!et()&&(!!Dk.forceAllow_||!Dk.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=at(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Ue(t),r=uk(n,1840);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(et())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=at(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Ok{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,et())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=HC(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Ok.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(i){XC("frame writing exception"),i.stack&&XC(i.stack),XC(i)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||XC("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){et()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{XC("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let Lk=null;"undefined"!==typeof MozWebSocket?Lk=MozWebSocket:"undefined"!==typeof WebSocket&&(Lk=WebSocket);class Mk{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ZC(this.connId),this.stats_=Rk(t),this.connURL=Mk.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=wk,!et()&&"undefined"!==typeof location&&location.hostname&&bk.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[Ik]=r),i&&(s.p=i),Ck(e,Ek,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,zC.set("previous_websocket_failure",!0);try{let e;if(et()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(wk,"/").concat(UC,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new Lk(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Mk.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Lk&&!Mk.forceDisallow_}static previouslyFailed(){return zC.isInMemoryStorage||!0===zC.get("previous_websocket_failure")}markConnectionHealthy(){zC.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=ot(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(De(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=at(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=uk(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Mk.responsesRequiredToBeHealthy=2,Mk.healthyTimeout=3e4;class Fk{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Dk,Mk]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Mk&&Mk.isAvailable();let n=t&&!Mk.previouslyFailed();if(e.webSocketOnly&&(t||nk("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Mk];else{const e=this.transports_=[];for(const t of Fk.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Fk.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Fk.globalTransportInitialized_=!1;class Uk{constructor(e,t,n,r,i,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ZC("c:"+this.id+":"),this.transportManager_=new Fk(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=gk((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=lk("t",e),n=lk("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=lk("t",e),n=lk("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=lk("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?ek("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ek("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),wk!==n&&nk("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),gk((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):gk((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(zC.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Vk{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class jk{constructor(e){this.allowedEvents_=e,this.listeners_={},De(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){De(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class qk extends jk{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Qe()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new qk}getInitialEvent(e){return De("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Bk=32,zk=768;class Wk{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Kk(){return new Wk("")}function Hk(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Gk(e){return e.pieces_.length-e.pieceNum_}function Qk(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Wk(e.pieces_,t)}function Yk(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Jk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function $k(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Wk(t,0)}function Xk(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Wk)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Wk(n,0)}function Zk(e){return e.pieceNum_>=e.pieces_.length}function ex(e,t){const n=Hk(e),r=Hk(t);if(null===n)return t;if(n===r)return ex(Qk(e),Qk(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function tx(e,t){const n=Jk(e,0),r=Jk(t,0);for(let i=0;i<n.length&&i<r.length;i++){const e=ok(n[i],r[i]);if(0!==e)return e}return n.length===r.length?0:n.length<r.length?-1:1}function nx(e,t){if(Gk(e)!==Gk(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function rx(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Gk(e)>Gk(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class ix{constructor(e,t){this.errorPrefix_=t,this.parts_=Jk(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Ct(this.parts_[n]);sx(this)}}function sx(e){if(e.byteLength_>zk)throw new Error(e.errorPrefix_+"has a key path longer than "+zk+" bytes ("+e.byteLength_+").");if(e.parts_.length>Bk)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Bk+") or object contains a cycle "+ox(e))}function ox(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class ax extends jk{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new ax}getInitialEvent(e){return De("visible"===e,"Unknown event type: "+e),[this.visible_]}}const lx=1e3;class cx extends Vk{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=cx.nextPersistentConnectionId_++,this.log_=ZC("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=lx,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!et())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ax.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&qk.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(at(i)),De(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Ke,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),De(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),De(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;cx.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&ct(e,"w")){const n=ut(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();nk("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=lt(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=lt(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),De(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+at(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):ek("Unrecognized action received from server: "+at(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){De(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=lx,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=lx,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=lx),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+cx.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){De(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?XC("getToken() completed but was canceled"):(XC("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new Uk(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{nk(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(ek){this.log_("Failed to get token: "+ek),s||(this.repoInfo_.nodeAdmin&&nk(ek),a())}}}interrupt(e){XC("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){XC("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ht(this.interruptReasons_)&&(this.reconnectDelay_=lx,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>ck(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Wk(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){XC("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){XC("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";et()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+UC.replace(/\./g,"-")]=1,Qe()?e["framework.cordova"]=1:Xe()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=qk.getInstance().currentlyOnline();return ht(this.interruptReasons_)&&e}}cx.nextPersistentConnectionId_=0,cx.nextConnectionId_=0;class ux{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ux(e,t)}}class hx{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new ux(ik,e),r=new ux(ik,t);return 0!==this.compare(n,r)}minPost(){return ux.MIN}}let dx;class fx extends hx{static get __EMPTY_NODE(){return dx}static set __EMPTY_NODE(e){dx=e}compare(e,t){return ok(e.name,t.name)}isDefinedOn(e){throw Oe("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ux.MIN}maxPost(){return new ux(sk,dx)}makePost(e,t){return De("string"===typeof e,"KeyIndex indexValue must always be a string."),new ux(e,dx)}toString(){return".key"}}const px=new fx;class mx{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class gx{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:gx.RED,this.left=null!=r?r:yx.EMPTY_NODE,this.right=null!=i?i:yx.EMPTY_NODE}copy(e,t,n,r,i){return new gx(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return yx.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return yx.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,gx.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,gx.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}gx.RED=!0,gx.BLACK=!1;class yx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yx.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new yx(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,gx.BLACK,null,null))}remove(e){return new yx(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,gx.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new mx(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new mx(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new mx(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new mx(this.root_,null,this.comparator_,!0,e)}}function vx(e,t){return ok(e.name,t.name)}function _x(e,t){return ok(e,t)}let wx;yx.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new gx(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const bx=function(e){return"number"===typeof e?"number:"+dk(e):"string:"+e},Ix=function(e){if(e.isLeafNode()){const t=e.val();De("string"===typeof t||"number"===typeof t||"object"===typeof t&&ct(t,".sv"),"Priority must be a string or number.")}else De(e===wx||e.isEmpty(),"priority of unexpected type.");De(e===wx||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Ex,Tx,Sx;class Cx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cx.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,De(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ix(this.priorityNode_)}static set __childrenNodeConstructor(e){Ex=e}static get __childrenNodeConstructor(){return Ex}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Cx(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Cx.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Zk(e)?this:".priority"===Hk(e)?this.priorityNode_:Cx.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Cx.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Hk(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(De(".priority"!==n||1===Gk(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Cx.__childrenNodeConstructor.EMPTY_NODE.updateChild(Qk(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+bx(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?dk(this.value_):this.value_,this.lazyHash_=GC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Cx.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Cx.__childrenNodeConstructor?-1:(De(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Cx.VALUE_TYPE_ORDER.indexOf(t),i=Cx.VALUE_TYPE_ORDER.indexOf(n);return De(r>=0,"Unknown leaf type: "+t),De(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Cx.VALUE_TYPE_ORDER=["object","boolean","number","string"];const kx=new class extends hx{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?ok(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ux.MIN}maxPost(){return new ux(sk,new Cx("[PRIORITY-POST]",Sx))}makePost(e,t){const n=Tx(e);return new ux(t,new Cx("[PRIORITY-POST]",n))}toString(){return".priority"}},xx=Math.log(2);class Nx{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/xx,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Rx=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new gx(a,o.node,gx.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=i(t,l),u=i(l+1,r);return o=e[l],a=n?n(o):o,new gx(a,o.node,gx.BLACK,c,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const c=i(s+1,a),u=e[s],h=n?n(u):u;l(new gx(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,gx.BLACK):(a(r,gx.BLACK),a(r,gx.RED))}return s}(new Nx(e.length));return new yx(r||t,s)};let Px;const Ax={};class Dx{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return De(Ax&&kx,"ChildrenNode.ts has not been loaded"),Px=Px||new Dx({".priority":Ax},{".priority":kx}),Px}get(e){const t=ut(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof yx?t:null}hasIndex(e){return ct(this.indexSet_,e.toString())}addIndex(e,t){De(e!==px,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(ux.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?Rx(n,e.getCompare()):Ax;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=s,new Dx(c,l)}addToIndexes(e,t){const n=dt(this.indexes_,((n,r)=>{const i=ut(this.indexSet_,r);if(De(i,"Missing index implementation for "+r),n===Ax){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(ux.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Rx(n,i.getCompare())}return Ax}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new ux(e.name,r))),i.insert(e,e.node)}}));return new Dx(n,this.indexSet_)}removeFromIndexes(e,t){const n=dt(this.indexes_,(n=>{if(n===Ax)return n;{const r=t.get(e.name);return r?n.remove(new ux(e.name,r)):n}}));return new Dx(n,this.indexSet_)}}let Ox;class Lx{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ix(this.priorityNode_),this.children_.isEmpty()&&De(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ox||(Ox=new Lx(new yx(_x),null,Dx.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ox}updatePriority(e){return this.children_.isEmpty()?this:new Lx(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Ox:t}}getChild(e){const t=Hk(e);return null===t?this:this.getImmediateChild(t).getChild(Qk(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(De(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new ux(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?Ox:this.priorityNode_;return new Lx(r,s,i)}}updateChild(e,t){const n=Hk(e);if(null===n)return t;{De(".priority"!==Hk(e)||1===Gk(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Qk(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(kx,((s,o)=>{t[s]=o.val(e),n++,i&&Lx.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+bx(this.getPriority().val())+":"),this.forEachChild(kx,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":GC(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new ux(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ux(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ux(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,ux.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,ux.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Mx?-1:0}withIndex(e){if(e===px||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Lx(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===px||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(kx),n=t.getIterator(kx);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===px?null:this.indexMap_.get(e.toString())}}Lx.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Mx=new class extends Lx{constructor(){super(new yx(_x),Lx.EMPTY_NODE,Dx.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Lx.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(ux,{MIN:{value:new ux(ik,Lx.EMPTY_NODE)},MAX:{value:new ux(sk,Mx)}}),fx.__EMPTY_NODE=Lx.EMPTY_NODE,Cx.__childrenNodeConstructor=Lx,wx=Mx,function(e){Sx=e}(Mx);const Fx=!0;function Ux(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return Lx.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),De(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Cx(e,Ux(t))}if(e instanceof Array||!Fx){let n=Lx.EMPTY_NODE;return hk(e,((t,r)=>{if(ct(e,t)&&"."!==t.substring(0,1)){const e=Ux(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Ux(t))}{const n=[];let r=!1;if(hk(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Ux(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new ux(e,i)))}})),0===n.length)return Lx.EMPTY_NODE;const i=Rx(n,vx,(e=>e.name),_x);if(r){const e=Rx(n,kx.getCompare());return new Lx(i,Ux(t),new Dx({".priority":e},{".priority":kx}))}return new Lx(i,Ux(t),Dx.Default)}}!function(e){Tx=e}(Ux);class Vx extends hx{constructor(e){super(),this.indexPath_=e,De(!Zk(e)&&".priority"!==Hk(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?ok(e.name,t.name):i}makePost(e,t){const n=Ux(e),r=Lx.EMPTY_NODE.updateChild(this.indexPath_,n);return new ux(t,r)}maxPost(){const e=Lx.EMPTY_NODE.updateChild(this.indexPath_,Mx);return new ux(sk,e)}toString(){return Jk(this.indexPath_,0).join("/")}}const jx=new class extends hx{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?ok(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ux.MIN}maxPost(){return ux.MAX}makePost(e,t){const n=Ux(e);return new ux(t,n)}toString(){return".value"}};function qx(e){return{type:"value",snapshotNode:e}}function Bx(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function zx(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Wx(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Kx{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){De(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(zx(t,o)):De(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(Bx(t,n)):s.trackChildChange(Wx(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(kx,((e,r)=>{t.hasChild(e)||n.trackChildChange(zx(e,r))})),t.isLeafNode()||t.forEachChild(kx,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Wx(t,r,i))}else n.trackChildChange(Bx(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Lx.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Hx{constructor(e){this.indexedFilter_=new Kx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Hx.getStartPost_(e),this.endPost_=Hx.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new ux(t,n))||(n=Lx.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=Lx.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Lx.EMPTY_NODE);const i=this;return t.forEachChild(kx,((e,t)=>{i.matches(new ux(e,t))||(r=r.updateImmediateChild(e,Lx.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Gx{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Hx(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new ux(t,n))||(n=Lx.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=Lx.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=Lx.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(Lx.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,Lx.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;De(o.numChildren()===this.limit_,"");const a=new ux(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Wx(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(zx(t,e));const n=o.updateImmediateChild(t,Lx.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(Bx(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,a)>=0?(null!=i&&(i.trackChildChange(zx(l.name,l.node)),i.trackChildChange(Bx(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,Lx.EMPTY_NODE)):e}}class Qx{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=kx}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return De(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return De(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ik}hasEnd(){return this.endSet_}getIndexEndValue(){return De(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return De(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:sk}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return De(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===kx}copy(){const e=new Qx;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Yx(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Jx(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function $x(e,t){const n=e.copy();return n.index_=t,n}function Xx(e){const t={};if(e.isDefault())return t;let n;if(e.index_===kx?n="$priority":e.index_===jx?n="$value":e.index_===px?n="$key":(De(e.index_ instanceof Vx,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=at(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=at(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+at(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=at(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+at(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Zx(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==kx&&(t.i=e.index_.toString()),t}class eN extends Vk{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=ZC("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(De(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=eN.getListenId_(e,n),o={};this.listens_[s]=o;const a=Xx(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),ut(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=eN.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Xx(e._queryParams),n=e._path.toString(),r=new Ke;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((r=>{let[i,s]=r;i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+mt(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=ot(a.responseText)}catch(e){nk("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&nk("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()}))}}class tN{constructor(){this.rootNode_=Lx.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function nN(){return{value:null,children:new Map}}function rN(e,t,n){if(Zk(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Hk(t);e.children.has(r)||e.children.set(r,nN());rN(e.children.get(r),t=Qk(t),n)}}function iN(e,t){if(Zk(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(kx,((t,n)=>{rN(e,new Wk(t),n)})),iN(e,t)}}if(e.children.size>0){const n=Hk(t);if(t=Qk(t),e.children.has(n)){iN(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function sN(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{sN(r,new Wk(t.toString()+"/"+e),n)}))}class oN{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&hk(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class aN{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new oN(e);const n=1e4+2e4*Math.random();gk(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;hk(e,((e,r)=>{r>0&&ct(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),gk(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var lN;function cN(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(lN||(lN={}));class uN{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=lN.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Zk(this.path)){if(null!=this.affectedTree.value)return De(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Wk(e));return new uN(Kk(),t,this.revert)}}return De(Hk(this.path)===e,"operationForChild called for unrelated child."),new uN(Qk(this.path),this.affectedTree,this.revert)}}class hN{constructor(e,t){this.source=e,this.path=t,this.type=lN.LISTEN_COMPLETE}operationForChild(e){return Zk(this.path)?new hN(this.source,Kk()):new hN(this.source,Qk(this.path))}}class dN{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=lN.OVERWRITE}operationForChild(e){return Zk(this.path)?new dN(this.source,Kk(),this.snap.getImmediateChild(e)):new dN(this.source,Qk(this.path),this.snap)}}class fN{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=lN.MERGE}operationForChild(e){if(Zk(this.path)){const t=this.children.subtree(new Wk(e));return t.isEmpty()?null:t.value?new dN(this.source,Kk(),t.value):new fN(this.source,Kk(),t)}return De(Hk(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fN(this.source,Qk(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class pN{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Zk(e))return this.isFullyInitialized()&&!this.filtered_;const t=Hk(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class mN{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function gN(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Oe("Should only compare child_ events.");const r=new ux(t.childName,t.snapshotNode),i=new ux(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function yN(e,t){return{eventCache:e,serverCache:t}}function vN(e,t,n,r){return yN(new pN(t,n,r),e.serverCache)}function _N(e,t,n,r){return yN(e.eventCache,new pN(t,n,r))}function wN(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function bN(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let IN;class EN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(IN||(IN=new yx(ak)),IN);this.value=e,this.children=t}static fromObject(e){let t=new EN(null);return hk(e,((e,n)=>{t=t.set(new Wk(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Kk(),value:this.value};if(Zk(e))return null;{const n=Hk(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Qk(e),t);if(null!=i){return{path:Xk(new Wk(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Zk(e))return this;{const t=Hk(e),n=this.children.get(t);return null!==n?n.subtree(Qk(e)):new EN(null)}}set(e,t){if(Zk(e))return new EN(t,this.children);{const n=Hk(e),r=(this.children.get(n)||new EN(null)).set(Qk(e),t),i=this.children.insert(n,r);return new EN(this.value,i)}}remove(e){if(Zk(e))return this.children.isEmpty()?new EN(null):new EN(null,this.children);{const t=Hk(e),n=this.children.get(t);if(n){const r=n.remove(Qk(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new EN(null):new EN(this.value,i)}return this}}get(e){if(Zk(e))return this.value;{const t=Hk(e),n=this.children.get(t);return n?n.get(Qk(e)):null}}setTree(e,t){if(Zk(e))return t;{const n=Hk(e),r=(this.children.get(n)||new EN(null)).setTree(Qk(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new EN(this.value,i)}}fold(e){return this.fold_(Kk(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Xk(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Kk(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Zk(e))return null;{const r=Hk(e),i=this.children.get(r);return i?i.findOnPath_(Qk(e),Xk(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Kk(),t)}foreachOnPath_(e,t,n){if(Zk(e))return this;{this.value&&n(t,this.value);const r=Hk(e),i=this.children.get(r);return i?i.foreachOnPath_(Qk(e),Xk(t,r),n):new EN(null)}}foreach(e){this.foreach_(Kk(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Xk(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class TN{constructor(e){this.writeTree_=e}static empty(){return new TN(new EN(null))}}function SN(e,t,n){if(Zk(t))return new TN(new EN(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=ex(i,t);return s=s.updateChild(o,n),new TN(e.writeTree_.set(i,s))}{const r=new EN(n),i=e.writeTree_.setTree(t,r);return new TN(i)}}}function CN(e,t,n){let r=e;return hk(n,((e,n)=>{r=SN(r,Xk(t,e),n)})),r}function kN(e,t){if(Zk(t))return TN.empty();{const n=e.writeTree_.setTree(t,new EN(null));return new TN(n)}}function xN(e,t){return null!=NN(e,t)}function NN(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ex(n.path,t)):null}function RN(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(kx,((e,n)=>{t.push(new ux(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new ux(e,n.value))})),t}function PN(e,t){if(Zk(t))return e;{const n=NN(e,t);return new TN(null!=n?new EN(n):e.writeTree_.subtree(t))}}function AN(e){return e.writeTree_.isEmpty()}function DN(e,t){return ON(Kk(),e.writeTree_,t)}function ON(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(De(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=ON(Xk(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Xk(e,".priority"),r)),n}}function LN(e,t){return QN(t,e)}function MN(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));De(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&FN(t,r.path)?i=!1:rx(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=VN(e.allWrites,UN,Kk()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=kN(e.visibleWrites,r.path);else{hk(r.children,(t=>{e.visibleWrites=kN(e.visibleWrites,Xk(r.path,t))}))}return!0}return!1}function FN(e,t){if(e.snap)return rx(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&rx(Xk(e.path,n),t))return!0;return!1}function UN(e){return e.visible}function VN(e,t,n){let r=TN.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)rx(n,e)?(t=ex(n,e),r=SN(r,t,s.snap)):rx(e,n)&&(t=ex(e,n),r=SN(r,Kk(),s.snap.getChild(t)));else{if(!s.children)throw Oe("WriteRecord should have .snap or .children");if(rx(n,e))t=ex(n,e),r=CN(r,t,s.children);else if(rx(e,n))if(t=ex(e,n),Zk(t))r=CN(r,Kk(),s.children);else{const e=ut(s.children,Hk(t));if(e){const n=e.getChild(Qk(t));r=SN(r,Kk(),n)}}}}}return r}function jN(e,t,n,r,i){if(r||i){const s=PN(e.visibleWrites,t);if(!i&&AN(s))return n;if(i||null!=n||xN(s,Kk())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(rx(e.path,t)||rx(t,e.path))};return DN(VN(e.allWrites,s,t),n||Lx.EMPTY_NODE)}return null}{const r=NN(e.visibleWrites,t);if(null!=r)return r;{const r=PN(e.visibleWrites,t);if(AN(r))return n;if(null!=n||xN(r,Kk())){return DN(r,n||Lx.EMPTY_NODE)}return null}}}function qN(e,t,n,r){return jN(e.writeTree,e.treePath,t,n,r)}function BN(e,t){return function(e,t,n){let r=Lx.EMPTY_NODE;const i=NN(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(kx,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=PN(e.visibleWrites,t);return n.forEachChild(kx,((e,t)=>{const n=DN(PN(i,new Wk(e)),t);r=r.updateImmediateChild(e,n)})),RN(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return RN(PN(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function zN(e,t,n,r){return function(e,t,n,r,i){De(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Xk(t,n);if(xN(e.visibleWrites,s))return null;{const t=PN(e.visibleWrites,s);return AN(t)?i.getChild(n):DN(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function WN(e,t){return function(e,t){return NN(e.visibleWrites,t)}(e.writeTree,Xk(e.treePath,t))}function KN(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const l=PN(e.visibleWrites,t),c=NN(l,Kk());if(null!=c)a=c;else{if(null==n)return[];a=DN(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function HN(e,t,n){return function(e,t,n,r){const i=Xk(t,n),s=NN(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return DN(PN(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function GN(e,t){return QN(Xk(e.treePath,t),e.writeTree)}function QN(e,t){return{treePath:e,writeTree:t}}class YN{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;De("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),De(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Wx(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,zx(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Bx(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Oe("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Wx(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const JN=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class $N{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new pN(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return HN(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:bN(this.viewCache_),i=KN(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function XN(e,t,n,r,i){const s=new YN;let o,a;if(n.type===lN.OVERWRITE){const l=n;l.source.fromUser?o=tR(e,t,l.path,l.snap,r,i,s):(De(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!Zk(l.path),o=eR(e,t,l.path,l.snap,r,i,a,s))}else if(n.type===lN.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,l)=>{const c=Xk(n,r);nR(t,Hk(c))&&(a=tR(e,a,c,l,i,s,o))})),r.foreach(((r,l)=>{const c=Xk(n,r);nR(t,Hk(c))||(a=tR(e,a,c,l,i,s,o))})),a}(e,t,l.path,l.children,r,i,s):(De(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=iR(e,t,l.path,l.children,r,i,a,s))}else if(n.type===lN.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=WN(r,n))return t;{const a=new $N(r,t,i),l=t.eventCache.getNode();let c;if(Zk(n)||".priority"===Hk(n)){let n;if(t.serverCache.isFullyInitialized())n=qN(r,bN(t));else{const e=t.serverCache.getNode();De(e instanceof Lx,"serverChildren would be complete if leaf node"),n=BN(r,e)}c=e.filter.updateFullNode(l,n,s)}else{const i=Hk(n);let u=HN(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,Qk(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,Lx.EMPTY_NODE,Qk(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=qN(r,bN(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=WN(r,Kk()),vN(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=WN(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(Zk(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return eR(e,t,n,l.getNode().getChild(n),i,s,a,o);if(Zk(n)){let r=new EN(null);return l.getNode().forEachChild(px,((e,t)=>{r=r.set(new Wk(e),t)})),iR(e,t,n,r,i,s,a,o)}return t}{let c=new EN(null);return r.foreach(((e,t)=>{const r=Xk(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),iR(e,t,n,c,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==lN.LISTEN_COMPLETE)throw Oe("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=_N(t,s.getNode(),s.isFullyInitialized()||Zk(n),s.isFiltered());return ZN(e,o,n,r,JN,i)}(e,t,n.path,r,s)}const l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=wN(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(qx(wN(t)))}}(t,o,l),{viewCache:o,changes:l}}function ZN(e,t,n,r,i,s){const o=t.eventCache;if(null!=WN(r,n))return t;{let a,l;if(Zk(n))if(De(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=bN(t),i=BN(r,n instanceof Lx?n:Lx.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=qN(r,bN(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=Hk(n);if(".priority"===c){De(1===Gk(n),"Can't have a priority with additional path components");const i=o.getNode();l=t.serverCache.getNode();const s=zN(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=Qk(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=zN(r,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else h=HN(r,c,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),c,h,u,i,s):o.getNode()}}return vN(t,a,o.isFullyInitialized()||Zk(n),e.filter.filtersNodes())}}function eR(e,t,n,r,i,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(Zk(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=Hk(n);if(!l.isCompleteForPath(n)&&Gk(n)>1)return t;const i=Qk(n),s=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,i,JN,null)}const h=_N(t,c,l.isFullyInitialized()||Zk(n),u.filtersNodes());return ZN(e,h,n,i,new $N(i,h,s),a)}function tR(e,t,n,r,i,s,o){const a=t.eventCache;let l,c;const u=new $N(i,t,s);if(Zk(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=vN(t,c,!0,e.filter.filtersNodes());else{const i=Hk(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=vN(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=Qk(n),c=a.getNode().getImmediateChild(i);let h;if(Zk(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Yk(s)&&e.getChild($k(s)).isEmpty()?e:e.updateChild(s,r):Lx.EMPTY_NODE}if(c.equals(h))l=t;else{l=vN(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function nR(e,t){return e.eventCache.isCompleteForChild(t)}function rR(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function iR(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Zk(n)?r:new EN(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const l=rR(0,t.serverCache.getNode().getImmediateChild(n),r);c=eR(e,c,new Wk(n),l,i,s,o,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=rR(0,t.serverCache.getNode().getImmediateChild(n),r);c=eR(e,c,new Wk(n),l,i,s,o,a)}})),c}class sR{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Kx(n.getIndex()),i=(s=n).loadsAllData()?new Kx(s.getIndex()):s.hasLimit()?new Gx(s):new Hx(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(Lx.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(Lx.EMPTY_NODE,a.getNode(),null),u=new pN(l,o.isFullyInitialized(),r.filtersNodes()),h=new pN(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=yN(h,u),this.eventGenerator_=new mN(this.query_)}get query(){return this.query_}}function oR(e,t){const n=bN(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Zk(t)&&!n.getImmediateChild(Hk(t)).isEmpty())?n.getChild(t):null}function aR(e){return 0===e.eventRegistrations_.length}function lR(e,t,n){const r=[];if(n){De(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function cR(e,t,n,r){t.type===lN.MERGE&&null!==t.source.queryId&&(De(bN(e.viewCache_),"We should always have a full cache before handling merges"),De(wN(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=XN(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,De(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),De(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),De(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,uR(e,s.changes,s.viewCache.eventCache.getNode(),null)}function uR(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),gN(e,i,"child_removed",t,r,n),gN(e,i,"child_added",t,r,n),gN(e,i,"child_moved",s,r,n),gN(e,i,"child_changed",t,r,n),gN(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let hR,dR;class fR{constructor(){this.views=new Map}}function pR(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return De(null!=s,"SyncTree gave us an op for an invalid query."),cR(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(cR(s,t,n,r));return i}}function mR(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=qN(n,i?r:null),s=!1;e?s=!0:r instanceof Lx?(e=BN(n,r),s=!1):(e=Lx.EMPTY_NODE,s=!1);const o=yN(new pN(e,s,!1),new pN(r,i,!1));return new sR(t,o)}return o}function gR(e,t,n,r,i,s){const o=mR(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(kx,((e,t)=>{r.push(Bx(e,t))}));return n.isFullyInitialized()&&r.push(qx(n.getNode())),uR(e,r,n.getNode(),t)}(o,n)}function yR(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=IR(e);if("default"===i)for(const[l,c]of e.views.entries())o=o.concat(lR(c,n,r)),aR(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const t=e.views.get(i);t&&(o=o.concat(lR(t,n,r)),aR(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!IR(e)&&s.push(new(De(hR,"Reference.ts has not been loaded"),hR)(t._repo,t._path)),{removed:s,events:o}}function vR(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function _R(e,t){let n=null;for(const r of e.views.values())n=n||oR(r,t);return n}function wR(e,t){if(t._queryParams.loadsAllData())return ER(e);{const n=t._queryIdentifier;return e.views.get(n)}}function bR(e,t){return null!=wR(e,t)}function IR(e){return null!=ER(e)}function ER(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let TR=1;class SR{constructor(e){this.listenProvider_=e,this.syncPointTree_=new EN(null),this.pendingWriteTree_={visibleWrites:TN.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function CR(e,t,n,r,i){return function(e,t,n,r,i){De(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=SN(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?LR(e,new dN({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function kR(e,t,n,r){!function(e,t,n,r){De(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=CN(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=EN.fromObject(n);return LR(e,new fN({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function xR(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(MN(e.pendingWriteTree_,t)){let t=new EN(null);return null!=r.snap?t=t.set(Kk(),!0):hk(r.children,(e=>{t=t.set(new Wk(e),!0)})),LR(e,new uN(r.path,t,n))}return[]}function NR(e,t,n){return LR(e,new dN({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function RR(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||bR(o,t))){const l=yR(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const n=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>IR(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&IR(t)){return[ER(t)]}{let e=[];return t&&(e=vR(t)),hk(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=UR(e,r);e.listenProvider_.startListening(WR(i),VR(e,i),s.hashFn,s.onComplete)}}}if(!i&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(WR(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(jR(t));e.listenProvider_.stopListening(WR(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=jR(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function PR(e,t,n,r){const i=qR(e,r);if(null!=i){const r=BR(i),s=r.path,o=r.queryId,a=ex(s,t);return zR(e,s,new dN(cN(o),a,n))}return[]}function AR(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=ex(e,i);s=s||_R(t,n),o=o||IR(t)}));let a,l=e.syncPointTree_.get(i);if(l?(o=o||IR(l),s=s||_R(l,Kk())):(l=new fR,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=s)a=!0;else{a=!1,s=Lx.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=_R(t,Kk());n&&(s=s.updateImmediateChild(e,n))}))}const c=bR(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=jR(t);De(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=TR++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=gR(l,t,n,LN(e.pendingWriteTree_,i),s,a);if(!c&&!o&&!r){const n=wR(l,t);u=u.concat(function(e,t,n){const r=t._path,i=VR(e,t),s=UR(e,n),o=e.listenProvider_.startListening(WR(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)De(!IR(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!Zk(e)&&t&&IR(t))return[ER(t).query];{let e=[];return t&&(e=e.concat(vR(t).map((e=>e.query)))),hk(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(WR(r),VR(e,r))}}return o}(e,t,n))}return u}function DR(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=_R(n,ex(e,t));if(r)return r}));return jN(r,t,i,n,!0)}function OR(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=ex(e,n);r=r||_R(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||_R(i,Kk()):(i=new fR,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new pN(r,!0,!1):null;return function(e){return wN(e.viewCache_)}(mR(i,t,LN(e.pendingWriteTree_,t._path),s?o.getNode():Lx.EMPTY_NODE,s))}function LR(e,t){return MR(t,e.syncPointTree_,null,LN(e.pendingWriteTree_,Kk()))}function MR(e,t,n,r){if(Zk(e.path))return FR(e,t,n,r);{const i=t.get(Kk());null==n&&null!=i&&(n=_R(i,Kk()));let s=[];const o=Hk(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=GN(r,o);s=s.concat(MR(a,l,e,t))}return i&&(s=s.concat(pR(i,e,r,n))),s}}function FR(e,t,n,r){const i=t.get(Kk());null==n&&null!=i&&(n=_R(i,Kk()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=GN(r,t),l=e.operationForChild(t);l&&(s=s.concat(FR(l,i,o,a)))})),i&&(s=s.concat(pR(i,e,r,n))),s}function UR(e,t){const n=t.query,r=VR(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||Lx.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=qR(e,n);if(r){const n=BR(r),i=n.path,s=n.queryId,o=ex(i,t);return zR(e,i,new hN(cN(s),o))}return[]}(e,n._path,r):function(e,t){return LR(e,new hN({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return RR(e,n,null,r)}}}}function VR(e,t){const n=jR(t);return e.queryToTagMap.get(n)}function jR(e){return e._path.toString()+"$"+e._queryIdentifier}function qR(e,t){return e.tagToQueryMap.get(t)}function BR(e){const t=e.indexOf("$");return De(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Wk(e.substr(0,t))}}function zR(e,t,n){const r=e.syncPointTree_.get(t);De(r,"Missing sync point for query tag that we're tracking");return pR(r,n,LN(e.pendingWriteTree_,t),null)}function WR(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(De(dR,"Reference.ts has not been loaded"),dR)(e._repo,e._path):e}class KR{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new KR(t)}node(){return this.node_}}class HR{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Xk(this.path_,e);return new HR(this.syncTree_,t)}node(){return DR(this.syncTree_,this.path_)}}const GR=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},QR=function(e,t,n){return e&&"object"===typeof e?(De(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?YR(e[".sv"],t,n):"object"===typeof e[".sv"]?JR(e[".sv"],t):void De(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},YR=function(e,t,n){if("timestamp"===e)return n.timestamp;De(!1,"Unexpected server value: "+e)},JR=function(e,t,n){e.hasOwnProperty("increment")||De(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&De(!1,"Unexpected increment value: "+r);const i=t.node();if(De(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!==typeof s?r:s+r},$R=function(e,t,n,r){return ZR(t,new HR(n,e),r)},XR=function(e,t,n){return ZR(e,new KR(t),n)};function ZR(e,t,n){const r=e.getPriority().val(),i=QR(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=QR(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Cx(s,Ux(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Cx(i))),r.forEachChild(kx,((e,r)=>{const i=ZR(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class eP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function tP(e,t){let n=t instanceof Wk?t:new Wk(t),r=e,i=Hk(n);for(;null!==i;){const e=ut(r.node.children,i)||{children:{},childCount:0};r=new eP(i,r,e),n=Qk(n),i=Hk(n)}return r}function nP(e){return e.node.value}function rP(e,t){e.node.value=t,lP(e)}function iP(e){return e.node.childCount>0}function sP(e,t){hk(e.node.children,((n,r)=>{t(new eP(n,e,r))}))}function oP(e,t,n,r){n&&!r&&t(e),sP(e,(e=>{oP(e,t,!0,r)})),n&&r&&t(e)}function aP(e){return new Wk(null===e.parent?e.name:aP(e.parent)+"/"+e.name)}function lP(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===nP(e)&&!iP(e)}(n),i=ct(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,lP(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,lP(e))}(e.parent,e.name,e)}const cP=/[\[\].#$\/\u0000-\u001F\u007F]/,uP=/[\[\].#$\u0000-\u001F\u007F]/,hP=10485760,dP=function(e){return"string"===typeof e&&0!==e.length&&!cP.test(e)},fP=function(e){return"string"===typeof e&&0!==e.length&&!uP.test(e)},pP=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!rk(e)||e&&"object"===typeof e&&ct(e,".sv")},mP=function(e,t,n,r){r&&void 0===t||gP(Et(e,"value"),t,n)},gP=function(e,t,n){const r=n instanceof Wk?new ix(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+ox(r));if("function"===typeof t)throw new Error(e+"contains a function "+ox(r)+" with contents = "+t.toString());if(rk(t))throw new Error(e+"contains "+t.toString()+" "+ox(r));if("string"===typeof t&&t.length>hP/3&&Ct(t)>hP)throw new Error(e+"contains a string greater than "+hP+" utf8 bytes "+ox(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,i=!1;if(hk(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!dP(t)))throw new Error(e+" contains an invalid key ("+t+") "+ox(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Ct(t),sx(e)}(r,t),gP(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=Ct(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+ox(r)+" in addition to actual children.")}},yP=function(e,t,n,r){if(r&&void 0===t)return;const i=Et(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];hk(t,((e,t)=>{const r=new Wk(e);if(gP(i,t,Xk(n,r)),".priority"===Yk(r)&&!pP(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Jk(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!dP(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(tx);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&rx(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},vP=function(e,t,n){if(!n||void 0!==t){if(rk(t))throw new Error(Et(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!pP(t))throw new Error(Et(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},_P=function(e,t,n,r){if((!r||void 0!==n)&&!dP(n))throw new Error(Et(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},wP=function(e,t,n,r){if((!r||void 0!==n)&&!fP(n))throw new Error(Et(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},bP=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),wP(e,t,n,r)},IP=function(e,t){if(".info"===Hk(t))throw new Error(e+" failed = Can't modify data under /.info/")},EP=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!dP(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),fP(e)}(n))throw new Error(Et(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class TP{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function SP(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||nx(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function CP(e,t,n){SP(e,n),xP(e,(e=>nx(e,t)))}function kP(e,t,n){SP(e,n),xP(e,(e=>rx(e,t)||rx(t,e)))}function xP(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(NP(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function NP(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();YC&&XC("event: "+n.toString()),mk(r)}}}const RP="repo_interrupt",PP=25;class AP{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new TP,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nN(),this.transactionQueueTree_=new eP,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function DP(e,t,n){if(e.stats_=Rk(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new eN(e.repoInfo_,((t,n,r,i)=>{MP(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>FP(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{at(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new cx(e.repoInfo_,t,((t,n,r,i)=>{MP(e,t,n,r,i)}),(t=>{FP(e,t)}),(t=>{!function(e,t){hk(t,((t,n)=>{UP(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Nk[n]||(Nk[n]=t()),Nk[n]}(e.repoInfo_,(()=>new aN(e.stats_,e.server_))),e.infoData_=new tN,e.infoSyncTree_=new SR({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=NR(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),UP(e,"connected",!1),e.serverSyncTree_=new SR({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);kP(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function OP(e){const t=e.infoData_.getNode(new Wk(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function LP(e){return GR({timestamp:OP(e)})}function MP(e,t,n,r,i){e.dataUpdateCount++;const s=new Wk(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=dt(n,(e=>Ux(e)));o=function(e,t,n,r){const i=qR(e,r);if(i){const r=BR(i),s=r.path,o=r.queryId,a=ex(s,t),l=EN.fromObject(n);return zR(e,s,new fN(cN(o),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Ux(n);o=PR(e.serverSyncTree_,s,t,i)}else if(r){const t=dt(n,(e=>Ux(e)));o=function(e,t,n){const r=EN.fromObject(n);return LR(e,new fN({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Ux(n);o=NR(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=YP(e,s)),kP(e.eventQueue_,a,o)}function FP(e,t){UP(e,"connected",t),!1===t&&function(e){KP(e,"onDisconnectEvents");const t=LP(e),n=nN();sN(e.onDisconnect_,Kk(),((r,i)=>{const s=$R(r,i,e.serverSyncTree_,t);rN(n,r,s)}));let r=[];sN(n,Kk(),((t,n)=>{r=r.concat(NR(e.serverSyncTree_,t,n));const i=eA(e,t);YP(e,i)})),e.onDisconnect_=nN(),kP(e.eventQueue_,Kk(),r)}(e)}function UP(e,t,n){const r=new Wk("/.info/"+t),i=Ux(n);e.infoData_.updateSnapshot(r,i);const s=NR(e.infoSyncTree_,r,i);kP(e.eventQueue_,r,s)}function VP(e){return e.nextWriteId_++}function jP(e,t,n,r,i){KP(e,"set",{path:t.toString(),value:n,priority:r});const s=LP(e),o=Ux(n,r),a=DR(e.serverSyncTree_,t),l=XR(o,a,s),c=VP(e),u=CR(e.serverSyncTree_,t,l,c,!0);SP(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||nk("set at "+t+" failed: "+n);const o=xR(e.serverSyncTree_,c,!s);kP(e.eventQueue_,t,o),HP(e,i,n,r)}));const h=eA(e,t);YP(e,h),kP(e.eventQueue_,h,[])}function qP(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&iN(e.onDisconnect_,t),HP(e,n,r,i)}))}function BP(e,t,n,r){const i=Ux(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&rN(e.onDisconnect_,t,i),HP(e,r,n,s)}))}function zP(e,t,n){let r;r=".info"===Hk(t._path)?RR(e.infoSyncTree_,t,n):RR(e.serverSyncTree_,t,n),CP(e.eventQueue_,t._path,r)}function WP(e){e.persistentConnection_&&e.persistentConnection_.interrupt(RP)}function KP(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];XC(t,...r)}function HP(e,t,n,r){t&&mk((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function GP(e,t,n){return DR(e.serverSyncTree_,t,n)||Lx.EMPTY_NODE}function QP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||ZP(e,t),nP(t)){const n=$P(e,t);De(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=GP(e,t,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const e=n[c];De(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=ex(t,e.path);s=s.updateChild(r,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,(r=>{KP(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(xR(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();ZP(e,tP(e.transactionQueueTree_,t)),QP(e,e.transactionQueueTree_),kP(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)mk(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{nk("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}YP(e,t)}}),o)}(e,aP(t),n)}else iP(t)&&sP(t,(t=>{QP(e,t)}))}function YP(e,t){const n=JP(e,t),r=aP(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const s=t[l],c=ex(n,s.path);let u,h=!1;if(De(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)h=!0,u=s.abortReason,i=i.concat(xR(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=PP)h=!0,u="maxretry",i=i.concat(xR(e.serverSyncTree_,s.currentWriteId,!0));else{const n=GP(e,s.path,o);s.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){gP("transaction failed: Data returned ",r,s.path);let t=Ux(r);"object"===typeof r&&null!=r&&ct(r,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=LP(e),c=XR(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=VP(e),o.splice(o.indexOf(a),1),i=i.concat(CR(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),i=i.concat(xR(e.serverSyncTree_,a,!0))}else h=!0,u="nodata",i=i.concat(xR(e.serverSyncTree_,s.currentWriteId,!0))}kP(e.eventQueue_,n,i),i=[],h&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===u?r.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):r.push((()=>t[l].onComplete(new Error(u),!1,null)))))}var a;ZP(e,e.transactionQueueTree_);for(let l=0;l<r.length;l++)mk(r[l]);QP(e,e.transactionQueueTree_)}(e,$P(e,n),r),r}function JP(e,t){let n,r=e.transactionQueueTree_;for(n=Hk(t);null!==n&&void 0===nP(r);)r=tP(r,n),n=Hk(t=Qk(t));return r}function $P(e,t){const n=[];return XP(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function XP(e,t,n){const r=nP(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);sP(t,(t=>{XP(e,t,n)}))}function ZP(e,t){const n=nP(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,rP(t,n.length>0?n:void 0)}sP(t,(t=>{ZP(e,t)}))}function eA(e,t){const n=aP(JP(e,t)),r=tP(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{tA(e,t)})),tA(e,r),oP(r,(t=>{tA(e,t)})),n}function tA(e,t){const n=nP(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(De(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(De(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(xR(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?rP(t,void 0):n.length=s+1,kP(e.eventQueue_,aP(t),i);for(let e=0;e<r.length;e++)mk(r[e])}}const nA=function(e,t){const n=rA(e),r=n.namespace;"firebase.com"===n.domain&&tk(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||tk("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&nk("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Sk(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Wk(n.pathString)}},rA=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let e=n[i];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(r){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):nk("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},iA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",sA=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=iA.charAt(n%64),n=Math.floor(n/64);De(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=iA.charAt(t[i]);return De(20===o.length,"nextPushId: Length should be 20."),o}}();class oA{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+at(this.snapshot.exportVal())}}class aA{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class lA{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return De(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class cA{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Ke;return qP(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){IP("OnDisconnect.remove",this._path);const e=new Ke;return BP(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){IP("OnDisconnect.set",this._path),mP("OnDisconnect.set",e,this._path,!1);const t=new Ke;return BP(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){IP("OnDisconnect.setWithPriority",this._path),mP("OnDisconnect.setWithPriority",e,this._path,!1),vP("OnDisconnect.setWithPriority",t,!1);const n=new Ke;return function(e,t,n,r,i){const s=Ux(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&rN(e.onDisconnect_,t,s),HP(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){IP("OnDisconnect.update",this._path),yP("OnDisconnect.update",e,this._path,!1);const t=new Ke;return function(e,t,n,r){if(ht(n))return XC("onDisconnect().update() called with empty data.  Don't do anything."),void HP(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&hk(n,((n,r)=>{const i=Ux(r);rN(e.onDisconnect_,Xk(t,n),i)})),HP(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class uA{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Zk(this._path)?null:Yk(this._path)}get ref(){return new pA(this._repo,this._path)}get _queryIdentifier(){const e=Zx(this._queryParams),t=ck(e);return"{}"===t?"default":t}get _queryObject(){return Zx(this._queryParams)}isEqual(e){if(!((e=kt(e))instanceof uA))return!1;const t=this._repo===e._repo,n=nx(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function hA(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function dA(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===px){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==ik)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==sk)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===kx){if(null!=t&&!pP(t)||null!=n&&!pP(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(De(e.getIndex()instanceof Vx||e.getIndex()===jx,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function fA(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class pA extends uA{constructor(e,t){super(e,t,new Qx,!1)}get parent(){const e=$k(this._path);return null===e?null:new pA(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class mA{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Wk(e),n=vA(this.ref,e);return new mA(this._node.getChild(t),n,kx)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new mA(n,vA(this.ref,t),kx))))}hasChild(e){const t=new Wk(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function gA(e,t){return(e=kt(e))._checkNotDeleted("ref"),void 0!==t?vA(e._root,t):e._root}function yA(e,t){(e=kt(e))._checkNotDeleted("refFromURL");const n=nA(t,e._repo.repoInfo_.nodeAdmin);EP("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||tk("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),gA(e,n.path.toString())}function vA(e,t){return null===Hk((e=kt(e))._path)?bP("child","path",t,!1):wP("child","path",t,!1),new pA(e._repo,Xk(e._path,t))}function _A(e,t){e=kt(e),IP("set",e._path),mP("set",t,e._path,!1);const n=new Ke;return jP(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function wA(e,t){yP("update",t,e._path,!1);const n=new Ke;return function(e,t,n,r){KP(e,"update",{path:t.toString(),value:n});let i=!0;const s=LP(e),o={};if(hk(n,((n,r)=>{i=!1,o[n]=$R(Xk(t,n),Ux(r),e.serverSyncTree_,s)})),i)XC("update() called with empty data.  Don't do anything."),HP(0,r,"ok",void 0);else{const i=VP(e),s=kR(e.serverSyncTree_,t,o,i);SP(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||nk("update at "+t+" failed: "+n);const a=xR(e.serverSyncTree_,i,!o),l=a.length>0?YP(e,t):t;kP(e.eventQueue_,l,a),HP(0,r,n,s)})),hk(n,(n=>{const r=eA(e,Xk(t,n));YP(e,r)})),kP(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function bA(e){e=kt(e);const t=new lA((()=>{})),n=new IA(t);return function(e,t,n){const r=OR(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=Ux(r).withIndex(t._queryParams.getIndex());let s;if(AR(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=NR(e.serverSyncTree_,t._path,i);else{const n=VR(e.serverSyncTree_,t);s=PR(e.serverSyncTree_,t._path,i,n)}return kP(e.eventQueue_,t._path,s),RR(e.serverSyncTree_,t,n,null,!0),i}),(n=>(KP(e,"get for query "+at(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new mA(t,new pA(e._repo,e._path),e._queryParams.getIndex())))}class IA{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new oA("value",this,new mA(e.snapshotNode,new pA(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new aA(this,e,t):null}matches(e){return e instanceof IA&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class EA{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new aA(this,e,t):null}createEvent(e,t){De(null!=e.childName,"Child events should have a childName.");const n=vA(new pA(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new oA(e.type,this,new mA(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof EA&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function TA(e,t,n,r,i){let s;if("object"===typeof r&&(s=void 0,i=r),"function"===typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{zP(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new lA(n,s||void 0),a="value"===t?new IA(o):new EA(t,o);return function(e,t,n){let r;r=".info"===Hk(t._path)?AR(e.infoSyncTree_,t,n):AR(e.serverSyncTree_,t,n),CP(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>zP(e._repo,e,a)}function SA(e,t,n,r){return TA(e,"value",t,n,r)}function CA(e,t,n,r){return TA(e,"child_added",t,n,r)}function kA(e,t,n,r){return TA(e,"child_changed",t,n,r)}function xA(e,t,n,r){return TA(e,"child_moved",t,n,r)}function NA(e,t,n,r){return TA(e,"child_removed",t,n,r)}function RA(e,t,n){let r=null;const i=n?new lA(n):null;"value"===t?r=new IA(i):t&&(r=new EA(t,i)),zP(e._repo,e,r)}class PA{}class AA extends PA{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){mP("endAt",this._value,e._path,!0);const t=Jx(e._queryParams,this._value,this._key);if(fA(t),dA(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new uA(e._repo,e._path,t,e._orderByCalled)}}class DA extends PA{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){mP("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===px||n?Jx(e,t,n):Jx(e,t,ik),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(fA(t),dA(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new uA(e._repo,e._path,t,e._orderByCalled)}}class OA extends PA{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){mP("startAt",this._value,e._path,!0);const t=Yx(e._queryParams,this._value,this._key);if(fA(t),dA(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new uA(e._repo,e._path,t,e._orderByCalled)}}class LA extends PA{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){mP("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===px||n?Yx(e,t,n):Yx(e,t,sk),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(fA(t),dA(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new uA(e._repo,e._path,t,e._orderByCalled)}}class MA extends PA{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new uA(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class FA extends PA{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new uA(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class UA extends PA{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){hA(e,"orderByChild");const t=new Wk(this._path);if(Zk(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new Vx(t),r=$x(e._queryParams,n);return dA(r),new uA(e._repo,e._path,r,!0)}}class VA extends PA{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){hA(e,"orderByKey");const t=$x(e._queryParams,px);return dA(t),new uA(e._repo,e._path,t,!0)}}class jA extends PA{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){hA(e,"orderByPriority");const t=$x(e._queryParams,kx);return dA(t),new uA(e._repo,e._path,t,!0)}}class qA extends PA{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){hA(e,"orderByValue");const t=$x(e._queryParams,jx);return dA(t),new uA(e._repo,e._path,t,!0)}}class BA extends PA{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(mP("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new AA(this._value,this._key)._apply(new OA(this._value,this._key)._apply(e))}}function zA(e){let t=kt(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(const s of r)t=s._apply(t);return t}!function(e){De(!hR,"__referenceConstructor has already been defined"),hR=e}(pA),function(e){De(!dR,"__referenceConstructor has already been defined"),dR=e}(pA);const WA="FIREBASE_DATABASE_EMULATOR_HOST",KA={};let HA=!1;function GA(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||tk("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),XC("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let o,a,l=nA(s,i),c=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[WA]),a?(o=!0,s="http://".concat(a,"?ns=").concat(c.namespace),l=nA(s,i),c=l.repoInfo):o=!l.repoInfo.secure;const u=i&&o?new _k(_k.OWNER):new vk(e.name,e.options,t);EP("Invalid Firebase Database URL",l),Zk(l.path)||tk("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=KA[t.name];i||(i={},KA[t.name]=i);let s=i[e.toURLString()];s&&tk("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new AP(e,HA,n,r),i[e.toURLString()]=s,s}(c,e,u,new yk(e.name,n));return new QA(h,e)}class QA{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(DP(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new pA(this._repo,Kk())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=KA[t];n&&n[e.key]===e||tk("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),WP(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&tk("Cannot call "+e+" on a deleted database.")}}function YA(){Fk.IS_TRANSPORT_INITIALIZED&&nk("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function JA(){YA(),Dk.forceDisallow()}function $A(){YA(),Mk.forceDisallow(),Dk.forceAllow()}function XA(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=kt(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&tk("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&tk('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new _k(_k.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:He(r.mockUserToken,e.app.options.projectId);s=new _k(t)}!function(e,t,n,r){e.repoInfo_=new Sk("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function ZA(e){var t;(e=kt(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(RP)}function eD(e,t){$C(e,t)}const tD={".sv":"timestamp"};class nD{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function rD(e,t,n){var r;if(e=kt(e),IP("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,s=new Ke,o=SA(e,(()=>{}));return function(e,t,n,r,i,s){KP(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:HC(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=GP(e,t,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(void 0===l)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{gP("transaction failed: Data returned ",l,o.path),o.status=0;const n=tP(e.transactionQueueTree_,t),r=nP(n)||[];let i;r.push(o),rP(n,r),"object"===typeof l&&null!==l&&ct(l,".priority")?(i=ut(l,".priority"),De(pP(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(DR(e.serverSyncTree_,t)||Lx.EMPTY_NODE).getPriority().val();const s=LP(e),c=Ux(l,i),u=XR(c,a,s);o.currentOutputSnapshotRaw=c,o.currentOutputSnapshotResolved=u,o.currentWriteId=VP(e);const h=CR(e.serverSyncTree_,t,u,o.currentWriteId,o.applyLocally);kP(e.eventQueue_,t,h),QP(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new mA(r,new pA(e._repo,e._path),kx),s.resolve(new nD(n,i)))}),o,i),s.promise}cx.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},cx.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){VC(En),pn(new xt("database",((e,t)=>{let{instanceIdentifier:n}=t;return GA(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Nn(MC,FC,e),Nn(MC,FC,"esm2017")}();const iD=new Ut("@firebase/database-compat"),sD=function(e){const t="FIREBASE WARNING: "+e;iD.warn(t)};class oD{constructor(e){this._delegate=e}cancel(e){It("OnDisconnect.cancel",0,1,arguments.length),Tt("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){It("OnDisconnect.remove",0,1,arguments.length),Tt("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){It("OnDisconnect.set",1,2,arguments.length),Tt("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){It("OnDisconnect.setWithPriority",2,3,arguments.length),Tt("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(It("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,sD("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Tt("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class aD{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return It("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class lD{constructor(e,t){this._database=e,this._delegate=t}val(){return It("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return It("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return It("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return It("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return It("DataSnapshot.child",0,1,arguments.length),e=String(e),wP("DataSnapshot.child","path",e,!1),new lD(this._database,this._delegate.child(e))}hasChild(e){return It("DataSnapshot.hasChild",1,1,arguments.length),wP("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return It("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return It("DataSnapshot.forEach",1,1,arguments.length),Tt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new lD(this._database,t))))}hasChildren(){return It("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return It("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return It("DataSnapshot.ref",0,0,arguments.length),new uD(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class cD{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;It("Query.on",2,4,arguments.length),Tt("Query.on","callback",t,!1);const s=cD.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new lD(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return SA(this._delegate,o,a),t;case"child_added":return CA(this._delegate,o,a),t;case"child_removed":return NA(this._delegate,o,a),t;case"child_changed":return kA(this._delegate,o,a),t;case"child_moved":return xA(this._delegate,o,a),t;default:throw new Error(Et("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(It("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Et(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),Tt("Query.off","callback",t,!0),St("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,RA(this._delegate,e,r)}else RA(this._delegate,e)}get(){return bA(this._delegate).then((e=>new lD(this.database,e)))}once(e,t,n,r){It("Query.once",1,4,arguments.length),Tt("Query.once","callback",t,!0);const i=cD.getCancelAndContextArgs_("Query.once",n,r),s=new Ke,o=(e,n)=>{const r=new lD(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":SA(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":CA(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":NA(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":kA(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":xA(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(Et("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return It("Query.limitToFirst",1,1,arguments.length),new cD(this.database,zA(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new MA(e)}(e)))}limitToLast(e){return It("Query.limitToLast",1,1,arguments.length),new cD(this.database,zA(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new FA(e)}(e)))}orderByChild(e){return It("Query.orderByChild",1,1,arguments.length),new cD(this.database,zA(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return wP("orderByChild","path",e,!1),new UA(e)}(e)))}orderByKey(){return It("Query.orderByKey",0,0,arguments.length),new cD(this.database,zA(this._delegate,new VA))}orderByPriority(){return It("Query.orderByPriority",0,0,arguments.length),new cD(this.database,zA(this._delegate,new jA))}orderByValue(){return It("Query.orderByValue",0,0,arguments.length),new cD(this.database,zA(this._delegate,new qA))}startAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return It("Query.startAt",0,2,arguments.length),new cD(this.database,zA(this._delegate,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return _P("startAt","key",t,!0),new OA(e,t)}(e,t)))}startAfter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return It("Query.startAfter",0,2,arguments.length),new cD(this.database,zA(this._delegate,function(e,t){return _P("startAfter","key",t,!0),new LA(e,t)}(e,t)))}endAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return It("Query.endAt",0,2,arguments.length),new cD(this.database,zA(this._delegate,function(e,t){return _P("endAt","key",t,!0),new AA(e,t)}(e,t)))}endBefore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return It("Query.endBefore",0,2,arguments.length),new cD(this.database,zA(this._delegate,function(e,t){return _P("endBefore","key",t,!0),new DA(e,t)}(e,t)))}equalTo(e,t){return It("Query.equalTo",1,2,arguments.length),new cD(this.database,zA(this._delegate,function(e,t){return _P("equalTo","key",t,!0),new BA(e,t)}(e,t)))}toString(){return It("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return It("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(It("Query.isEqual",1,1,arguments.length),!(e instanceof cD)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Tt(e,"cancel",r.cancel,!0),r.context=n,St(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(Et(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new uD(this.database,new pA(this._delegate._repo,this._delegate._path))}}class uD extends cD{constructor(e,t){super(e,new uA(t._repo,t._path,new Qx,!1)),this.database=e,this._delegate=t}getKey(){return It("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return It("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new uD(this.database,vA(this._delegate,e))}getParent(){It("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new uD(this.database,e):null}getRoot(){return It("Reference.root",0,0,arguments.length),new uD(this.database,this._delegate.root)}set(e,t){It("Reference.set",1,2,arguments.length),Tt("Reference.set","onComplete",t,!0);const n=_A(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(It("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,sD("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}IP("Reference.update",this._delegate._path),Tt("Reference.update","onComplete",t,!0);const n=wA(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){It("Reference.setWithPriority",2,3,arguments.length),Tt("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(IP("setWithPriority",e._path),mP("setWithPriority",t,e._path,!1),vP("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new Ke;return jP(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){It("Reference.remove",0,1,arguments.length),Tt("Reference.remove","onComplete",e,!0);const t=function(e){return IP("remove",e._path),_A(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){It("Reference.transaction",1,3,arguments.length),Tt("Reference.transaction","transactionUpdate",e,!1),Tt("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(Et(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=rD(this._delegate,e,{applyLocally:n}).then((e=>new aD(e.committed,new lD(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){It("Reference.setPriority",1,2,arguments.length),Tt("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=kt(e),IP("setPriority",e._path),vP("setPriority",t,!1);const n=new Ke;return jP(e._repo,Xk(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){It("Reference.push",0,2,arguments.length),Tt("Reference.push","onComplete",t,!0);const n=function(e,t){e=kt(e),IP("push",e._path),mP("push",t,e._path,!0);const n=OP(e._repo),r=sA(n),i=vA(e,r),s=vA(e,r);let o;return o=null!=t?_A(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new uD(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new uD(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return IP("Reference.onDisconnect",this._delegate._path),new oD(new cA(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class hD{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:JA,forceLongPolling:$A}}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};XA(this._delegate,e,t,n)}ref(e){if(It("database.ref",0,1,arguments.length),e instanceof uD){const t=yA(this._delegate,e.toString());return new uD(this,t)}{const t=gA(this._delegate,e);return new uD(this,t)}}refFromURL(e){It("database.refFromURL",1,1,arguments.length);const t=yA(this._delegate,e);return new uD(this,t)}goOffline(){return It("database.goOffline",0,0,arguments.length),function(e){(e=kt(e))._checkNotDeleted("goOffline"),WP(e._repo)}(this._delegate)}goOnline(){return It("database.goOnline",0,0,arguments.length),ZA(this._delegate)}}hD.ServerValue={TIMESTAMP:tD,increment:e=>function(e){return{".sv":{increment:e}}}(e)};var dD=Object.freeze({__proto__:null,initStandalone:function(e){let{app:t,url:n,version:r,customAuthImpl:i,customAppCheckImpl:s,namespace:o,nodeAdmin:a=!1}=e;VC(r);const l=new Pt("database-standalone"),c=new Rt("auth-internal",l);let u;return c.setComponent(new xt("auth-internal",(()=>i),"PRIVATE")),s&&(u=new Rt("app-check-internal",l),u.setComponent(new xt("app-check-internal",(()=>s),"PRIVATE"))),{instance:new hD(GA(t,c,u,n,a),t),namespace:o}}});const fD=hD.ServerValue;!function(e){e.INTERNAL.registerComponent(new xt("database-compat",((e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new hD(i,r)}),"PUBLIC").setServiceProps({Reference:uD,Query:cD,Database:hD,DataSnapshot:lD,enableLogging:eD,INTERNAL:dD,ServerValue:fD}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","1.0.4")}(Qn);const pD={apiKey:"AIzaSyBFZvQeulc-HcJ0mg4pkJ3PaYT6fjkau6U",authDomain:"projectairguard.firebaseapp.com",projectId:"projectairguard",storageBucket:"projectairguard.appspot.com",messagingSenderId:"676272574243",appId:"1:676272574243:web:14e7455fcda2cdabba4696",measurementId:"G-EC2QV72RV4"},mD=Qn.initializeApp(pD,"app"),gD=Qn.initializeApp(pD).auth(),yD=mD.firestore(),vD=mD.database(),_D=mD.storage(),wD=n.p+"static/media/userUnknow.a6143582309785dca610.png",bD=e=>{let{status:t,label:n,id:r,onToggle:i}=e;return(0,xe.jsx)("div",{className:"switch-container",children:(0,xe.jsxs)("label",{className:"switch-label",children:[(0,xe.jsx)("label",{className:"switch-label",children:n}),(0,xe.jsx)("input",{type:"checkbox",checked:t,onChange:()=>i(r,!t),className:"switch-input"}),(0,xe.jsx)("span",{className:"switch-slider"})]})})};const ID=function(){const[e,t]=(0,r.useState)({}),[n,i]=(0,r.useState)(!1),[s,o]=(0,r.useState)({name:"",age:"",team:"",status:!1,leader:!1,admin:!1,function:"",adminMessage:""}),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(!1),h=ee();return(0,r.useEffect)((()=>{!async function(){const e=localStorage.getItem("authTime");if(!e)return void h("/auth");const n=(new Date).getTime()-parseInt(e,10);if(n>108e5)return void h("/auth");const r=localStorage.getItem("email");i(localStorage.getItem("admin"));try{const e=localStorage.getItem("editUser");let n;n=e?await yD.collection("users").where("email","==",e).get():await yD.collection("users").where("email","==",r).get(),n.empty||n.forEach((e=>{const n=e.data();t({id:e.id,...n}),o({name:n.name||"",age:n.age||"",team:n.team||"",email:n.email||"",status:n.status||!1,leader:n.leader||!1,admin:n.admin||!1,function:n.function||""})}))}catch(ek){console.error("Erro ao recuperar informa\xe7\xf5es do usu\xe1rio do Firestore:",ek)}}(),async function(){try{const e=await yD.collection("mensagers").where("mensager","==","missionsListPage").get();if(!e.empty){const t=e.docs[0].data();o((e=>({...e,adminMessage:t.text||""})))}}catch(ek){console.error("Erro ao recuperar mensagem do Firestore:",ek)}}(),async function(){try{const e=(await yD.collection("teams").get()).docs.map((e=>e.data().name));l(e)}catch(ek){console.error("Erro ao recuperar times do Firestore:",ek)}}()}),[]),(0,xe.jsxs)("div",{className:"ProfilePage",children:[(0,xe.jsxs)("div",{className:"containerProfile",children:[(0,xe.jsxs)("div",{className:"profileImage",onClick:()=>{window.confirm("Deseja trocar a foto de perfil?")&&document.getElementById("fileInput").click()},style:{position:"relative",display:"inline-block"},children:[(0,xe.jsx)("img",{src:e.img?e.img:wD,alt:"Profile",className:"profileImg"}),(0,xe.jsx)("button",{className:"configButton",children:(0,xe.jsx)("i",{className:"fas fa-pencil-alt"})})]}),c&&(0,xe.jsx)("div",{className:"loadingOverlay",children:"Carregando..."}),(0,xe.jsx)("input",{className:"inputFunction",type:"text",placeholder:"Cargo:",value:s.function,onChange:e=>o({...s,function:e.target.value}),readOnly:!n}),(0,xe.jsx)("input",{id:"fileInput",type:"file",onChange:async n=>{const r=n.target.files[0];if(r){u(!0);const n=_D.ref().child("users/".concat(r.name));await n.put(r);const i=await n.getDownloadURL();await yD.collection("users").doc(e.id).update({img:i}),u(!1),t((e=>({...e,img:i})))}},style:{display:"none"}})]}),(0,xe.jsx)("div",{className:"containerProfile",children:(0,xe.jsxs)("div",{className:"profileCard",children:[(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Email:",value:s.email,readOnly:!0}),(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Nome:",value:s.name,onChange:e=>o({...s,name:e.target.value})}),(0,xe.jsx)("input",{className:"inputText",type:"number",placeholder:"Idade:",value:s.age,onChange:e=>o({...s,age:e.target.value})}),n&&(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Protocolo:",value:s.adminMessage,onChange:e=>o({...s,adminMessage:e.target.value})}),(0,xe.jsx)("div",{className:"selectContainer",children:(0,xe.jsxs)("select",{value:s.team,onChange:e=>o({...s,team:e.target.value}),disabled:!n,children:[(0,xe.jsx)("option",{value:"",children:"Selecione um time"}),a.map(((e,t)=>(0,xe.jsx)("option",{value:e,children:e},t)))]})}),n&&(0,xe.jsxs)("div",{children:[(0,xe.jsx)(bD,{id:"statusUser",label:"Status",status:s.status,onToggle:()=>o({...s,status:!s.status})}),(0,xe.jsx)(bD,{id:"leaderUser",label:"L\xedder de Equipe",status:s.leader,onToggle:()=>o({...s,leader:!s.leader})}),(0,xe.jsx)(bD,{id:"adminUser",label:"Administrador",status:s.admin,onToggle:()=>o({...s,admin:!s.admin})})]}),(0,xe.jsx)("button",{className:"buttonMissions",onClick:async()=>{try{await yD.collection("users").doc(e.id).update({name:s.name,age:s.age,team:s.team,status:s.status,leader:s.leader,admin:s.admin,function:s.function}),console.log("Informa\xe7\xf5es do usu\xe1rio atualizadas com sucesso."),n&&await yD.collection("mensagers").where("mensager","==","missionsListPage").get().then((e=>{e.forEach((e=>{e.ref.update({text:s.adminMessage})}))})),localStorage.removeItem("editUser"),h(-1)}catch(ek){console.error("Erro ao atualizar informa\xe7\xf5es do usu\xe1rio ou mensagem do administrador:",ek)}},disabled:c,children:(0,xe.jsx)("h2",{children:"Editar"})})]})})]})},ED=n.p+"static/media/logo.8b05cf658978c48e21b7.png";const TD=function(){const[e,t]=(0,r.useState)("");return(0,xe.jsxs)("div",{id:"ForgotPasswordForm",children:[(0,xe.jsx)("a",{className:"resetPass",children:"Para recuperar a senha atrav\xe9s do Email de Redefini\xe7\xe3o de Senha, informe o email cadastrado e pressione o bot\xe3o"}),(0,xe.jsx)("input",{className:"inputLogin",type:"email",id:"EmailUser",placeholder:"Seu E-mail",value:e,onChange:e=>t(e.target.value),required:!0}),(0,xe.jsx)("div",{className:"boxButton",children:(0,xe.jsx)("button",{className:"btnAuth",onClick:async t=>{t.preventDefault();try{await ys(gD,e),alert("Um e-mail de redefini\xe7\xe3o de senha foi enviado para o seu endere\xe7o de e-mail.")}catch(ek){alert("Erro ao enviar e-mail de redefini\xe7\xe3o de senha: ".concat(ek.message))}},children:"Enviar E-mail"})})]})};const SD=function(){const[e,t]=(0,r.useState)("login"),n=ee(),i=e=>{n("/auth")};return(0,xe.jsxs)("div",{className:"Auth",children:[(0,xe.jsx)("div",{className:"containerAuth",children:(0,xe.jsx)("img",{src:ED,className:"LogoJA"})}),(0,xe.jsx)("div",{className:"containerAuth",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsxs)("div",{className:"sliderLogin",children:[(0,xe.jsx)("div",{className:"switch ".concat("login"===e?"active":""),onClick:()=>i(),children:"Logar"}),(0,xe.jsx)("div",{className:"switch ".concat("register"===e?"active":""),onClick:()=>i(),children:"Registrar"})]}),(0,xe.jsx)(TD,{})]})})]})};const CD=function(){const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[s,o]=(0,r.useState)(!1),a=ee();return(0,xe.jsxs)("div",{id:"loginForm",children:[(0,xe.jsx)("input",{className:"inputLogin",type:"email",id:"email",placeholder:"Entrar com email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,xe.jsxs)("div",{className:"password-container",children:[(0,xe.jsx)("input",{className:"inputLogin",type:s?"text":"password",id:"password",placeholder:"Senha",value:n,onChange:e=>i(e.target.value),required:!0}),(0,xe.jsx)("span",{className:"toggle-password",onClick:()=>{o(!s)},children:s?(0,xe.jsx)("i",{className:"fas fa-eye-slash"}):(0,xe.jsx)("i",{className:"fas fa-eye"})})]}),(0,xe.jsx)("a",{className:"resetPass",onClick:()=>{a("/fogotPassword")},children:"Esqueceu sua senha?"}),(0,xe.jsx)("div",{className:"boxButton",children:(0,xe.jsx)("button",{className:"btnAuth",onClick:async()=>{bs(gD,e,n).then((t=>{const n=t.user;localStorage.setItem("authTime",(new Date).getTime().toString()),localStorage.setItem("email",e),console.log("Usu\xe1rio logado:",n),a("/home")})).catch((e=>{const t=e.code,n=e.message;console.error("Erro no login:",t,n)}))},children:"Log In"})})]})};const kD=function(){const[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(""),[s,o]=(0,r.useState)(""),[a,l]=(0,r.useState)(""),c=()=>{t(!e)};return(0,xe.jsxs)("div",{id:"RegisterForm",children:[(0,xe.jsx)("input",{className:"inputLogin",type:"text",id:"NameUser",placeholder:"Nome do Usu\xe1rio",value:n,onChange:e=>i(e.target.value),required:!0}),(0,xe.jsx)("input",{className:"inputLogin",type:"email",id:"EmailUser",placeholder:"E-mail",value:s,onChange:e=>o(e.target.value),required:!0}),(0,xe.jsxs)("div",{className:"password-container",children:[(0,xe.jsx)("input",{className:"inputLogin",type:e?"text":"password",id:"password",placeholder:"Crie uma Senha",value:a,onChange:e=>l(e.target.value),required:!0}),(0,xe.jsx)("span",{className:"toggle-password",onClick:c,children:e?(0,xe.jsx)("i",{className:"fas fa-eye-slash"}):(0,xe.jsx)("i",{className:"fas fa-eye"})})]}),(0,xe.jsxs)("div",{className:"password-container",children:[(0,xe.jsx)("input",{className:"inputLogin",type:e?"text":"password",id:"confirmPassword",placeholder:"Confirme a sua Senha",required:!0}),(0,xe.jsx)("span",{className:"toggle-password",onClick:c,children:e?(0,xe.jsx)("i",{className:"fas fa-eye-slash"}):(0,xe.jsx)("i",{className:"fas fa-eye"})})]}),(0,xe.jsx)("div",{className:"boxButton",children:(0,xe.jsx)("button",{className:"btnAuth",onClick:async e=>{e.preventDefault();try{await ws(gD,s,a);await hT(BI(yD,"users"),{email:s,name:n,status:!1}),alert("Usu\xe1rio cadastrado com sucesso!"),window.location.reload()}catch(ek){alert("Erro no cadastro: ".concat(ek.message))}},children:"Cadastrar"})})]})};const xD=function(){const[e,t]=(0,r.useState)("login"),n=ee();(0,r.useEffect)((()=>{!async function(){const e=localStorage.getItem("authTime");if(!e)return void n("/auth");const t=(new Date).getTime()-parseInt(e,10);if(t>108e5)n("/auth")}()}),[]);const i=e=>{t(e)};return(0,xe.jsxs)("div",{className:"Auth",children:[(0,xe.jsx)("div",{className:"containerAuth",children:(0,xe.jsx)("img",{src:ED,className:"LogoJA"})}),(0,xe.jsx)("div",{className:"containerAuth",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsxs)("div",{className:"sliderLogin",children:[(0,xe.jsx)("div",{className:"switch ".concat("login"===e?"active":""),onClick:()=>i("login"),children:"Logar"}),(0,xe.jsx)("div",{className:"switch ".concat("register"===e?"active":""),onClick:()=>i("register"),children:"Registrar"})]}),"login"===e?(0,xe.jsx)(CD,{}):(0,xe.jsx)(kD,{})]})})]})};const ND=function(){const[e,t]=(0,r.useState)({}),n=ee();return(0,r.useEffect)((()=>{!async function(){const e=localStorage.getItem("authTime");if(!e)return void n("/auth");const t=(new Date).getTime()-parseInt(e,10);if(t>108e5)n("/auth")}()}),[]),(0,r.useEffect)((()=>{const e=(()=>{const e=localStorage.getItem("email");return yD.collection("users").where("email","==",e).onSnapshot((e=>{if(!e.empty){const n=e.docs[0].data(),r=e.docs[0].id;t({id:r,...n})}}))})();return()=>{e()}}),[]),e.admin&&localStorage.setItem("admin",e.admin),(0,xe.jsxs)("div",{className:"homePage",children:[(0,xe.jsxs)("div",{className:"containerHome",children:[(0,xe.jsxs)("div",{className:"profileImage",style:{position:"relative",display:"inline-block"},children:[(0,xe.jsx)("img",{src:e.img?e.img:wD,alt:"Profile",className:"profileImg"}),(0,xe.jsx)("button",{className:"configButton",onClick:function(){localStorage.removeItem("editUser"),n("/profile")},children:(0,xe.jsx)("i",{className:"fas fa-cog"})})]}),(0,xe.jsx)("h2",{className:"functionLabel",children:e.function?e.function:"Cargo Indefinido"})]}),(0,xe.jsx)("div",{className:"containerHome",children:(0,xe.jsxs)("div",{className:"missionsCard",children:[(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Email:",value:e.email?e.email:"Email Indefinido",readOnly:!0}),(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Nome:",value:e.name?e.name:"Nome Indefinido",readOnly:!0}),(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Idade:",value:e.age?e.age:"Idade Indefinida",readOnly:!0}),(0,xe.jsx)("input",{className:"inputText",type:"text",placeholder:"Equipe:",value:e.team?e.team:"Time Indefinido",readOnly:!0}),(0,xe.jsx)("button",{className:"buttonMissions",onClick:function(){n("/missions")},children:"MINHAS MISS\xd5ES"})]})})]})};const RD=function(){return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsxs)("header",{children:[(0,xe.jsx)("h1",{children:"Gerenciamento de Qualidade do Ar"}),(0,xe.jsx)("nav",{children:(0,xe.jsxs)("ul",{children:[(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#home",children:"In\xedcio"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"auth",children:"Aplica\xe7\xe3o"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#about",children:"Sobre"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#skills",children:"Habilidades"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#education",children:"Educa\xe7\xe3o"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#work",children:"Projetos"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#experience",children:"Experi\xeancia"})}),(0,xe.jsx)("li",{children:(0,xe.jsx)("a",{href:"#contact",children:"Contato"})})]})})]}),(0,xe.jsx)("section",{className:"home",id:"home",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Bem-vindo ao Gerenciamento de Qualidade do Ar"}),(0,xe.jsx)("p",{children:"O nosso dispositivo de gerenciamento de qualidade do ar \xe9 compat\xedvel com sistemas de automa\xe7\xe3o residencial e tem como objetivo principal proteger as pessoas garantindo a qualidade do ar em ambientes internos."}),(0,xe.jsx)(Se,{to:"/slides",children:(0,xe.jsx)("button",{className:"button",children:"Saiba Mais"})})]})}),(0,xe.jsx)("section",{className:"about",id:"about",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Sobre N\xf3s"}),(0,xe.jsx)("p",{children:"Somos uma equipe dedicada ao desenvolvimento de solu\xe7\xf5es inovadoras para melhorar a qualidade do ar que respiramos em nossos lares. Nosso dispositivo \xe9 projetado para ser f\xe1cil de usar, eficiente e altamente compat\xedvel com sistemas de automa\xe7\xe3o residencial existentes."})]})}),(0,xe.jsx)("section",{className:"skills",id:"skills",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Nossas Habilidades"}),(0,xe.jsxs)("ul",{children:[(0,xe.jsx)("li",{children:"Desenvolvimento de Dispositivos IoT"}),(0,xe.jsx)("li",{children:"An\xe1lise de Qualidade do Ar"}),(0,xe.jsx)("li",{children:"Integra\xe7\xe3o com Sistemas de Automa\xe7\xe3o Residencial"}),(0,xe.jsx)("li",{children:"UI/UX Design"})]})]})}),(0,xe.jsx)("section",{className:"education",id:"education",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Nossa Educa\xe7\xe3o"}),(0,xe.jsx)("p",{children:"Nossa equipe possui forma\xe7\xe3o em Engenharia Eletr\xf4nica, Ci\xeancia da Computa\xe7\xe3o e Design de Produtos, garantindo uma abordagem multidisciplinar para o desenvolvimento de solu\xe7\xf5es de qualidade do ar."})]})}),(0,xe.jsx)("section",{className:"work",id:"work",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Nossos Projetos"}),(0,xe.jsx)("p",{children:"Confira alguns dos projetos em que estivemos envolvidos para melhorar a qualidade do ar em ambientes internos:"}),(0,xe.jsxs)("ul",{children:[(0,xe.jsx)("li",{children:"Projeto A: Sistema de Monitoramento de Qualidade do Ar"}),(0,xe.jsx)("li",{children:"Projeto B: Dispositivo de Filtragem Avan\xe7ada"}),(0,xe.jsx)("li",{children:"Projeto C: Integra\xe7\xe3o com Assistente Residencial"})]})]})}),(0,xe.jsx)("section",{className:"experience",id:"experience",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Nossa Experi\xeancia"}),(0,xe.jsx)("p",{children:"Com mais de 5 anos de experi\xeancia no campo da qualidade do ar e da automa\xe7\xe3o residencial, nossa equipe est\xe1 preparada para enfrentar os desafios mais complexos e fornecer solu\xe7\xf5es inovadoras para nossos clientes."})]})}),(0,xe.jsx)("section",{className:"contact",id:"contact",children:(0,xe.jsxs)("div",{className:"container",children:[(0,xe.jsx)("h2",{children:"Entre em Contato"}),(0,xe.jsx)("p",{children:"Estamos ansiosos para ouvir de voc\xea! Entre em contato conosco para mais informa\xe7\xf5es sobre nossos produtos e servi\xe7os."}),(0,xe.jsxs)("form",{children:[(0,xe.jsx)("input",{type:"text",placeholder:"Seu Nome"}),(0,xe.jsx)("input",{type:"email",placeholder:"Seu Email"}),(0,xe.jsx)("textarea",{placeholder:"Sua Mensagem"}),(0,xe.jsx)("button",{children:"Enviar Mensagem"})]})]})}),(0,xe.jsx)("footer",{className:"footer",children:(0,xe.jsx)("p",{children:"\xa9 2024 Gerenciamento de Qualidade do Ar"})})]})},PD=()=>{const[e,t]=(0,r.useState)([]),[i,s]=(0,r.useState)(0);(0,r.useEffect)((()=>{const e=(e=>e.keys().map(e))(n(188));t(e);const r=vD.ref("slide");return r.on("value",(e=>{const t=e.val();null!==t&&s(t)})),()=>{r.off("value")}}),[]),(0,r.useEffect)((()=>{vD.ref("slide").set(i)}),[i]);const o=()=>{s((e=>0===e?0:e-1))},a=()=>{s((t=>t===e.length-1?e.length-1:t+1))};(0,r.useEffect)((()=>{const e=e=>{switch(e.key){case"ArrowLeft":o();break;case"ArrowRight":a()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[o,a]);return(0,xe.jsxs)("div",{className:"slideshow",children:[(0,xe.jsx)("button",{className:"floating-button left",onClick:o,children:(0,xe.jsx)("i",{className:"fas fa-arrow-left"})}),(0,xe.jsx)("img",{src:e[i],alt:"Slide ".concat(i+1)}),(0,xe.jsx)("button",{className:"floating-button right",onClick:a,children:(0,xe.jsx)("i",{className:"fas fa-arrow-right"})}),(0,xe.jsx)("button",{className:"floating-button expand",onClick:()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()},children:(0,xe.jsx)("i",{className:"fas fa-expand"})})]})};function AD(){const e=X();return(0,xe.jsxs)(r.Fragment,{children:[(0,xe.jsxs)(ge,{children:[(0,xe.jsx)(pe,{path:"/home",element:(0,xe.jsx)(ND,{})}),(0,xe.jsx)(pe,{path:"/profile",element:(0,xe.jsx)(ID,{})}),(0,xe.jsx)(pe,{path:"/fogotPassword",element:(0,xe.jsx)(SD,{})}),(0,xe.jsx)(pe,{path:"/auth",element:(0,xe.jsx)(xD,{})}),(0,xe.jsx)(pe,{path:"/",element:(0,xe.jsx)(RD,{})}),(0,xe.jsx)(pe,{path:"/slides",element:(0,xe.jsx)(PD,{})})]}),"/auth"!==e.pathname&&"/fogotPassword"!==e.pathname&&"/slides"!==e.pathname&&"/"!==e.pathname&&(0,xe.jsx)(Ne,{})]})}const DD=function(){return(0,xe.jsx)(Ie,{children:(0,xe.jsx)(AD,{})})};s.createRoot(document.getElementById("root")).render((0,xe.jsx)(r.StrictMode,{children:(0,xe.jsx)(DD,{})}))})()})();
//# sourceMappingURL=main.4aad72bc.js.map